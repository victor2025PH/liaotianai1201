# 系統啟動與功能測試指南

> **更新日期**: 2025-01-07

---

## 🚀 快速啟動

### 方式 1: 使用啟動腳本（推薦）

```bash
python scripts/start_system.py
```

### 方式 2: 手動啟動

**啟動後端**:
```bash
cd admin-backend
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

**啟動前端**:
```bash
cd saas-demo
npm run dev
```

---

## ✅ 服務檢查

### 檢查服務狀態

**後端服務**:
- URL: `http://localhost:8000`
- 健康檢查: `http://localhost:8000/health`
- API 文檔: `http://localhost:8000/docs`

**前端服務**:
- URL: `http://localhost:3000`

### 快速檢查命令

```powershell
# 檢查後端
Test-NetConnection -ComputerName localhost -Port 8000

# 檢查前端
Test-NetConnection -ComputerName localhost -Port 3000
```

---

## 📋 功能測試流程

### 測試 1: 劇本管理

1. **訪問頁面**: `http://localhost:3000/group-ai/scripts`
2. **創建劇本**:
   - 點擊「創建劇本」
   - 填寫劇本信息
   - 輸入 YAML 內容
   - 保存

3. **驗證**:
   - 劇本出現在列表中
   - 可以編輯和刪除

### 測試 2: 帳號管理

1. **訪問頁面**: `http://localhost:3000/group-ai/accounts`
2. **添加帳號**:
   - 點擊「添加賬號」
   - 填寫帳號信息（需要有效的 session 文件）
   - 選擇劇本
   - 保存

3. **啟動帳號**:
   - 在帳號列表中點擊「啟動」
   - 等待狀態變為 `ONLINE`

4. **驗證**:
   - 帳號狀態為 `ONLINE`
   - 查看日誌確認服務初始化

### 測試 3: 劇本和帳號聊天功能

1. **準備**:
   - 確保已創建劇本
   - 確保已添加並啟動帳號
   - 確保帳號已加入指定的 Telegram 群組

2. **測試**:
   - 在 Telegram 群組中發送消息（例如："你好"）
   - 檢查帳號是否自動回復

3. **驗證**:
   - 帳號根據劇本生成回復
   - 回復內容符合劇本定義

### 測試 4: 角色分配功能

1. **訪問頁面**: `http://localhost:3000/group-ai/role-assignments`

2. **提取角色**:
   - 選擇包含角色定義的劇本
   - 點擊「提取角色」
   - 查看提取到的角色列表

3. **創建分配方案**:
   - 切換到「分配方案」標籤頁
   - 選擇帳號
   - 選擇分配模式（自動/手動）
   - 創建分配方案

4. **審查並應用**:
   - 切換到「審查方案」標籤頁
   - 查看分配詳情
   - 應用分配方案

---

## 🔧 常見問題

### 問題 1: 後端服務無法啟動

**可能原因**:
- 依賴未安裝
- 數據庫配置錯誤
- 端口被占用

**解決方案**:
```bash
# 安裝依賴
cd admin-backend
pip install -r requirements.txt

# 檢查端口
netstat -ano | findstr :8000

# 查看錯誤日誌
python -m uvicorn app.main:app --host 127.0.0.1 --port 8000
```

### 問題 2: 前端服務無法啟動

**可能原因**:
- Node.js 依賴未安裝
- 端口被占用

**解決方案**:
```bash
# 安裝依賴
cd saas-demo
npm install

# 檢查端口
netstat -ano | findstr :3000
```

### 問題 3: 帳號無法啟動

**檢查**:
- Session 文件是否存在
- API_ID 和 API_HASH 是否正確
- 查看後端日誌

### 問題 4: 無法提取角色

**檢查**:
- 劇本是否包含角色定義
- 劇本格式是否正確

---

## 📊 測試檢查清單

### 基礎功能
- [ ] 後端服務正常啟動
- [ ] 前端服務正常啟動
- [ ] 可以訪問 API 文檔
- [ ] 可以訪問前端界面

### 劇本管理
- [ ] 可以創建劇本
- [ ] 可以編輯劇本
- [ ] 可以刪除劇本
- [ ] 劇本格式驗證正常

### 帳號管理
- [ ] 可以添加帳號
- [ ] 可以啟動帳號
- [ ] 可以停止帳號
- [ ] 可以刪除帳號

### 聊天功能
- [ ] 帳號啟動時自動加載劇本
- [ ] 帳號啟動時自動初始化服務
- [ ] 帳號能接收群組消息
- [ ] 帳號能根據劇本自動回復

### 角色分配
- [ ] 可以提取角色
- [ ] 可以創建自動分配方案
- [ ] 可以創建手動分配方案
- [ ] 可以應用分配方案

---

## 🎯 測試重點

### 核心功能測試
1. **劇本和帳號聊天**: 確保帳號能根據劇本自動回復群組消息
2. **角色分配**: 確保角色能正確分配給帳號

### 邊界情況測試
1. **角色數 = 帳號數**: 一對一分配
2. **角色數 < 帳號數**: 部分帳號未使用
3. **角色數 > 帳號數**: 負載均衡分配

---

**最後更新**: 2025-01-07

