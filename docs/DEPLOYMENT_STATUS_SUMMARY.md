# éƒ¨ç½²çŠ¶æ€æ€»ç»“å’Œä¸‹ä¸€æ­¥æ“ä½œ

## âœ… å½“å‰éƒ¨ç½²çŠ¶æ€

### å·²å®Œæˆçš„é¡¹ç›®

1. **âœ… PM2 æœåŠ¡è¿è¡Œæ­£å¸¸**
   - å‰ç«¯æœåŠ¡ï¼šonlineï¼ˆç«¯å£ 3000ï¼‰
   - åç«¯æœåŠ¡ï¼šonlineï¼ˆç«¯å£ 8000ï¼‰

2. **âœ… ç«¯å£ç›‘å¬æ­£å¸¸**
   - ç«¯å£ 3000ï¼ˆå‰ç«¯ï¼‰ï¼šâœ… æ­£åœ¨ç›‘å¬
   - ç«¯å£ 8000ï¼ˆåç«¯ï¼‰ï¼šâœ… æ­£åœ¨ç›‘å¬

3. **âœ… å¥åº·æ£€æŸ¥é€šè¿‡**
   - å‰ç«¯ï¼šHTTP 200 OK
   - åç«¯ï¼šHTTP 200 OKï¼ˆ/docs ç«¯ç‚¹å¯è®¿é—®ï¼‰

4. **âœ… PM2 å¼€æœºè‡ªå¯å·²é…ç½®**
   - systemd æœåŠ¡å·²åˆ›å»ºå¹¶å¯ç”¨
   - PM2 æœåŠ¡åˆ—è¡¨å·²ä¿å­˜

5. **âœ… Nginx é…ç½®å®Œæˆ**
   - é…ç½®è¯­æ³•æ­£ç¡®
   - æœåŠ¡æ­£åœ¨è¿è¡Œ
   - å·²å¯ç”¨å¼€æœºè‡ªå¯

6. **âœ… ä¾èµ–å’Œé…ç½®**
   - psutil å·²å®‰è£…
   - .env æ–‡ä»¶å·²åˆ›å»ºï¼ˆOPENAI_API_KEY å¾…é…ç½®ï¼‰

---

## âš ï¸ éè‡´å‘½è­¦å‘Šï¼ˆå¯é€‰ä¿®å¤ï¼‰

ä»¥ä¸‹è­¦å‘Šä¸å½±å“æœåŠ¡è¿è¡Œï¼Œä½†å»ºè®®åç»­å¤„ç†ï¼š

1. **OPENAI_API_KEY æœªè®¾ç½®**
   - å½±å“ï¼šAI åŠŸèƒ½ä¸å¯ç”¨
   - ä¿®å¤ï¼šç¼–è¾‘ `/home/deployer/telegram-ai-system/admin-backend/.env`ï¼Œæ·»åŠ å®é™…çš„ API Key

2. **Alembic è¿ç§»è­¦å‘Š**
   - å½±å“ï¼šä½¿ç”¨åå¤‡æ–¹æ¡ˆåˆ›å»ºæ•°æ®åº“è¡¨
   - çŠ¶æ€ï¼šå½“å‰å¯æ­£å¸¸å·¥ä½œï¼Œæœªæ¥è¿ç§»éœ€è¦ä¿®å¤

3. **æœåŠ¡å™¨ç›‘æ§è¶…æ—¶**
   - å½±å“ï¼šæ— æ³•ç›‘æ§å¤–éƒ¨æœåŠ¡å™¨ï¼ˆlos-angeles, manilaï¼‰
   - çŠ¶æ€ï¼šå¯èƒ½æ˜¯ç½‘ç»œæˆ–é…ç½®é—®é¢˜ï¼Œä¸å½±å“æ ¸å¿ƒåŠŸèƒ½

---

## ğŸš€ ä¸‹ä¸€æ­¥æ“ä½œ

### æ­¥éª¤ 1ï¼šé…ç½® GitHub Actions SSH Keyï¼ˆæ¨èï¼‰

è¿™æ˜¯å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²çš„å…³é”®æ­¥éª¤ã€‚

**å‚è€ƒæ–‡æ¡£ï¼š** `docs/SETUP_GITHUB_ACTIONS_SSH.md`

**å¿«é€Ÿæ­¥éª¤ï¼š**

1. **åœ¨æœ¬åœ°ç”Ÿæˆ SSH å¯†é’¥**ï¼š
   ```bash
   ssh-keygen -t rsa -b 4096 -f ~/.ssh/github_deploy -N ""
   ```

2. **å°†å…¬é’¥æ·»åŠ åˆ°æœåŠ¡å™¨**ï¼š
   ```bash
   # å¤åˆ¶å…¬é’¥å†…å®¹
   cat ~/.ssh/github_deploy.pub
   
   # åœ¨æœåŠ¡å™¨ä¸Šæ·»åŠ åˆ° authorized_keys
   ssh deployer@your-server-ip
   mkdir -p ~/.ssh
   echo "ç²˜è´´å…¬é’¥å†…å®¹" >> ~/.ssh/authorized_keys
   chmod 600 ~/.ssh/authorized_keys
   ```

3. **å°†ç§é’¥æ·»åŠ åˆ° GitHub Secrets**ï¼š
   - è®¿é—®ï¼š`https://github.com/victor2025PH/liaotianai1201/settings/secrets/actions`
   - æ·»åŠ  Secretï¼š
     - `SERVER_SSH_KEY`ï¼šç§é’¥å®Œæ•´å†…å®¹ï¼ˆ`cat ~/.ssh/github_deploy`ï¼‰
     - `SERVER_HOST`ï¼šæœåŠ¡å™¨ IPï¼ˆä¾‹å¦‚ï¼š`10.56.61.200`ï¼‰
     - `SERVER_USER`ï¼š`deployer`

---

### æ­¥éª¤ 2ï¼šéªŒè¯ç½‘ç«™è®¿é—®

**åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š**
- `http://your-server-ip`ï¼ˆä½¿ç”¨æœåŠ¡å™¨ IPï¼‰
- æˆ– `http://your-domain.com`ï¼ˆå¦‚æœå·²é…ç½®åŸŸåï¼‰

**åº”è¯¥çœ‹åˆ°ï¼š**
- å‰ç«¯é¡µé¢æ­£å¸¸åŠ è½½
- API è¯·æ±‚æ­£å¸¸å·¥ä½œ
- ç½‘ç«™åŠŸèƒ½å¯ç”¨

---

### æ­¥éª¤ 3ï¼šé…ç½®åŸŸåå’Œ SSLï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ä½¿ç”¨åŸŸåå’Œ HTTPSï¼š

1. **é…ç½®åŸŸå DNS**ï¼š
   - å°†åŸŸå A è®°å½•æŒ‡å‘æœåŠ¡å™¨ IP

2. **ä½¿ç”¨ Certbot é…ç½® SSL**ï¼š
   ```bash
   sudo apt install certbot python3-certbot-nginx
   sudo certbot --nginx -d your-domain.com
   ```

3. **æ›´æ–° Nginx é…ç½®**ï¼š
   - ç¼–è¾‘ `/etc/nginx/sites-available/telegram-ai-system`
   - å°† `server_name _;` æ”¹ä¸º `server_name your-domain.com;`

---

### æ­¥éª¤ 4ï¼šé…ç½® OPENAI_API_KEYï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ AI åŠŸèƒ½ï¼š

```bash
# ç¼–è¾‘ .env æ–‡ä»¶
nano /home/deployer/telegram-ai-system/admin-backend/.env

# æ·»åŠ ï¼š
OPENAI_API_KEY=your_actual_api_key_here

# é‡å¯åç«¯æœåŠ¡
pm2 restart backend --update-env
```

---

## ğŸ“‹ æœ€ç»ˆéªŒè¯æ¸…å•

å®Œæˆæ‰€æœ‰æ­¥éª¤åï¼Œç¡®è®¤ï¼š

- [ ] å‰ç«¯æœåŠ¡è¿è¡Œæ­£å¸¸ï¼ˆç«¯å£ 3000ï¼‰
- [ ] åç«¯æœåŠ¡è¿è¡Œæ­£å¸¸ï¼ˆç«¯å£ 8000ï¼‰
- [ ] PM2 å¼€æœºè‡ªå¯å·²é…ç½®
- [ ] Nginx æ­£åœ¨è¿è¡Œ
- [ ] ç½‘ç«™å¯ä»¥ä»å¤–éƒ¨è®¿é—®
- [ ] GitHub Actions SSH Key å·²é…ç½®ï¼ˆå¦‚æœä½¿ç”¨è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼‰
- [ ] æµ‹è¯• GitHub Actions éƒ¨ç½²æˆåŠŸï¼ˆå¯é€‰ï¼‰

---

## ğŸ”§ å¸¸ç”¨ç®¡ç†å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
pm2 status
pm2 logs

# é‡å¯æœåŠ¡
pm2 restart all

# æŸ¥çœ‹ Nginx çŠ¶æ€
sudo systemctl status nginx

# æµ‹è¯• Nginx é…ç½®
sudo nginx -t

# é‡å¯ Nginx
sudo systemctl restart nginx

# æŸ¥çœ‹ç«¯å£ç›‘å¬
sudo ss -tlnp | grep -E "3000|8000"
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `docs/SETUP_GITHUB_ACTIONS_SSH.md` - GitHub Actions SSH é…ç½®
- `docs/DEPLOYMENT_COMPLETE_GUIDE.md` - å®Œæ•´éƒ¨ç½²æŒ‡å—
- `docs/FIX_BACKEND_WARNINGS.md` - åç«¯è­¦å‘Šä¿®å¤æŒ‡å—

---

## ğŸ‰ æ­å–œï¼

æ‚¨çš„ Telegram AI ç³»ç»Ÿå·²æˆåŠŸéƒ¨ç½²å¹¶è¿è¡Œï¼

å½“å‰çŠ¶æ€ï¼š
- âœ… æ‰€æœ‰æ ¸å¿ƒæœåŠ¡æ­£å¸¸è¿è¡Œ
- âœ… ç«¯å£ç›‘å¬æ­£å¸¸
- âœ… å¥åº·æ£€æŸ¥é€šè¿‡
- âœ… å¼€æœºè‡ªå¯å·²é…ç½®
- âœ… Nginx åå‘ä»£ç†å·²é…ç½®

ä¸‹ä¸€æ­¥ä¸»è¦æ˜¯é…ç½® GitHub Actions ä»¥å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œä»¥åŠæ ¹æ®éœ€æ±‚é…ç½®åŸŸåå’Œ SSLã€‚

---

**å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ç›¸å…³æ–‡æ¡£æˆ–æ£€æŸ¥æœåŠ¡æ—¥å¿—ï¼**
