# å®Œæ•´æ¸¬è©¦æ–¹æ³•ç¸½çµ

## ðŸ“š æ–‡æª”ç´¢å¼•

æˆ‘å·²ç¶“ç‚ºæ‚¨å‰µå»ºäº†å®Œæ•´çš„æ¸¬è©¦æ–‡æª”å’Œè‡ªå‹•åŒ–æ¸¬è©¦è…³æœ¬ï¼š

1. **TEST_METHODOLOGY.md** - è©³ç´°çš„æ¸¬è©¦æ–¹æ³•æ–‡æª”ï¼ˆç†è«–å’Œå¯¦è¸ï¼‰
2. **TEST_GUIDE.md** - å®Œæ•´çš„æ¸¬è©¦æŒ‡å—ï¼ˆåˆ†æ­¥é©Ÿèªªæ˜Žï¼‰
3. **QUICK_TEST_GUIDE.md** - å¿«é€Ÿæ¸¬è©¦æŒ‡å—ï¼ˆå¿«é€Ÿåƒè€ƒï¼‰
4. **run_all_tests.py** - è‡ªå‹•åŒ–æ¸¬è©¦åŸ·è¡Œè…³æœ¬

## ðŸš€ å¿«é€Ÿé–‹å§‹ï¼ˆæŽ¨è–¦ï¼‰

### æ–¹æ³• 1: ä¸€éµåŸ·è¡Œæ‰€æœ‰æ¸¬è©¦

```bash
cd admin-backend
python run_all_tests.py
```

é€™å€‹è…³æœ¬æœƒè‡ªå‹•åŸ·è¡Œï¼š
- âœ… ç’°å¢ƒæº–å‚™ï¼ˆæ•¸æ“šåº«åˆå§‹åŒ–ã€é·ç§»ï¼‰
- âœ… å–®å…ƒæ¸¬è©¦
- âœ… é›†æˆæ¸¬è©¦
- âœ… è‡ªå‹•åŒ–ä»»å‹™æ¸¬è©¦
- âœ… æ€§èƒ½æ¸¬è©¦
- âœ… ç”Ÿæˆæ¸¬è©¦å ±å‘Š

### æ–¹æ³• 2: åˆ†éšŽæ®µåŸ·è¡Œ

#### éšŽæ®µ 1: ç’°å¢ƒæº–å‚™

```bash
# 1. åˆå§‹åŒ–æ•¸æ“šåº«è¡¨
python init_db_tables.py

# 2. é‹è¡Œæ•¸æ“šåº«é·ç§»
python -m alembic upgrade head
```

#### éšŽæ®µ 2: æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦ï¼ˆæœ€é‡è¦ï¼‰

```bash
# è‡ªå‹•åŒ–ä»»å‹™åŠŸèƒ½å®Œæ•´æ¸¬è©¦
python test_automation_tasks.py
```

**æ¸¬è©¦å…§å®¹ï¼š**
- âœ… ä»»å‹™åŸ·è¡Œå™¨ï¼ˆå‰µå»ºã€åŸ·è¡Œã€çµ±è¨ˆï¼‰
- âœ… ä»»å‹™ä¾è³´èˆ‡è§¸ç™¼
- âœ… é€šçŸ¥é›†æˆ
- âœ… æ–°ä»»å‹™å‹•ä½œï¼ˆæ‰¹é‡æ“ä½œã€æ•¸æ“šå°Žå‡ºç­‰ï¼‰

**é æœŸçµæžœï¼š** âœ… æ‰€æœ‰æ¸¬è©¦é€šéŽ (3/3)

#### éšŽæ®µ 3: å–®å…ƒæ¸¬è©¦

```bash
# æœå‹™å±¤æ¸¬è©¦
python -m pytest tests/test_notification_service.py -v

# æ•¸æ“šæ¨¡åž‹æ¸¬è©¦
python -m pytest tests/test_db_crud.py -v
```

#### éšŽæ®µ 4: é›†æˆæ¸¬è©¦

```bash
# API æ¸¬è©¦
python -m pytest tests/test_api.py -v

# Group AI åŠŸèƒ½æ¸¬è©¦
python -m pytest tests/test_group_ai.py -v
```

#### éšŽæ®µ 5: æ€§èƒ½æ¸¬è©¦

```bash
python -m pytest tests/test_performance.py -v
```

## ðŸ“‹ è©³ç´°æ¸¬è©¦æ–¹æ³•

### 1. è‡ªå‹•åŒ–ä»»å‹™åŠŸèƒ½æ¸¬è©¦ï¼ˆæ ¸å¿ƒï¼‰

**æ¸¬è©¦æ–‡ä»¶ï¼š** `test_automation_tasks.py`

**åŸ·è¡Œï¼š**
```bash
python test_automation_tasks.py
```

**æ¸¬è©¦æ­¥é©Ÿè©³è§£ï¼š**

#### æ¸¬è©¦ 1: ä»»å‹™åŸ·è¡Œå™¨
1. **å‰µå»ºæ¸¬è©¦ä»»å‹™**
   - é©—è­‰ä»»å‹™å‰µå»ºæˆåŠŸ
   - æª¢æŸ¥ä»»å‹™é…ç½®ï¼ˆä¾è³´ã€é€šçŸ¥è¨­ç½®ï¼‰

2. **åŸ·è¡Œä»»å‹™**
   - é©—è­‰ä»»å‹™åŸ·è¡ŒæˆåŠŸ
   - æª¢æŸ¥åŸ·è¡Œçµæžœå’Œè€—æ™‚

3. **é©—è­‰çµ±è¨ˆæ›´æ–°**
   - `run_count` æ‡‰è©²å¢žåŠ 
   - `success_count` æ‡‰è©²å¢žåŠ 
   - `last_result` æ‡‰è©²æ›´æ–°

4. **æª¢æŸ¥é€šçŸ¥è¨˜éŒ„**
   - é©—è­‰é€šçŸ¥è¨˜éŒ„å‰µå»º
   - æª¢æŸ¥é€šçŸ¥å…§å®¹

5. **æ¸¬è©¦ä¾è³´ä»»å‹™**
   - å‰µå»ºä¾è³´ä»»å‹™
   - é…ç½®ä»»å‹™ä¾è³´é—œä¿‚
   - åŸ·è¡Œä¸»ä»»å‹™
   - é©—è­‰ä¾è³´ä»»å‹™è‡ªå‹•è§¸ç™¼

#### æ¸¬è©¦ 2: æ–°ä»»å‹™å‹•ä½œ
- `account_batch_start` - æ‰¹é‡å•Ÿå‹•è³¬è™Ÿ
- `account_batch_stop` - æ‰¹é‡åœæ­¢è³¬è™Ÿ
- `data_export` - æ•¸æ“šå°Žå‡º
- `role_assignment` - è§’è‰²åˆ†é…

#### æ¸¬è©¦ 3: é€šçŸ¥é›†æˆ
- ç™¼é€ç€è¦½å™¨é€šçŸ¥
- é©—è­‰é€šçŸ¥è¨˜éŒ„
- æª¢æŸ¥é€šçŸ¥å…§å®¹

### 2. API ç«¯é»žæ¸¬è©¦

**æ¸¬è©¦æ–¹æ³•ï¼š**

#### ä½¿ç”¨ curl æ¸¬è©¦

```bash
# 1. ç™»éŒ„ç²å– Token
TOKEN=$(curl -X POST "http://localhost:8000/api/v1/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=admin@example.com&password=admin123" \
  | jq -r '.access_token')

# 2. å‰µå»ºè‡ªå‹•åŒ–ä»»å‹™ï¼ˆå«ä¾è³´å’Œé€šçŸ¥é…ç½®ï¼‰
curl -X POST "http://localhost:8000/api/v1/group-ai/automation-tasks" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æ¸¬è©¦ä»»å‹™",
    "task_type": "scheduled",
    "task_action": "alert_check",
    "schedule_config": {"cron": "0 9 * * *"},
    "action_config": {},
    "dependent_tasks": ["task-id-1"],
    "notify_on_success": true,
    "notify_on_failure": true,
    "notify_recipients": ["admin@example.com"]
  }'

# 3. åŸ·è¡Œä»»å‹™
curl -X POST "http://localhost:8000/api/v1/group-ai/automation-tasks/{task_id}/run" \
  -H "Authorization: Bearer $TOKEN"

# 4. æŸ¥çœ‹ä»»å‹™æ—¥èªŒ
curl "http://localhost:8000/api/v1/group-ai/automation-tasks/{task_id}/logs" \
  -H "Authorization: Bearer $TOKEN"
```

#### ä½¿ç”¨ pytest æ¸¬è©¦

```bash
python -m pytest tests/test_api.py -v
python -m pytest tests/test_integration_api.py -v
```

### 3. å‰ç«¯åŠŸèƒ½æ¸¬è©¦ï¼ˆæ‰‹å‹•ï¼‰

#### æ¸¬è©¦é é¢æ¸…å–®

1. **è³¬è™Ÿç®¡ç†** (`/group-ai/accounts`)
   - [ ] åˆ—è¡¨é¡¯ç¤º
   - [ ] æœç´¢å’ŒéŽæ¿¾
   - [ ] æ‰¹é‡å‰µå»º
   - [ ] ç·¨è¼¯è³¬è™Ÿè³‡æ–™
   - [ ] æ‰¹é‡æ“ä½œ

2. **è‡ªå‹•åŒ–ä»»å‹™** (`/group-ai/automation-tasks`)
   - [ ] ä»»å‹™åˆ—è¡¨
   - [ ] å‰µå»ºä»»å‹™ï¼ˆå«ä¾è³´å’Œé€šçŸ¥é…ç½®ï¼‰
   - [ ] ç·¨è¼¯ä»»å‹™
   - [ ] åŸ·è¡Œä»»å‹™
   - [ ] æŸ¥çœ‹æ—¥èªŒ
   - [ ] **é©—è­‰ä¾è³´ä»»å‹™é¸æ“‡å™¨**
   - [ ] **é©—è­‰é€šçŸ¥é…ç½®UI**

3. **é€šçŸ¥ä¸­å¿ƒ** (`/notifications`)
   - [ ] é€šçŸ¥åˆ—è¡¨
   - [ ] æ‰¹é‡æ“ä½œ
   - [ ] é€šçŸ¥é…ç½®
   - [ ] é€šçŸ¥æ¨¡æ¿

## ðŸ“Š æ¸¬è©¦å ±å‘Š

### æŸ¥çœ‹æ¸¬è©¦çµæžœ

```bash
# æ¸¬è©¦ç¸½çµ
cat test_reports/test_summary.md

# è‡ªå‹•åŒ–ä»»å‹™æ¸¬è©¦å ±å‘Š
cat TEST_REPORT_AUTOMATION_TASKS.md

# è©³ç´°æ—¥èªŒ
cat test_reports/automation_tasks_test.log
```

### æ¸¬è©¦å ±å‘Šä½ç½®

- **æ¸¬è©¦ç¸½çµï¼š** `test_reports/test_summary.md`
- **è‡ªå‹•åŒ–ä»»å‹™å ±å‘Šï¼š** `TEST_REPORT_AUTOMATION_TASKS.md`
- **è©³ç´°æ—¥èªŒï¼š** `test_reports/*.log`
- **HTML å ±å‘Šï¼š** `test_reports/test_report.html`ï¼ˆå¦‚æžœå®‰è£äº† pytest-htmlï¼‰

## âœ… æ¸¬è©¦æª¢æŸ¥æ¸…å–®

### ç™¼å¸ƒå‰å¿…é ˆé€šéŽ

- [x] **è‡ªå‹•åŒ–ä»»å‹™æ¸¬è©¦** - âœ… é€šéŽ (3/3)
- [ ] **å–®å…ƒæ¸¬è©¦** - é‹è¡Œ `python -m pytest tests/ -v -m unit`
- [ ] **é›†æˆæ¸¬è©¦** - é‹è¡Œ `python -m pytest tests/ -v -m integration`
- [ ] **API æ¸¬è©¦** - é‹è¡Œ `python -m pytest tests/test_api.py -v`
- [ ] **æ€§èƒ½æ¸¬è©¦** - é‹è¡Œ `python -m pytest tests/test_performance.py -v`
- [ ] **å‰ç«¯åŠŸèƒ½æ¸¬è©¦** - æ‰‹å‹•æ¸¬è©¦æ‰€æœ‰é é¢

### æ–°åŠŸèƒ½é©—è­‰

#### è‡ªå‹•åŒ–ä»»å‹™æ“´å±•åŠŸèƒ½

- [x] âœ… ä¾è³´ä»»å‹™é…ç½®
- [x] âœ… é€šçŸ¥é…ç½®ï¼ˆæˆåŠŸ/å¤±æ•—ï¼‰
- [x] âœ… å¤šæŽ¥æ”¶äººæ”¯æŒ
- [x] âœ… æ–°ä»»å‹™å‹•ä½œï¼ˆæ‰¹é‡æ“ä½œã€æ•¸æ“šå°Žå‡ºç­‰ï¼‰

## ðŸ” å•é¡ŒæŽ’æŸ¥

### å¸¸è¦‹å•é¡Œ

1. **æ•¸æ“šåº«è¡¨ä¸å­˜åœ¨**
   ```bash
   python init_db_tables.py
   python -m alembic upgrade head
   ```

2. **æ¸¬è©¦æ•¸æ“šè¡çª**
   - æ¸¬è©¦è…³æœ¬æœƒè‡ªå‹•æ¸…ç†èˆŠæ•¸æ“š
   - ä½¿ç”¨ UUID ç”Ÿæˆå”¯ä¸€ ID

3. **æœå‹™æœªå•Ÿå‹•**
   ```bash
   python -m uvicorn app.main:app --host 0.0.0.0 --port 8000
   ```

## ðŸ“ˆ æ¸¬è©¦æŒ‡æ¨™

### ç•¶å‰ç‹€æ…‹

- **è‡ªå‹•åŒ–ä»»å‹™æ¸¬è©¦ï¼š** âœ… 100% é€šéŽ (3/3)
- **ä»»å‹™åŸ·è¡Œå™¨ï¼š** âœ… æ­£å¸¸
- **é€šçŸ¥é›†æˆï¼š** âœ… æ­£å¸¸
- **ä»»å‹™ä¾è³´ï¼š** âœ… æ­£å¸¸

### ç›®æ¨™æŒ‡æ¨™

- **æ¸¬è©¦è¦†è“‹çŽ‡ï¼š** > 80%
- **API éŸ¿æ‡‰æ™‚é–“ï¼š** < 500ms
- **æ¸¬è©¦é€šéŽçŽ‡ï¼š** 100%

## ðŸŽ¯ ä¸‹ä¸€æ­¥è¡Œå‹•

1. **é‹è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶**
   ```bash
   python run_all_tests.py
   ```

2. **æª¢æŸ¥æ¸¬è©¦å ±å‘Š**
   - æŸ¥çœ‹ `test_reports/test_summary.md`
   - æª¢æŸ¥å¤±æ•—çš„æ¸¬è©¦

3. **ä¿®å¾©ç™¼ç¾çš„å•é¡Œ**
   - æ ¹æ“šæ¸¬è©¦å ±å‘Šä¿®å¾©å•é¡Œ
   - é‡æ–°é‹è¡Œå¤±æ•—çš„æ¸¬è©¦

4. **å‰ç«¯åŠŸèƒ½é©—è­‰**
   - æ‰‹å‹•æ¸¬è©¦æ‰€æœ‰é é¢
   - é©—è­‰æ–°åŠŸèƒ½ï¼ˆä¾è³´ä»»å‹™ã€é€šçŸ¥é…ç½®ï¼‰

5. **æº–å‚™éƒ¨ç½²**
   - ç¢ºèªæ‰€æœ‰æ¸¬è©¦é€šéŽ
   - æª¢æŸ¥æ—¥èªŒç„¡éŒ¯èª¤
   - æº–å‚™éƒ¨ç½²æ–‡æª”

## ðŸ“– ç›¸é—œæ–‡æª”

- **è©³ç´°æ¸¬è©¦æ–¹æ³•ï¼š** `TEST_METHODOLOGY.md`
- **å®Œæ•´æ¸¬è©¦æŒ‡å—ï¼š** `TEST_GUIDE.md`
- **å¿«é€Ÿæ¸¬è©¦æŒ‡å—ï¼š** `QUICK_TEST_GUIDE.md`
- **è‡ªå‹•åŒ–ä»»å‹™æ¸¬è©¦å ±å‘Šï¼š** `TEST_REPORT_AUTOMATION_TASKS.md`

## ðŸ’¡ æç¤º

1. **å„ªå…ˆåŸ·è¡Œæ ¸å¿ƒæ¸¬è©¦**
   - å…ˆé‹è¡Œ `python test_automation_tasks.py` é©—è­‰æ ¸å¿ƒåŠŸèƒ½

2. **åˆ†éšŽæ®µåŸ·è¡Œ**
   - ä¸è¦ä¸€æ¬¡æ€§é‹è¡Œæ‰€æœ‰æ¸¬è©¦
   - å…ˆé‹è¡Œå–®å…ƒæ¸¬è©¦ï¼Œå†é‹è¡Œé›†æˆæ¸¬è©¦

3. **æŸ¥çœ‹è©³ç´°æ—¥èªŒ**
   - æ¸¬è©¦å¤±æ•—æ™‚æŸ¥çœ‹ `test_reports/*.log`
   - æª¢æŸ¥éŒ¯èª¤ä¿¡æ¯

4. **ä¿æŒæ¸¬è©¦ç’°å¢ƒä¹¾æ·¨**
   - æ¸¬è©¦å‰æ¸…ç†èˆŠæ•¸æ“š
   - ä½¿ç”¨æ¸¬è©¦å°ˆç”¨æ•¸æ“šåº«ï¼ˆå¯é¸ï¼‰

---

**æœ€å¾Œæ›´æ–°ï¼š** 2025-11-18
**æ¸¬è©¦ç‹€æ…‹ï¼š** âœ… è‡ªå‹•åŒ–ä»»å‹™åŠŸèƒ½æ¸¬è©¦é€šéŽ

