#!/usr/bin/env python3
"""
批量修复所有页面的 i18n 和按钮样式
"""
import os
import re

# 本地前端目录
LOCAL_BASE = r"E:\002-工作文件\重要程序\聊天AI群聊程序\saas-demo\src"

# 需要添加 i18n 的页面
PAGES_TO_FIX = [
    "app/group-ai/scripts/page.tsx",
    "app/group-ai/accounts/page.tsx",
    "app/group-ai/role-assignments/page.tsx",
    "app/group-ai/role-assignment-schemes/page.tsx",
    "app/group-ai/automation-tasks/page.tsx",
    "app/group-ai/monitor/page.tsx",
    "app/group-ai/nodes/page.tsx",
    "app/group-ai/groups/page.tsx",
    "app/sessions/page.tsx",
    "app/logs/page.tsx",
    "app/monitoring/page.tsx",
    "app/permissions/page.tsx",
]

# 繁体到简体中文的映射
ZH_TW_TO_ZH_CN = {
    # 通用
    "創建": "创建",
    "刪除": "删除",
    "編輯": "编辑",
    "儲存": "保存",
    "取消": "取消",
    "確認": "确认",
    "確定": "确定",
    "搜尋": "搜索",
    "搜索": "搜索",
    "篩選": "筛选",
    "匯出": "导出",
    "匯入": "导入",
    "導出": "导出",
    "導入": "导入",
    "重新整理": "刷新",
    "刷新": "刷新",
    "載入": "加载",
    "加載": "加载",
    "處理": "处理",
    "操作": "操作",
    "狀態": "状态",
    "設定": "设置",
    "設置": "设置",
    "詳情": "详情",
    "檢視": "查看",
    "查看": "查看",
    "關閉": "关闭",
    "開啟": "打开",
    "啟動": "启动",
    "停止": "停止",
    "暫停": "暂停",
    "繼續": "继续",
    "錯誤": "错误",
    "警告": "警告",
    "成功": "成功",
    "失敗": "失败",
    "資訊": "信息",
    "訊息": "消息",
    "通知": "通知",
    "全部": "全部",
    "選擇": "选择",
    "已選擇": "已选择",
    "取消選擇": "取消选择",
    "全選": "全选",
    "清除": "清除",
    "還原": "还原",
    "恢復": "恢复",
    "返回": "返回",
    "下一步": "下一步",
    "上一步": "上一步",
    "完成": "完成",
    "跳過": "跳过",
    "必填": "必填",
    "可選": "可选",
    "線上": "在线",
    "離線": "离线",
    "活躍": "活跃",
    "待處理": "待处理",
    "進行中": "进行中",
    "已完成": "已完成",
    "執行中": "运行中",
    "已停止": "已停止",
    "未知": "未知",
    "無": "无",
    "暫無": "暂无",
    "共": "共",
    "筆記錄": "条记录",
    "條記錄": "条记录",
    "頁": "页",
    "是": "是",
    "否": "否",
    
    # 导航和标题
    "總覽": "总览",
    "總覽儀表板": "总览仪表板",
    "節點管理": "节点管理",
    "劇本管理": "剧本管理",
    "帳號管理": "账号管理",
    "賬號管理": "账号管理",
    "角色分配": "角色分配",
    "分配方案": "分配方案",
    "自動化任務": "自动化任务",
    "群組監控": "群组监控",
    "會話列表": "会话列表",
    "日誌": "日志",
    "日誌中心": "日志中心",
    "系統監控": "系统监控",
    "告警設置": "告警设置",
    "權限管理": "权限管理",
    "步驟": "步骤",
    
    # 剧本相关
    "劇本": "剧本",
    "劇本列表": "剧本列表",
    "創建劇本": "创建剧本",
    "編輯劇本": "编辑剧本",
    "刪除劇本": "删除剧本",
    "測試劇本": "测试剧本",
    "劇本 ID": "剧本 ID",
    "劇本名稱": "剧本名称",
    "所有已創建的對話劇本": "所有已创建的对话剧本",
    "暫無劇本，點擊「創建劇本」開始": "暂无剧本，点击「创建剧本」开始",
    "搜索劇本名稱、ID或描述": "搜索剧本名称、ID或描述",
    "全部狀態": "全部状态",
    "創建時間": "创建时间",
    "更新時間": "更新时间",
    "降序": "降序",
    "升序": "升序",
    "角色數": "角色数",
    "訊息數": "消息数",
    "消息數": "消息数",
    "草稿": "草稿",
    "審核中": "审核中",
    "已審核通過": "已审核通过",
    "已拒絕": "已拒绝",
    "已發布": "已发布",
    "已停用": "已停用",
    "提交審核": "提交审核",
    "審核通過": "审核通过",
    "審核拒絕": "审核拒绝",
    "發布": "发布",
    "停用": "停用",
    "撤回": "撤回",
    "撤回為草稿": "撤回为草稿",
    "版本": "版本",
    "版本歷史": "版本历史",
    "測試": "测试",
    "智能轉換": "智能转换",
    "內容優化": "内容优化",
    "上傳文件": "上传文件",
    "YAML 內容": "YAML 内容",
    "描述": "描述",
    "批量刪除": "批量删除",
    "批量提交審核": "批量提交审核",
    "批量發布": "批量发布",
    "批量停用": "批量停用",
    "批量還原為草稿": "批量还原为草稿",
    
    # 账号相关
    "帳號": "账号",
    "賬號": "账号",
    "帳號列表": "账号列表",
    "賬號列表": "账号列表",
    "添加帳號": "添加账号",
    "添加賬號": "添加账号",
    "新增帳號": "添加账号",
    "掃描帳號": "扫描账号",
    "掃描賬號": "扫描账号",
    "掃描 Session": "扫描 Session",
    "手機號碼": "手机号码",
    "手機號": "手机号",
    "暱稱": "昵称",
    "使用者名稱": "用户名",
    "用戶名": "用户名",
    "分配角色": "分配角色",
    "關聯劇本": "关联剧本",
    "所屬節點": "所属节点",
    "所有帳號": "所有账号",
    "所有賬號": "所有账号",
    "暫無帳號": "暂无账号",
    "暫無賬號": "暂无账号",
    "全部伺服器": "全部服务器",
    "全部服務器": "全部服务器",
    "全部劇本": "全部剧本",
    "帳號 ID": "账号 ID",
    "賬號 ID": "账号 ID",
    "帳號狀態": "账号状态",
    "賬號狀態": "账号状态",
    "最後活躍": "最后活跃",
    "啟動帳號": "启动账号",
    "啟動賬號": "启动账号",
    "停止帳號": "停止账号",
    "停止賬號": "停止账号",
    
    # 节点相关
    "節點": "节点",
    "總節點": "总节点",
    "本地電腦": "本地电脑",
    "伺服器": "服务器",
    "服務器": "服务器",
    "遠端伺服器": "远程服务器",
    "遠程服務器": "远程服务器",
    "創建群組": "创建群组",
    "群組名稱": "群组名称",
    "選擇創建者": "选择创建者",
    "自動化控制": "自动化控制",
    "聊天間隔": "聊天间隔",
    "紅包間隔": "红包间隔",
    "秒": "秒",
    "聊天": "聊天",
    "紅包": "红包",
    "套用設定": "应用配置",
    "應用設定": "应用配置",
    "應用配置": "应用配置",
    "啟動聊天": "启动聊天",
    "節點列表": "节点列表",
    "本地": "本地",
    "最後心跳": "最后心跳",
    "暫無節點資料": "暂无节点数据",
    "暫無節點數據": "暂无节点数据",
    "掃描中": "扫描中",
    "掃描完成": "扫描完成",
    
    # 任务相关
    "任務": "任务",
    "創建任務": "创建任务",
    "任務列表": "任务列表",
    "所有自動化任務": "所有自动化任务",
    "暫無任務，點擊「創建任務」開始": "暂无任务，点击「创建任务」开始",
    "暫無任務": "暂无任务",
    "任務名稱": "任务名称",
    "任務類型": "任务类型",
    "執行計畫": "执行计划",
    "最後執行": "最后执行",
    "下次執行": "下次执行",
    "執行次數": "执行次数",
    "啟動任務": "启动任务",
    "停止任務": "停止任务",
    "編輯任務": "编辑任务",
    "刪除任務": "删除任务",
    "立即執行": "立即执行",
    "定時任務": "定时任务",
    "觸發式任務": "触发式任务",
    
    # 群组相关
    "群組": "群组",
    "活躍群組": "活跃群组",
    "總訊息數": "消息总数",
    "總消息數": "消息总数",
    "線上成員": "在线成员",
    "群組列表": "群组列表",
    "成員數": "成员数",
    "今日訊息": "今日消息",
    "今日消息": "今日消息",
    "最後訊息": "最后消息",
    "最後消息": "最后消息",
    "檢視群組": "查看群组",
    "查看群組": "查看群组",
    "靜音群組": "静音群组",
    "監控和管理所有": "监控和管理所有",
    "總群組數": "总群组数",
    "活躍群組": "活跃群组",
    "總消息數": "消息总数",
    "總成員數": "总成员数",
    "搜索群組名稱": "搜索群组名称",
    "AI 賬號": "AI 账号",
    "AI 帳號": "AI 账号",
    "真實用戶": "真实用户",
    "消息數": "消息数",
    "最後活動": "最后活动",
    "自動聊天": "自动聊天",
    "紅包遊戲": "红包游戏",
    
    # 会话相关
    "會話": "会话",
    "篩選條件": "筛选条件",
    "時間範圍": "时间范围",
    "會話記錄": "会话记录",
    "會話 ID": "会话 ID",
    "使用者": "用户",
    "用戶": "用户",
    "持續時間": "持续时间",
    "Token 用量": "Token 用量",
    "模型": "模型",
    "開始時間": "开始时间",
    "檢視會話": "查看会话",
    "匯出會話": "导出会话",
    "暫無會話記錄": "暂无会话记录",
    
    # 日志相关
    "搜尋日誌": "搜索日志",
    "搜索日誌": "搜索日志",
    "日誌記錄": "日志记录",
    "暫無日誌記錄": "暂无日志记录",
    "系統將自動收集": "系统将自动收集",
    "遠端伺服器和本地服務的日誌": "远程服务器和本地服务的日志",
    "日誌級別": "日志级别",
    "時間": "时间",
    "來源": "来源",
    "全部級別": "全部级别",
    
    # 系统监控
    "系統健康狀態": "系统健康状态",
    "最後更新": "最后更新",
    "整體健康度": "整体健康度",
    "運行時間": "运行时间",
    "服務持續運行": "服务持续运行",
    "當前版本號": "当前版本号",
    "資源使用情況": "资源使用情况",
    "CPU 使用率": "CPU 使用率",
    "記憶體使用率": "内存使用率",
    "記憶體": "内存",
    "磁碟使用率": "磁盘使用率",
    "磁碟": "磁盘",
    "活躍連線數": "活跃连接数",
    "活躍連接數": "活跃连接数",
    "佇列長度": "队列长度",
    "服務狀態": "服务状态",
    "各個服務組件的運行狀態": "各个服务组件的运行状态",
    "API 伺服器": "API 服务器",
    "API 服務器": "API 服务器",
    "資料庫": "数据库",
    "數據庫": "数据库",
    "響應時間": "响应时间",
    "正常": "正常",
    "異常": "异常",
    "天": "天",
    "小時": "小时",
    
    # 权限相关
    "角色管理": "角色管理",
    "使用者角色管理": "用户角色管理",
    "用戶角色管理": "用户角色管理",
    "初始化權限": "初始化权限",
    "創建權限": "创建权限",
    "沒有權限資料": "没有权限数据",
    "沒有權限數據": "没有权限数据",
    "權限代碼": "权限代码",
    "權限列表": "权限列表",
    "角色列表": "角色列表",
    "使用者列表": "用户列表",
    "用戶列表": "用户列表",
    "分配角色": "分配角色",
    "移除角色": "移除角色",
    
    # 其他
    "管理": "管理",
    "對話": "对话",
    "內容": "内容",
    "配置": "配置",
    "參數": "参数",
    "環境": "环境",
    "生產環境": "生产环境",
    "開發環境": "开发环境",
    "登出": "登出",
    "登入": "登录",
    "登錄": "登录",
    "語言": "语言",
    "主題": "主题",
    "學習": "学习",
    "教學": "教程",
    "幫助": "帮助",
    "即時": "实时",
    "實時": "实时",
    "自動": "自动",
    "手動": "手动",
    "遠端": "远程",
    "遠程": "远程",
    "本地": "本地",
    "伺服器": "服务器",
    "服務器": "服务器",
    "連接": "连接",
    "連線": "连接",
    "斷開": "断开",
    "重新連接": "重新连接",
    "重新連線": "重新连接",
    
    # 提示文本
    "請填寫所有必填項": "请填写所有必填项",
    "請輸入": "请输入",
    "請選擇": "请选择",
    "確定要": "确定要",
    "此操作無法撤銷": "此操作无法撤销",
    "無法": "无法",
    "正在": "正在",
    "已經": "已经",
    "尚未": "尚未",
    "變更說明": "变更说明",
    "審核意見": "审核意见",
    "點擊": "点击",
    "開始": "开始",
    "進行": "进行",
    "關聯": "关联",
    "創建者": "创建者",
    "電腦": "电脑",
    "執行": "执行",
    "檔案": "文件",
    "歷史": "历史",
    "對比": "对比",
    "恢復": "恢复",
    "還原": "还原",
    "選項": "选项",
    "欄位": "字段",
    "筆": "条",
    "個": "个",
    "處理中": "处理中",
    "輸入": "输入",
    "粘貼": "粘贴",
    "貼上": "粘贴",
    "複製": "复制",
    "格式": "格式",
    "轉換": "转换",
    "優化": "优化",
    "內容": "内容",
    "測試": "测试",
    "消息": "消息",
    "訊息": "消息",
    "回復": "回复",
    "輸入測試消息": "输入测试消息",
    "測試消息": "测试消息",
    "劇本回復": "剧本回复",
    "無法加載": "无法加载",
    "加載失敗": "加载失败",
    "加載中": "加载中",
    "請稍候": "请稍候",
    "讀取": "读取",
    "寫入": "写入",
    "驗證": "验证",
    "校驗": "校验",
    "檢查": "检查",
    "檢測": "检测",
    "監控": "监控",
    "監聽": "监听",
    "連接": "连接",
    "連線": "连接",
    "斷開": "断开",
    "斷線": "断开",
    "離線": "离线",
    "線上": "在线",
    "當前": "当前",
    "最後": "最后",
    "時間": "时间",
    "日期": "日期",
    "建立": "创建",
    "新增": "添加",
    "移除": "移除",
    "清空": "清空",
    "重設": "重置",
    "套用": "应用",
    "資料": "数据",
    "數據": "数据",
    "設定值": "设置值",
    "預設": "默认",
    "預覽": "预览",
    "匯入": "导入",
    "匯出": "导出",
    "資源": "资源",
    "資訊": "信息",
    "訊息": "消息",
    "狀態": "状态",
    "異常": "异常",
    "錯誤": "错误",
    "警告": "警告",
    "成功": "成功",
    "失敗": "失败",
    "待處理": "待处理",
    "處理中": "处理中",
    "已處理": "已处理",
    "已完成": "已完成",
    "未完成": "未完成",
    "已開始": "已开始",
    "未開始": "未开始",
    "已結束": "已结束",
    "運行中": "运行中",
    "已停止": "已停止",
    "暫停中": "暂停中",
}

def convert_tw_to_cn(content: str) -> str:
    """将繁体中文转换为简体中文"""
    for tw, cn in ZH_TW_TO_ZH_CN.items():
        content = content.replace(tw, cn)
    return content

def add_i18n_import(content: str) -> str:
    """添加 i18n 导入"""
    if 'useI18n' not in content:
        # 在第一个 import 语句后添加 i18n 导入
        import_pattern = r'("use client".*?\n)'
        if re.search(import_pattern, content, re.DOTALL):
            content = re.sub(
                import_pattern,
                r'\1import { useI18n } from "@/lib/i18n";\n',
                content,
                count=1,
                flags=re.DOTALL
            )
    return content

def process_file(file_path: str):
    """处理单个文件"""
    full_path = os.path.join(LOCAL_BASE, file_path)
    
    if not os.path.exists(full_path):
        print(f"  ⚠ 文件不存在: {file_path}")
        return False
    
    try:
        with open(full_path, 'r', encoding='utf-8') as f:
            content = f.read()
        
        # 转换繁体到简体
        new_content = convert_tw_to_cn(content)
        
        # 写回文件
        with open(full_path, 'w', encoding='utf-8') as f:
            f.write(new_content)
        
        print(f"  ✓ 已处理: {file_path}")
        return True
    except Exception as e:
        print(f"  ✗ 处理失败 {file_path}: {e}")
        return False

def main():
    print("开始批量修复 i18n 和按钮样式...")
    print(f"本地目录: {LOCAL_BASE}\n")
    
    success_count = 0
    fail_count = 0
    
    for file_path in PAGES_TO_FIX:
        if process_file(file_path):
            success_count += 1
        else:
            fail_count += 1
    
    # 也处理组件文件
    component_files = [
        "components/step-indicator.tsx",
        "components/dashboard/response-time-chart.tsx",
        "components/dashboard/system-status.tsx",
    ]
    
    print("\n处理组件文件...")
    for file_path in component_files:
        if process_file(file_path):
            success_count += 1
        else:
            fail_count += 1
    
    print(f"\n完成！成功: {success_count}, 失败: {fail_count}")

if __name__ == "__main__":
    main()

