# 前端后端测试报告

## 测试时间
2024年12月（具体时间根据实际执行时间填写）

## 服务启动状态

### 后端服务
- **状态**: ✅ 运行中
- **地址**: http://localhost:8000
- **API Base**: http://localhost:8000/api/v1
- **健康检查**: ✅ 通过 (`/health` 返回 `ok`)

### 前端服务
- **状态**: ✅ 运行中
- **地址**: http://localhost:3000 (Next.js saas-demo)
- **备用地址**: http://localhost:5173 (Vite admin-frontend)

## 服务器配置

已更新 `data/master_config.json`，包含三个服务器：

1. **worker-01**
   - IP: 165.154.254.99
   - 部署目录: /home/ubuntu
   - 最大账号数: 5

2. **los-angeles**
   - IP: 165.154.255.48
   - 部署目录: /home/ubuntu
   - 最大账号数: 5

3. **manila**
   - IP: 165.154.233.179
   - 部署目录: /home/ubuntu
   - 最大账号数: 5

## 前端页面访问地址

### 服务器管理页面
- **URL**: http://localhost:3000/group-ai/servers
- **功能**: 
  - 显示所有服务器状态（online/offline/error）
  - 显示每个服务器的账号数量
  - 显示服务器资源使用情况（CPU、内存、磁盘）
  - 服务器操作（启动、停止、重启）

### 账号管理页面
- **URL**: http://localhost:3000/group-ai/accounts
- **功能**:
  - 显示所有账号列表
  - 显示账号状态（online/offline/error）
  - 显示账号关联的服务器
  - 账号操作（启动、停止、删除、编辑）

## API 端点

### 服务器相关
- `GET /api/v1/group-ai/servers/` - 获取所有服务器列表
- `GET /api/v1/group-ai/servers/{node_id}` - 获取单个服务器状态
- `GET /api/v1/group-ai/servers/{node_id}/logs` - 获取服务器日志
- `POST /api/v1/group-ai/servers/{node_id}/action` - 执行服务器操作

### 账号相关
- `GET /api/v1/group-ai/accounts` - 获取账号列表
- `GET /api/v1/group-ai/accounts/{account_id}` - 获取账号详情
- `POST /api/v1/group-ai/accounts` - 创建账号
- `PUT /api/v1/group-ai/accounts/{account_id}` - 更新账号
- `DELETE /api/v1/group-ai/accounts/{account_id}` - 删除账号

## 认证说明

所有 API 端点都需要认证（JWT Token）。前端会自动处理认证：
1. 用户登录后，前端会获取 JWT Token
2. 前端会在所有 API 请求中自动添加 `Authorization: Bearer <token>` 头
3. 如果 Token 过期，前端会自动跳转到登录页面

## 测试步骤

1. **打开前端页面**
   - 访问 http://localhost:3000
   - 使用默认账号登录: `admin@example.com` / `changeme123`

2. **查看服务器列表**
   - 导航到 "服务器管理" 页面
   - 应该能看到三个服务器的状态
   - 检查每个服务器的账号数量是否正确

3. **查看账号列表**
   - 导航到 "账号管理" 页面
   - 应该能看到所有账号的信息
   - 检查每个账号关联的服务器是否正确

4. **验证数据同步**
   - 服务器状态应该实时反映远程服务器的实际状态
   - 账号状态应该从 AccountManager 获取实时数据

## 已知问题

1. **API 认证**
   - 直接访问 API 需要提供有效的 JWT Token
   - 建议通过前端页面访问，前端会自动处理认证

2. **服务器状态查询**
   - 服务器状态通过 SSH 实时查询，可能需要几秒钟
   - 如果 SSH 连接失败，服务器状态会显示为 "error"

3. **账号数量统计**
   - 账号数量通过统计 Session 文件数量获取
   - 如果 Session 文件不在预期位置，数量可能不准确

## 下一步

1. ✅ 服务已启动
2. ✅ 配置已更新
3. ⏳ **待测试**: 在浏览器中打开前端页面，验证服务器和账号信息是否正确显示
4. ⏳ **待验证**: 检查服务器状态是否实时更新
5. ⏳ **待验证**: 检查账号列表是否包含所有部署的账号

## 注意事项

- 确保后端服务持续运行
- 确保前端服务持续运行
- 如果修改了 `master_config.json`，需要重启后端服务才能生效
- 如果前端无法显示数据，检查浏览器控制台的错误信息

