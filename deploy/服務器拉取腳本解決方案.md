# æœå‹™å™¨ç„¡æ³•æ‹‰å–è…³æœ¬æ–‡ä»¶ - å®Œæ•´è§£æ±ºæ–¹æ¡ˆ

## âœ… ç¢ºèªç‹€æ…‹

æ ¹æ“šæª¢æŸ¥çµæœï¼š
1. **æœ¬åœ°æ–‡ä»¶å­˜åœ¨**ï¼šæ‰€æœ‰ä¸‰å€‹è…³æœ¬æ–‡ä»¶éƒ½åœ¨æœ¬åœ°å­˜åœ¨
2. **æ–‡ä»¶åœ¨ Git HEAD ä¸­**ï¼š`git ls-tree HEAD` ç¢ºèªæ–‡ä»¶åœ¨ç•¶å‰æäº¤ä¸­
3. **æ–‡ä»¶åœ¨é ç¨‹å€‰åº«ä¸­**ï¼š`git ls-tree origin/main` ç¢ºèªæ–‡ä»¶åœ¨é ç¨‹ `origin/main` åˆ†æ”¯ä¸­
4. **æœ¬åœ°å’Œé ç¨‹åŒæ­¥**ï¼š`git push origin main` é¡¯ç¤º "Everything up-to-date"

## ğŸ” å•é¡ŒåŸå› åˆ†æ

æ–‡ä»¶å·²ç¶“åœ¨é ç¨‹å€‰åº«ä¸­ï¼Œä½†æœå‹™å™¨ä¸Šæ‹‰å–ä¸åˆ°ï¼Œå¯èƒ½çš„åŸå› ï¼š

### åŸå›  1ï¼šæœå‹™å™¨ä¸Šçš„åˆ†æ”¯ä¸æ­£ç¢º
- æœå‹™å™¨å¯èƒ½ä¸åœ¨ `main` åˆ†æ”¯
- æˆ–è€…åœ¨éŒ¯èª¤çš„åˆ†æ”¯ä¸ŠåŸ·è¡Œ `git pull`

### åŸå›  2ï¼šå·¥ä½œç›®éŒ„èˆ‡ Git å€‰åº«ä¸åŒæ­¥
- æ–‡ä»¶åœ¨ Git ä¸­ä½†æ²’æœ‰è¢« checkout åˆ°å·¥ä½œç›®éŒ„
- å¯èƒ½æœ‰ `.gitignore` è¦å‰‡é˜»æ­¢æ–‡ä»¶è¢«æå–

### åŸå›  3ï¼šç·©å­˜æˆ–ç´¢å¼•å•é¡Œ
- Git ç´¢å¼•å¯èƒ½æå£
- éœ€è¦é‡ç½®æˆ–æ¸…ç†ç·©å­˜

### åŸå›  4ï¼šé ç¨‹å€‰åº«é…ç½®å•é¡Œ
- `origin` æŒ‡å‘éŒ¯èª¤çš„é ç¨‹å€‰åº«
- æˆ–è€…é ç¨‹å€‰åº« URL é…ç½®ä¸æ­£ç¢º

## ğŸ› ï¸ è§£æ±ºæ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šåœ¨æœå‹™å™¨ä¸Šå¼·åˆ¶åŒæ­¥ï¼ˆæ¨è–¦ï¼‰

åœ¨æœå‹™å™¨ä¸ŠåŸ·è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
cd ~/liaotian

# 1. æª¢æŸ¥ç•¶å‰åˆ†æ”¯
git branch -a
git status

# 2. ç¢ºèªé ç¨‹å€‰åº«é…ç½®
git remote -v

# 3. æ‹‰å–æœ€æ–°ä»£ç¢¼ï¼ˆå¼·åˆ¶ï¼‰
git fetch origin
git fetch origin main

# 4. æª¢æŸ¥é ç¨‹å€‰åº«ä¸­æ˜¯å¦æœ‰é€™äº›æ–‡ä»¶
git ls-tree origin/main deploy/fix_and_deploy_frontend.sh
git ls-tree origin/main deploy/deploy_frontend_simple.sh
git ls-tree origin/main deploy/check_and_fix_frontend.sh

# 5. åˆ‡æ›åˆ° main åˆ†æ”¯ï¼ˆå¦‚æœä¸åœ¨ï¼‰
git checkout main

# 6. é‡ç½®åˆ°é ç¨‹åˆ†æ”¯ï¼ˆè¬¹æ…ä½¿ç”¨ï¼‰
git reset --hard origin/main

# æˆ–è€…ä½¿ç”¨ mergeï¼ˆæ›´å®‰å…¨ï¼‰
git pull origin main

# 7. å¼·åˆ¶ checkout é€™äº›æ–‡ä»¶
git checkout origin/main -- deploy/fix_and_deploy_frontend.sh
git checkout origin/main -- deploy/deploy_frontend_simple.sh
git checkout origin/main -- deploy/check_and_fix_frontend.sh

# 8. é©—è­‰æ–‡ä»¶å­˜åœ¨
ls -la deploy/fix_and_deploy_frontend.sh
ls -la deploy/deploy_frontend_simple.sh
ls -la deploy/check_and_fix_frontend.sh
```

### æ–¹æ¡ˆ 2ï¼šç›´æ¥å¾é ç¨‹å€‰åº«ç²å–æ–‡ä»¶

å¦‚æœæ–¹æ¡ˆ 1 ä¸è¡Œï¼Œå¯ä»¥ç›´æ¥å¾é ç¨‹ç²å–ï¼š

```bash
cd ~/liaotian

# å¾é ç¨‹åˆ†æ”¯ç›´æ¥ç²å–æ–‡ä»¶
git show origin/main:deploy/fix_and_deploy_frontend.sh > deploy/fix_and_deploy_frontend.sh
git show origin/main:deploy/deploy_frontend_simple.sh > deploy/deploy_frontend_simple.sh
git show origin/main:deploy/check_and_fix_frontend.sh > deploy/check_and_fix_frontend.sh

# è¨­ç½®åŸ·è¡Œæ¬Šé™
chmod +x deploy/fix_and_deploy_frontend.sh
chmod +x deploy/deploy_frontend_simple.sh
chmod +x deploy/check_and_fix_frontend.sh

# é©—è­‰
ls -la deploy/*.sh
```

### æ–¹æ¡ˆ 3ï¼šæ‰‹å‹•å‰µå»ºè…³æœ¬æ–‡ä»¶

å¦‚æœä»¥ä¸Šæ–¹æ¡ˆéƒ½ä¸è¡Œï¼Œå¯ä»¥ç›´æ¥å‰µå»ºï¼š

```bash
cd ~/liaotian/deploy

# å‰µå»º fix_and_deploy_frontend.sh
cat > fix_and_deploy_frontend.sh << 'EOF'
#!/bin/bash
# ä¿®å¾©ç«¯å£ä½”ç”¨ä¸¦éƒ¨ç½²å‰ç«¯
set -e
cd ~/liaotian
git pull
pkill -f "next-server" 2>/dev/null || true
pkill -f "node.*next" 2>/dev/null || true
sleep 3
cd saas-demo
rm -rf .next node_modules/.cache
npm install
npm run build
nohup npm start > /tmp/frontend.log 2>&1 &
echo "å‰ç«¯å·²å•Ÿå‹•"
sleep 10
ps aux | grep "node.*next" | grep -v grep
EOF

chmod +x fix_and_deploy_frontend.sh
```

## ğŸ“‹ è¨ºæ–·æ­¥é©Ÿ

åœ¨æœå‹™å™¨ä¸ŠåŸ·è¡Œä»¥ä¸‹è¨ºæ–·å‘½ä»¤ï¼š

```bash
cd ~/liaotian

# 1. æª¢æŸ¥ Git ç‹€æ…‹
echo "=== Git ç‹€æ…‹ ==="
git status
git branch -a

# 2. æª¢æŸ¥é ç¨‹é…ç½®
echo "=== é ç¨‹å€‰åº« ==="
git remote -v

# 3. æª¢æŸ¥æ–‡ä»¶æ˜¯å¦åœ¨é ç¨‹
echo "=== æª¢æŸ¥é ç¨‹æ–‡ä»¶ ==="
git ls-tree origin/main deploy/ | grep -E "fix_and_deploy|deploy_frontend|check_and_fix"

# 4. æª¢æŸ¥æœ¬åœ°æ–‡ä»¶
echo "=== æª¢æŸ¥æœ¬åœ°æ–‡ä»¶ ==="
ls -la deploy/ | grep -E "fix_and_deploy|deploy_frontend|check_and_fix"

# 5. æª¢æŸ¥ .gitignore
echo "=== æª¢æŸ¥ .gitignore ==="
git check-ignore -v deploy/fix_and_deploy_frontend.sh deploy/deploy_frontend_simple.sh deploy/check_and_fix_frontend.sh

# 6. å¼·åˆ¶åŒæ­¥
echo "=== å¼·åˆ¶åŒæ­¥ ==="
git fetch --all
git checkout origin/main -- deploy/fix_and_deploy_frontend.sh deploy/deploy_frontend_simple.sh deploy/check_and_fix_frontend.sh
```

## ğŸ¯ æœ€å¯èƒ½çš„åŸå› 

æ ¹æ“šç•¶å‰æƒ…æ³ï¼Œæœ€å¯èƒ½çš„åŸå› æ˜¯ï¼š

1. **æœå‹™å™¨ä¸Šçš„å·¥ä½œç›®éŒ„æ²’æœ‰æ›´æ–°**ï¼šæ–‡ä»¶åœ¨ Git ç´¢å¼•ä¸­ï¼Œä½†æ²’æœ‰è¢« checkout åˆ°å·¥ä½œç›®éŒ„
2. **åˆ†æ”¯ä¸ä¸€è‡´**ï¼šæœå‹™å™¨å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯ä¸Š
3. **Git ç·©å­˜å•é¡Œ**ï¼šéœ€è¦æ¸…ç†ç·©å­˜æˆ–é‡ç½®

å»ºè­°å…ˆåŸ·è¡Œ**æ–¹æ¡ˆ 1**çš„è¨ºæ–·æ­¥é©Ÿï¼Œç„¶å¾Œæ ¹æ“šçµæœåŸ·è¡Œç›¸æ‡‰çš„ä¿®å¾©å‘½ä»¤ã€‚
