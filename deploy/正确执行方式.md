# 正确执行 SSH 测试的方式

## 问题说明

从截图看到，您在 CMD 中使用了错误的命令格式。

## 正确的执行方式

### 方式 1：执行批处理文件（CMD）

**错误的方式**：
```cmd
cd E:\002-工作文件\重要程序\聊天AI群聊程序\deploy\使用CMD测试SSH.bat
```
（这是尝试切换到一个文件，会报错）

**正确的方式**：
```cmd
cd E:\002-工作文件\重要程序\聊天AI群聊程序\deploy
使用CMD测试SSH.bat
```

或者一行命令：
```cmd
cd /d E:\002-工作文件\重要程序\聊天AI群聊程序\deploy && 使用CMD测试SSH.bat
```

### 方式 2：在 PowerShell 中直接执行命令（推荐）

您已经在 PowerShell 中执行了，这是正确的方式！

继续执行以下命令：

```powershell
# 1. 检查 Nginx 配置（您已经执行了）
ssh ubuntu@165.154.233.55 "sudo nginx -t"

# 2. 检查 WebSocket 配置（最重要，您准备执行）
ssh ubuntu@165.154.233.55 "sudo grep -A 15 'location /api/v1/notifications/ws' /etc/nginx/sites-available/aikz.usdt2026.cc"

# 3. 检查服务状态
ssh ubuntu@165.154.233.55 "sudo systemctl is-active nginx"
ssh ubuntu@165.154.233.55 "sudo systemctl is-active liaotian-backend"
```

## 执行步骤

1. **在 PowerShell 中执行 WebSocket 配置检查**（您已经在做了）
2. **查看输出结果**，告诉我：
   - 如果看到 WebSocket location 配置块 → 配置存在
   - 如果没有任何输出 → 配置不存在，需要修复
3. **根据结果决定下一步**：
   - 如果配置存在 → 检查其他问题
   - 如果配置不存在 → 执行修复脚本

## 修复脚本（如果配置不存在）

如果 WebSocket 配置不存在，执行：

```powershell
# 1. 上传修复脚本
scp deploy/最终修复WebSocket-完整版.sh ubuntu@165.154.233.55:/tmp/修复WS.sh

# 2. 执行修复
ssh ubuntu@165.154.233.55 "chmod +x /tmp/修复WS.sh && sudo bash /tmp/修复WS.sh"

# 3. 再次验证
ssh ubuntu@165.154.233.55 "sudo grep -A 15 'location /api/v1/notifications/ws' /etc/nginx/sites-available/aikz.usdt2026.cc"
```

