# æœ€ç°¡å–®çš„é‡å•Ÿå’Œæ¸¬è©¦æ–¹æ³•

> **æ—¥æœŸ**: 2025-12-01

---

## ğŸ¯ æ–¹æ³•ï¼šç›´æ¥æª¢æŸ¥ä¸¦é‡å•Ÿï¼ˆå¦‚æœå¾Œç«¯ä¹‹å‰é‹è¡Œéï¼‰

ç”±æ–¼å¾Œç«¯ä¹‹å‰èƒ½æ­£å¸¸é‹è¡Œï¼ˆhealth æª¢æŸ¥è¿”å› okï¼‰ï¼Œèªªæ˜é …ç›®ç›®éŒ„æ˜¯å­˜åœ¨çš„ã€‚æˆ‘å€‘å¯ä»¥ï¼š

### æ­¥é©Ÿ 1: æª¢æŸ¥å¾Œç«¯æ˜¯å¦çœŸçš„åœæ­¢äº†

```bash
# æª¢æŸ¥é€²ç¨‹
ps aux | grep uvicorn | grep -v grep

# æª¢æŸ¥ç«¯å£
lsof -i :8000 || netstat -tlnp | grep :8000

# æ¸¬è©¦å¥åº·æª¢æŸ¥
curl http://localhost:8000/health
```

å¦‚æœå¥åº·æª¢æŸ¥é‚„è¿”å› `{"status":"ok"}`ï¼Œèªªæ˜å¾Œç«¯é‚„åœ¨é‹è¡Œï¼Œç›´æ¥è·³åˆ°**æ¸¬è©¦æ­¥é©Ÿ**ã€‚

---

### æ­¥é©Ÿ 2: å¦‚æœå¾Œç«¯å·²åœæ­¢ï¼ŒæŸ¥æ‰¾ä¸¦é‡å•Ÿ

```bash
# æŸ¥æ‰¾é …ç›®ç›®éŒ„ï¼ˆå¾å¯èƒ½çš„æ—¥èªŒæ–‡ä»¶ä½ç½®æ¨æ–·ï¼‰
# å¾Œç«¯å¯èƒ½åœ¨æŸå€‹åœ°æ–¹é‹è¡Œï¼Œæª¢æŸ¥é€²ç¨‹çš„å·¥ä½œç›®éŒ„
ps aux | grep uvicorn | grep -v grep

# æˆ–è€…ç›´æ¥å˜—è©¦å¸¸è¦‹è·¯å¾‘
cd ~/telegram-ai-system/admin-backend 2>/dev/null && echo "æ‰¾åˆ°è·¯å¾‘: ~/telegram-ai-system/admin-backend" || \
cd /opt/group-ai/admin-backend 2>/dev/null && echo "æ‰¾åˆ°è·¯å¾‘: /opt/group-ai/admin-backend" || \
cd ~/group-ai/admin-backend 2>/dev/null && echo "æ‰¾åˆ°è·¯å¾‘: ~/group-ai/admin-backend" || \
echo "éœ€è¦æ‰‹å‹•æŸ¥æ‰¾ç›®éŒ„"

# å¦‚æœæ‰¾åˆ°äº†ï¼Œé‡å•Ÿ
if [ -f "app/main.py" ]; then
    echo "âœ… æ‰¾åˆ°å¾Œç«¯ç›®éŒ„: $(pwd)"
    
    # æ¿€æ´»è™›æ“¬ç’°å¢ƒ
    source ../.venv/bin/activate 2>/dev/null || source .venv/bin/activate 2>/dev/null
    
    # å•Ÿå‹•æœå‹™
    nohup python3 -m uvicorn app.main:app --host 0.0.0.0 --port 8000 > /tmp/backend.log 2>&1 &
    sleep 5
    
    # é©—è­‰
    curl http://localhost:8000/health
else
    echo "âŒ æœªæ‰¾åˆ°å¾Œç«¯ç›®éŒ„ï¼Œéœ€è¦æ‰‹å‹•æŸ¥æ‰¾"
fi
```

---

### æ­¥é©Ÿ 3: æ¸¬è©¦ä¿®å¾©

```bash
TOKEN=$(curl -s -X POST "http://localhost:8000/api/v1/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=admin@example.com&password=changeme123" | \
  python3 -c "import sys, json; print(json.loads(sys.stdin.read()).get('access_token', ''))") && \
curl -s -o /tmp/status.json -w "HTTPç‹€æ…‹ç¢¼: %{http_code}\n" \
  -H "Authorization: Bearer $TOKEN" \
  "http://localhost:8000/api/v1/group-ai/accounts/639454959591/status" && \
echo "" && \
echo "éŸ¿æ‡‰å…§å®¹:" && \
python3 -m json.tool /tmp/status.json
```

---

## ğŸš€ ä¸€éµåŸ·è¡Œï¼ˆæœ€ç°¡å–®ï¼‰

å¦‚æœå¾Œç«¯ä¹‹å‰èƒ½é‹è¡Œï¼Œå¯èƒ½æ˜¯å› ç‚ºåœæ­¢å‘½ä»¤åŸ·è¡Œäº†ä½†æœå‹™å¯¦éš›é‚„åœ¨é‹è¡Œã€‚å…ˆæª¢æŸ¥ï¼š

```bash
# å…ˆæª¢æŸ¥æœå‹™æ˜¯å¦é‚„åœ¨é‹è¡Œ
if curl -s http://localhost:8000/health | grep -q "ok"; then
    echo "âœ… å¾Œç«¯æœå‹™ä»åœ¨é‹è¡Œï¼Œç›´æ¥æ¸¬è©¦"
    TOKEN=$(curl -s -X POST "http://localhost:8000/api/v1/auth/login" \
      -H "Content-Type: application/x-www-form-urlencoded" \
      -d "username=admin@example.com&password=changeme123" | \
      python3 -c "import sys, json; print(json.loads(sys.stdin.read()).get('access_token', ''))") && \
    curl -s -o /tmp/status.json -w "HTTPç‹€æ…‹ç¢¼: %{http_code}\n" \
      -H "Authorization: Bearer $TOKEN" \
      "http://localhost:8000/api/v1/group-ai/accounts/639454959591/status" && \
    echo "" && \
    python3 -m json.tool /tmp/status.json
else
    echo "âš ï¸ å¾Œç«¯æœå‹™å·²åœæ­¢ï¼Œéœ€è¦é‡å•Ÿ"
    echo "è«‹å…ˆæ‰¾åˆ°é …ç›®ç›®éŒ„ä¸¦é‡å•Ÿæœå‹™"
fi
```

---

**å…ˆåŸ·è¡Œæœ€å¾Œé€™å€‹ä¸€éµæª¢æŸ¥å‘½ä»¤ï¼Œå‘Šè¨´æˆ‘çµæœï¼**
