# 程序測試清單

## 測試程序列表

### 1. 後端API服務

**程序名稱**: `admin-backend`  
**啟動命令**: 
```bash
cd admin-backend
$env:PYTHONPATH = (Get-Location).Parent.FullName
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```
**服務地址**: http://localhost:8000  
**進程檢查**: `Get-Process | Where-Object {$_.ProcessName -eq "python"}`

#### 測試內容

| 測試項目 | 測試方法 | 預期結果 | 狀態 |
|---------|---------|---------|------|
| 健康檢查 | `curl http://localhost:8000/health` | `{"status":"ok"}` | ⏳ |
| API文檔 | 訪問 http://localhost:8000/docs | Swagger UI正常顯示 | ⏳ |
| 服務器列表API | `curl http://localhost:8000/api/v1/group-ai/servers/` | 返回服務器列表JSON | ⏳ |
| 帳號列表API | `curl http://localhost:8000/api/v1/group-ai/accounts` | 返回帳號列表JSON | ⏳ |
| 劇本列表API | `curl http://localhost:8000/api/v1/group-ai/scripts` | 返回劇本列表JSON | ⏳ |

---

### 2. 前端服務

**程序名稱**: `saas-demo`  
**啟動命令**: 
```bash
cd saas-demo
npm run dev
```
**服務地址**: http://localhost:3000  
**進程檢查**: `Get-Process | Where-Object {$_.ProcessName -eq "node"}`

#### 測試內容

| 測試頁面 | 訪問地址 | 測試項目 | 狀態 |
|---------|---------|---------|------|
| 服務器管理 | http://localhost:3000/group-ai/servers | 1. 頁面正常加載<br>2. 服務器列表顯示<br>3. 狀態正確顯示<br>4. 自動刷新功能<br>5. 啟動/停止/重啟按鈕<br>6. 日誌查看功能 | ⏳ |
| 帳號管理 | http://localhost:3000/group-ai/accounts | 1. 頁面正常加載<br>2. 帳號列表顯示<br>3. 創建帳號功能<br>4. 上傳Session文件<br>5. 啟動/停止帳號<br>6. 刪除帳號功能<br>7. Session掃描功能 | ⏳ |
| 角色分配 | http://localhost:3000/group-ai/role-assignments | 1. 頁面正常加載<br>2. 角色列表顯示<br>3. 提取角色功能<br>4. 分配角色功能 | ⏳ |
| 劇本管理 | http://localhost:3000/group-ai/scripts | 1. 頁面正常加載<br>2. 劇本列表顯示<br>3. 上傳劇本功能<br>4. 編輯劇本功能 | ⏳ |

---

### 3. 工作節點服務 (worker-01)

**程序名稱**: `group-ai-worker` (systemd服務)  
**服務器地址**: 165.154.254.99  
**服務端口**: 8000  
**SSH用戶**: root  
**SSH密碼**: Along2025!!!

#### 部署檢查

| 檢查項目 | 檢查命令 | 預期結果 | 狀態 |
|---------|---------|---------|------|
| SSH連接 | `ssh root@165.154.254.99 "echo '連接成功'"` | 顯示"連接成功" | ⏳ |
| 部署目錄 | `ssh root@165.154.254.99 "ls -la /opt/group-ai"` | 顯示目錄內容 | ⏳ |
| Python環境 | `ssh root@165.154.254.99 "/opt/group-ai/venv/bin/python --version"` | Python 3.11.x | ⏳ |
| 配置文件 | `ssh root@165.154.254.99 "test -f /opt/group-ai/.env && echo '存在'"` | 顯示"存在" | ⏳ |
| Systemd服務 | `ssh root@165.154.254.99 "systemctl status group-ai-worker"` | 服務狀態為active | ⏳ |

#### 測試內容

| 測試項目 | 測試方法 | 預期結果 | 狀態 |
|---------|---------|---------|------|
| 健康檢查 | `curl http://165.154.254.99:8000/health` | `{"status":"ok"}` | ⏳ |
| 帳號API | `curl http://165.154.254.99:8000/api/v1/group-ai/accounts` | 返回帳號列表 | ⏳ |
| 端口監聽 | `ssh root@165.154.254.99 "netstat -tlnp \| grep 8000"` | 端口8000正在監聽 | ⏳ |
| 日誌檢查 | `ssh root@165.154.254.99 "tail -n 50 /opt/group-ai/logs/worker.log"` | 顯示日誌，無錯誤 | ⏳ |

---

## 快速測試命令

### 測試本地服務

```powershell
# 測試後端
curl http://localhost:8000/health
curl http://localhost:8000/api/v1/group-ai/servers/

# 測試前端
curl http://localhost:3000

# 運行自動測試
.\scripts\test\test_all_services.ps1
```

### 測試遠程服務器

```powershell
# 檢查部署狀態
python scripts/deployment/check_and_start.py

# 啟動服務器
python scripts/deployment/start_all_servers.py

# 測試遠程API
curl http://165.154.254.99:8000/health
```

---

## 測試檢查表

### 後端服務測試
- [ ] 服務正常啟動
- [ ] 健康檢查通過
- [ ] API文檔可訪問
- [ ] 服務器列表API正常
- [ ] 帳號列表API正常
- [ ] 所有API端點響應正常

### 前端服務測試
- [ ] 服務正常啟動
- [ ] 主頁正常加載
- [ ] 服務器管理頁面正常
- [ ] 帳號管理頁面正常
- [ ] 所有功能按鈕可用
- [ ] 自動刷新功能正常
- [ ] 日誌查看功能正常

### 遠程服務器測試
- [ ] SSH連接正常
- [ ] 部署目錄存在
- [ ] Python環境正常
- [ ] 配置文件存在
- [ ] Systemd服務正常
- [ ] 服務健康檢查通過
- [ ] API接口正常
- [ ] 日誌正常記錄

### 集成功能測試
- [ ] 前端可以查看遠程服務器狀態
- [ ] 前端可以操作遠程服務器
- [ ] 前端可以查看遠程服務器日誌
- [ ] 帳號創建和分配正常
- [ ] Session文件上傳正常

---

## 測試腳本位置

- **啟動所有服務**: `scripts/test/start_all_services.ps1`
- **測試所有服務**: `scripts/test/test_all_services.ps1`
- **檢查部署並啟動**: `scripts/deployment/check_and_start.py`
- **啟動所有服務器**: `scripts/deployment/start_all_servers.py`
- **監控日誌**: `scripts/deployment/monitor_logs.py`

---

## 狀態說明

- ✅ 通過
- ❌ 失敗
- ⏳ 待測試
- ⚠️ 警告

---

## 備註

1. 本地服務需要手動啟動或使用啟動腳本
2. 遠程服務器需要先完成部署
3. 所有測試完成後，更新狀態標記
4. 發現問題請記錄在測試報告中

