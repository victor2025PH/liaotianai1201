# æ•°æ®åº“è¿ç§»å®ŒæˆæŠ¥å‘Š

## âœ… è¿ç§»æ‰§è¡Œç»“æœ

### 1. è¿ç§»çŠ¶æ€
- **å½“å‰ç‰ˆæœ¬**: `xxxx_add_telegram_registration` (head)
- **è¿ç§»çŠ¶æ€**: âœ… æˆåŠŸå®Œæˆ
- **è¿ç§»æ–‡ä»¶**: `xxxx_add_telegram_registration_tables.py`

### 2. åˆ›å»ºçš„æ•°æ®è¡¨

ä»¥ä¸‹ä¸‰ä¸ªè¡¨å·²æˆåŠŸåˆ›å»ºï¼š

1. **user_registrations** - ç”¨æˆ·æ³¨å†Œè®°å½•è¡¨
   - å­˜å‚¨æ³¨å†Œæµç¨‹çš„æ‰€æœ‰ä¿¡æ¯
   - åŒ…å«æ‰‹æœºå·ã€çŠ¶æ€ã€é£é™©è¯„åˆ†ç­‰å­—æ®µ

2. **session_files** - Sessionæ–‡ä»¶è®°å½•è¡¨
   - å­˜å‚¨ç”Ÿæˆçš„Sessionæ–‡ä»¶ä¿¡æ¯
   - åŒ…å«æ–‡ä»¶è·¯å¾„ã€å¤§å°ã€å“ˆå¸Œå€¼ç­‰

3. **anti_detection_logs** - é£æ§æ—¥å¿—è¡¨
   - è®°å½•æ‰€æœ‰é£æ§äº‹ä»¶
   - åŒ…å«é£é™©è¯„åˆ†ã€è¡Œä¸ºæ¨¡å¼ç­‰

### 3. ä¾èµ–æ£€æŸ¥

- âœ… **paramiko**: å·²å®‰è£… (ç‰ˆæœ¬ 4.0.0)
- âœ… **æ•°æ®åº“æ¨¡å‹**: æˆåŠŸå¯¼å…¥
- âœ… **æœåŠ¡ç±»**: æˆåŠŸå¯¼å…¥
- âœ… **APIè·¯ç”±**: æˆåŠŸåŠ è½½

### 4. ç´¢å¼•åˆ›å»º

æ‰€æœ‰å¿…è¦çš„ç´¢å¼•å·²åˆ›å»ºï¼š
- `user_registrations`: phone, status, node_id, created_at, phone+node_id (å”¯ä¸€)
- `session_files`: registration_id, server_node_id, is_valid
- `anti_detection_logs`: registration_id, event_type, risk_level, created_at

## ğŸ“‹ ä¸‹ä¸€æ­¥æ“ä½œ

### 1. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd admin-backend
uvicorn app.main:app --reload
```

è®¿é—® `http://localhost:8000/docs` æŸ¥çœ‹APIæ–‡æ¡£ï¼Œç¡®è®¤æ–°æ¥å£ï¼š
- `POST /api/v1/telegram-registration/start`
- `POST /api/v1/telegram-registration/verify`
- `GET /api/v1/telegram-registration/status/{registration_id}`
- `POST /api/v1/telegram-registration/cancel`

### 2. å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
cd admin-frontend
npm run dev
```

è®¿é—®å‰ç«¯é¡µé¢ï¼Œè¿›å…¥"è´¦æˆ·ä¸­å¿ƒ" â†’ "Telegramæ³¨å†Œ"æ ‡ç­¾é¡µã€‚

### 3. æµ‹è¯•æ³¨å†Œæµç¨‹

1. æ‰“å¼€æ³¨å†Œé¡µé¢
2. è¾“å…¥æ‰‹æœºå·ï¼ˆå«å›½å®¶ä»£ç ï¼Œå¦‚ +1234567890ï¼‰
3. é€‰æ‹©æœåŠ¡å™¨èŠ‚ç‚¹
4. ç‚¹å‡»"å¼€å§‹æ³¨å†Œ"
5. è¾“å…¥æ”¶åˆ°çš„éªŒè¯ç 
6. å¦‚éœ€è¦ï¼Œè¾“å…¥ä¸¤æ­¥éªŒè¯å¯†ç 
7. å®Œæˆæ³¨å†Œ

### 4. éªŒè¯åŠŸèƒ½

- âœ… æ•°æ®åº“è¡¨å·²åˆ›å»º
- âœ… APIè·¯ç”±å·²æ³¨å†Œ
- âœ… æœåŠ¡ç±»å·²å¯¼å…¥
- â³ éœ€è¦æµ‹è¯•å®é™…æ³¨å†Œæµç¨‹

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æœåŠ¡å™¨é…ç½®**: ç¡®ä¿ `data/master_config.json` ä¸­é…ç½®äº†æ­£ç¡®çš„æœåŠ¡å™¨ä¿¡æ¯
2. **SSHè¿æ¥**: ç¡®ä¿åç«¯å¯ä»¥SSHè¿æ¥åˆ°ç›®æ ‡æœåŠ¡å™¨
3. **Sessionç›®å½•**: ç¡®ä¿æœåŠ¡å™¨ä¸Šçš„ `sessions` ç›®å½•å­˜åœ¨ä¸”æœ‰å†™å…¥æƒé™
4. **APIå‡­è¯**: å¦‚æœæ²¡æœ‰æä¾›API ID/Hashï¼Œç³»ç»Ÿä¼šä½¿ç”¨æœåŠ¡å™¨é»˜è®¤é…ç½®

## ğŸ‰ ç³»ç»ŸçŠ¶æ€

ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥è¿›è¡ŒåŠŸèƒ½æµ‹è¯•ï¼

