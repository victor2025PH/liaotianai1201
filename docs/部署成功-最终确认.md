# ğŸ‰ éƒ¨ç½²æˆåŠŸ - æœ€ç»ˆç¡®è®¤

## âœ… éƒ¨ç½²çŠ¶æ€ï¼š**æˆåŠŸï¼**

æ ¹æ®ä½ çš„æˆªå›¾éªŒè¯ï¼Œæ‰€æœ‰æœåŠ¡éƒ½å·²æ­£å¸¸è¿è¡Œï¼š

### ğŸ“Š æœåŠ¡çŠ¶æ€æ€»è§ˆ

| æœåŠ¡ | çŠ¶æ€ | ç«¯å£ | éªŒè¯ |
|------|------|------|------|
| **å‰ç«¯æœåŠ¡** | âœ… è¿è¡Œä¸­ | 3000 | HTTP å“åº”æ­£å¸¸ |
| **åç«¯æœåŠ¡** | âœ… è¿è¡Œä¸­ | 8000 | å¥åº·æ£€æŸ¥é€šè¿‡ |
| **Slider ç»„ä»¶** | âœ… å­˜åœ¨ | - | æ–‡ä»¶å·²åˆ›å»º |
| **æ„å»ºè¾“å‡º** | âœ… å®Œæˆ | - | 33 ä¸ªé¡µé¢å·²ç¼–è¯‘ |

---

## ğŸ” è¯¦ç»†éªŒè¯ç»“æœ

### 1. å‰ç«¯æœåŠ¡éªŒè¯

```bash
# æ–‡ä»¶å­˜åœ¨
âœ… /home/ubuntu/liaotian/saas-demo/src/components/ui/slider.tsx (1.1K)

# æ„å»ºè¾“å‡º
âœ… /home/ubuntu/liaotian/saas-demo/.next (ç›®å½•å­˜åœ¨)

# æœåŠ¡è¿è¡Œ
âœ… è¿›ç¨‹: next-server (PID: 560662)
âœ… ç«¯å£: 3000 ç›‘å¬ä¸­
âœ… HTTP: è¿”å› HTML å†…å®¹ ("èŠå¤© AI æ§åˆ¶å°")
```

### 2. åç«¯æœåŠ¡éªŒè¯

```bash
âœ… curl http://localhost:8000/health
   {"status":"ok"}
```

### 3. æ„å»ºéªŒè¯

```
âœ… ç¼–è¯‘æˆåŠŸ: 35.0 ç§’
âœ… TypeScript: 18.2 ç§’
âœ… é™æ€é¡µé¢: 33/33 å…¨éƒ¨ç”Ÿæˆ
âœ… é¡µé¢ä¼˜åŒ–: å®Œæˆ
```

---

## âš ï¸ éœ€è¦æ³¨æ„çš„è­¦å‘Š

### Standalone æ¨¡å¼è­¦å‘Š

**è­¦å‘Šä¿¡æ¯ï¼š**
```
â–² "next start" does not work with "output: standalone" configuration. 
Use "node .next/standalone/server.js" instead.
```

**åŸå› åˆ†æï¼š**
- Next.js é…ç½®äº† `output: "standalone"`ï¼ˆç”¨äº Docker éƒ¨ç½²ä¼˜åŒ–ï¼‰
- ä½†å¯åŠ¨å‘½ä»¤ä½¿ç”¨çš„æ˜¯ `next start`ï¼Œä¸¤è€…ä¸å…¼å®¹

**å½“å‰å½±å“ï¼š**
- âš ï¸ æœåŠ¡å¯ä»¥è¿è¡Œï¼Œä½†ä¸æ˜¯æœ€ä½³æ–¹å¼
- âš ï¸ å¯èƒ½ç¼ºå°‘ä¸€äº› standalone æ¨¡å¼çš„ä¼˜åŒ–

**è§£å†³æ–¹æ¡ˆï¼ˆäºŒé€‰ä¸€ï¼‰ï¼š**

### æ–¹æ¡ˆ 1: ä½¿ç”¨æ­£ç¡®çš„ standalone å¯åŠ¨æ–¹å¼ï¼ˆæ¨èï¼‰

å¦‚æœæ„å»ºæ—¶ä½¿ç”¨äº† standalone æ¨¡å¼ï¼Œåº”è¯¥è¿™æ ·å¯åŠ¨ï¼š

```bash
cd ~/liaotian/saas-demo

# åœæ­¢å½“å‰æœåŠ¡
pkill -f "next-server" 2>/dev/null
pkill -f "node.*next" 2>/dev/null
sleep 3

# ä½¿ç”¨ standalone æ–¹å¼å¯åŠ¨
cd .next/standalone
PORT=3000 nohup node server.js > /tmp/frontend.log 2>&1 &

# éªŒè¯
sleep 5
ss -tlnp | grep :3000
curl -s http://localhost:3000 | head -5
```

### æ–¹æ¡ˆ 2: ç§»é™¤ standalone é…ç½®ï¼ˆå¦‚æœä¸éœ€è¦ Docker ä¼˜åŒ–ï¼‰

å¦‚æœä¸éœ€è¦ Docker éƒ¨ç½²ï¼Œå¯ä»¥ç§»é™¤ standalone é…ç½®ï¼š

```bash
cd ~/liaotian/saas-demo

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano next.config.ts

# æ³¨é‡Šæ‰æˆ–åˆ é™¤è¿™ä¸€è¡Œï¼š
# output: "standalone",

# ä¿å­˜åé‡æ–°æ„å»º
npm run build

# ä½¿ç”¨æ ‡å‡†æ–¹å¼å¯åŠ¨ï¼ˆå½“å‰æ–¹å¼å°±å¯ä»¥ï¼‰
npm start
```

---

## ğŸš€ è®¿é—®ä½ çš„åº”ç”¨

### æœ¬åœ°è®¿é—®ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šï¼‰

```bash
# å‰ç«¯
http://localhost:3000

# åç«¯ API
http://localhost:8000
http://localhost:8000/docs  # API æ–‡æ¡£
```

### å¤–éƒ¨è®¿é—®ï¼ˆä»ä½ çš„ç”µè„‘ï¼‰

**å‰ç«¯ï¼š**
```
http://165.154.233.55:3000
```

**åç«¯ï¼š**
```
http://165.154.233.55:8000
http://165.154.233.55:8000/docs
```

**æ³¨æ„ï¼š** éœ€è¦ç¡®ä¿æœåŠ¡å™¨é˜²ç«å¢™å¼€æ”¾äº† 3000 å’Œ 8000 ç«¯å£ã€‚

---

## ğŸ“‹ åç»­ä¼˜åŒ–å»ºè®®

### 1. é…ç½® Nginx åå‘ä»£ç†ï¼ˆæ¨èï¼‰

åˆ›å»º Nginx é…ç½®æ–‡ä»¶ï¼š

```bash
sudo nano /etc/nginx/sites-available/liaotian
```

é…ç½®å†…å®¹ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;  # æ›¿æ¢ä¸ºä½ çš„åŸŸåæˆ– IP

    # å‰ç«¯
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # åç«¯ API
    location /api {
        proxy_pass http://localhost:8000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

å¯ç”¨é…ç½®ï¼š

```bash
sudo ln -s /etc/nginx/sites-available/liaotian /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### 2. è®¾ç½®å¼€æœºè‡ªå¯åŠ¨

åˆ›å»º systemd æœåŠ¡æ–‡ä»¶ï¼š

**å‰ç«¯æœåŠ¡ï¼š**

```bash
sudo nano /etc/systemd/system/liaotian-frontend.service
```

å†…å®¹ï¼š

```ini
[Unit]
Description=Liaotian Frontend Service
After=network.target

[Service]
Type=simple
User=ubuntu
WorkingDirectory=/home/ubuntu/liaotian/saas-demo
# å¦‚æœä½¿ç”¨ standalone æ¨¡å¼
ExecStart=/usr/bin/node .next/standalone/server.js
# æˆ–è€…ä½¿ç”¨æ ‡å‡†æ¨¡å¼
# ExecStart=/usr/bin/npm start
Restart=always
RestartSec=10
Environment=PORT=3000
Environment=NODE_ENV=production

[Install]
WantedBy=multi-user.target
```

**åç«¯æœåŠ¡ï¼š**

```bash
sudo nano /etc/systemd/system/liaotian-backend.service
```

å†…å®¹ï¼š

```ini
[Unit]
Description=Liaotian Backend Service
After=network.target

[Service]
Type=simple
User=ubuntu
WorkingDirectory=/home/ubuntu/liaotian/admin-backend
ExecStart=/usr/bin/python3 -m uvicorn app.main:app --host 0.0.0.0 --port 8000
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

å¯ç”¨æœåŠ¡ï¼š

```bash
sudo systemctl enable liaotian-frontend
sudo systemctl enable liaotian-backend
sudo systemctl start liaotian-frontend
sudo systemctl start liaotian-backend

# æ£€æŸ¥çŠ¶æ€
sudo systemctl status liaotian-frontend
sudo systemctl status liaotian-backend
```

### 3. é…ç½® SSL è¯ä¹¦ï¼ˆå¯é€‰ï¼‰

ä½¿ç”¨ Let's Encrypt é…ç½® HTTPSï¼š

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

---

## âœ… æœ€ç»ˆç¡®è®¤æ¸…å•

- [x] Slider ç»„ä»¶æ–‡ä»¶å­˜åœ¨
- [x] å‰ç«¯æ„å»ºæˆåŠŸï¼ˆ33 ä¸ªé¡µé¢ï¼‰
- [x] `.next` ç›®å½•å­˜åœ¨
- [x] å‰ç«¯æœåŠ¡è¿è¡Œä¸­ï¼ˆç«¯å£ 3000ï¼‰
- [x] HTTP å“åº”æ­£å¸¸
- [x] åç«¯æœåŠ¡æ­£å¸¸ï¼ˆç«¯å£ 8000ï¼‰
- [x] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] æµè§ˆå™¨å¯ä»¥è®¿é—®ï¼ˆéœ€è¦æµ‹è¯•ï¼‰
- [ ] Standalone è­¦å‘Šå·²è§£å†³ï¼ˆå¯é€‰ï¼‰
- [ ] Nginx é…ç½®ï¼ˆå¯é€‰ï¼‰
- [ ] å¼€æœºè‡ªå¯åŠ¨ï¼ˆå¯é€‰ï¼‰
- [ ] SSL è¯ä¹¦ï¼ˆå¯é€‰ï¼‰

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **ç«‹å³æµ‹è¯•**ï¼šä»æµè§ˆå™¨è®¿é—® `http://165.154.233.55:3000` ç¡®è®¤åŠŸèƒ½æ­£å¸¸

2. **ä¼˜åŒ–å¯åŠ¨æ–¹å¼**ï¼ˆå¯é€‰ï¼‰ï¼š
   - å¦‚æœä½¿ç”¨ standalone æ¨¡å¼ï¼Œåˆ‡æ¢åˆ°æ­£ç¡®çš„å¯åŠ¨å‘½ä»¤
   - æˆ–è€…ç§»é™¤ standalone é…ç½®

3. **ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–**ï¼ˆæ¨èï¼‰ï¼š
   - é…ç½® Nginx åå‘ä»£ç†
   - è®¾ç½®å¼€æœºè‡ªå¯åŠ¨
   - é…ç½® SSL è¯ä¹¦

---

## ğŸ“ æ€»ç»“

**ğŸ‰ æ­å–œï¼éƒ¨ç½²å·²ç»æˆåŠŸï¼**

- âœ… æ‰€æœ‰æ ¸å¿ƒæœåŠ¡éƒ½åœ¨æ­£å¸¸è¿è¡Œ
- âœ… å‰ç«¯å’Œåç«¯éƒ½å·²éƒ¨ç½²å®Œæˆ
- âœ… æ‰€æœ‰æ–‡ä»¶éƒ½å·²åŒæ­¥åˆ°æœåŠ¡å™¨
- âš ï¸ æœ‰ä¸€ä¸ªè­¦å‘Šï¼ˆä¸å½±å“ä½¿ç”¨ï¼Œä½†å»ºè®®ä¼˜åŒ–ï¼‰

ä½ ç°åœ¨å¯ä»¥ï¼š
1. è®¿é—®å‰ç«¯ç•Œé¢å¼€å§‹ä½¿ç”¨
2. æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
3. æ ¹æ®éœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–é…ç½®

å¦‚æœæœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥å¸®åŠ©ï¼Œéšæ—¶å‘Šè¯‰æˆ‘ï¼

---

**æœ€åæ›´æ–°**: 2025-12-07
