# 立即清理重複進程

> **日期**: 2025-12-01  
> **當前狀態**: 發現 2 個 uvicorn 進程，需要清理

---

## 🚀 立即執行清理

在服務器終端執行以下命令：

```bash
echo "【1】停止所有 uvicorn 進程..." && \
pkill -9 -f 'uvicorn.*app.main:app' || true && \
sleep 2 && \
echo "✓ 進程已停止" && \
echo "" && \
echo "【2】啟動單個服務..." && \
cd ~/liaotian/admin-backend && \
source .venv/bin/activate && \
nohup uvicorn app.main:app --host 0.0.0.0 --port 8000 > /tmp/backend.log 2>&1 & \
sleep 5 && \
echo "✓ 服務已啟動" && \
echo "" && \
echo "【3】驗證服務..." && \
curl -s http://localhost:8000/health && echo "" && \
echo "" && \
echo "【4】確認進程數..." && \
echo "當前進程數: $(ps aux | grep 'uvicorn.*app.main' | grep -v grep | wc -l) 個" && \
echo "" && \
echo "✅ 清理完成！"
```

---

## 📋 執行後檢查

清理完成後，執行以下命令驗證：

```bash
echo "=== 清理後檢查 ===" && \
echo "1. 進程數: $(ps aux | grep 'uvicorn.*app.main' | grep -v grep | wc -l) 個" && \
echo "2. 健康檢查: $(curl -s http://localhost:8000/health)" && \
echo "3. 端口狀態: $(lsof -ti:8000 >/dev/null 2>&1 && echo '已占用' || echo '未占用')" && \
echo "=== 完成 ==="
```

---

## ✅ 預期結果

清理後應該看到：
- 進程數: 1 個
- 健康檢查: `{"status":"ok"}`
- 端口狀態: 已占用

---

**執行清理命令，然後告訴我結果！**
