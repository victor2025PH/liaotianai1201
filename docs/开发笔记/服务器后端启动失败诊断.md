# æœå‹™å™¨å¾Œç«¯å•Ÿå‹•å¤±æ•—è¨ºæ–·

> **æ—¥æœŸ**: 2025-11-30  
> **å•é¡Œ**: å¾Œç«¯æœå‹™å•Ÿå‹•å¤±æ•—ï¼ˆExit 1ï¼‰

---

## ğŸ” å•é¡Œåˆ†æ

å¾çµ‚ç«¯è¼¸å‡ºå¯ä»¥çœ‹åˆ°ï¼š

```
nohup uvicorn app.main:app --host 0.0.0.0 --port 8000 > /tmp/backend.log 2>&1 &
[1] 877985
[1]+  Exit 1                  nohup uvicorn app.main:app --host 0.0.0.0 --port 8000 > /tmp/backend.log 2>&1
```

**å¾Œç«¯æœå‹™å•Ÿå‹•å¤±æ•—ï¼Œé€€å‡ºç¢¼ç‚º 1**

---

## ğŸ” è¨ºæ–·æ­¥é©Ÿ

### æ­¥é©Ÿ 1: æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ

åœ¨æœå‹™å™¨ä¸ŠåŸ·è¡Œï¼š

```bash
# æŸ¥çœ‹å®Œæ•´çš„éŒ¯èª¤æ—¥èªŒ
tail -100 /tmp/backend.log

# æˆ–è€…æŸ¥çœ‹æœ€å¾Œçš„éŒ¯èª¤
tail -50 /tmp/backend.log | grep -i "error\|exception\|traceback\|failed"
```

---

### æ­¥é©Ÿ 2: æª¢æŸ¥å¸¸è¦‹å•é¡Œ

#### å•é¡Œ 1: ä¾è³´ç¼ºå¤±

```bash
cd ~/liaotian/admin-backend
source .venv/bin/activate

# æª¢æŸ¥ä¾è³´æ˜¯å¦å·²å®‰è£
pip list | grep uvicorn
pip list | grep fastapi

# å¦‚æœç¼ºå°‘ï¼Œå®‰è£ä¾è³´
pip install -r requirements.txt
```

---

#### å•é¡Œ 2: ç’°å¢ƒè®Šé‡ç¼ºå¤±

```bash
# æª¢æŸ¥ .env æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la ~/liaotian/admin-backend/.env

# å¦‚æœä¸å­˜åœ¨ï¼Œå‰µå»ºåŸºæœ¬çš„ .env æ–‡ä»¶
cat > ~/liaotian/admin-backend/.env << 'EOF'
DATABASE_URL=sqlite:///./admin.db
JWT_SECRET=$(openssl rand -hex 32)
ADMIN_DEFAULT_EMAIL=admin@example.com
ADMIN_DEFAULT_PASSWORD=changeme123
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
EOF
```

---

#### å•é¡Œ 3: æ•¸æ“šåº«å•é¡Œ

```bash
# æª¢æŸ¥æ•¸æ“šåº«æ–‡ä»¶
ls -la ~/liaotian/admin-backend/*.db

# å¦‚æœéœ€è¦ï¼Œé‹è¡Œæ•¸æ“šåº«é·ç§»
cd ~/liaotian/admin-backend
source .venv/bin/activate
alembic upgrade head
```

---

#### å•é¡Œ 4: Python æ¨¡å¡Šæ‰¾ä¸åˆ°

```bash
# ç›´æ¥é‹è¡Œæª¢æŸ¥å°å…¥
cd ~/liaotian/admin-backend
source .venv/bin/activate
python -c "from app.main import app; print('Import successful')"
```

---

## ğŸ“‹ å®Œæ•´çš„è¨ºæ–·å‘½ä»¤åºåˆ—

åœ¨æœå‹™å™¨ä¸ŠåŸ·è¡Œï¼š

```bash
cd ~/liaotian/admin-backend

# 1. æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ
echo "=== éŒ¯èª¤æ—¥èªŒ ==="
tail -100 /tmp/backend.log

# 2. æª¢æŸ¥è™›æ“¬ç’°å¢ƒ
echo ""
echo "=== æª¢æŸ¥è™›æ“¬ç’°å¢ƒ ==="
source .venv/bin/activate
which python
python --version

# 3. æª¢æŸ¥ä¾è³´
echo ""
echo "=== æª¢æŸ¥é—œéµä¾è³´ ==="
pip list | grep -E "uvicorn|fastapi|sqlalchemy"

# 4. æª¢æŸ¥ç’°å¢ƒè®Šé‡æ–‡ä»¶
echo ""
echo "=== æª¢æŸ¥ç’°å¢ƒè®Šé‡ ==="
ls -la .env 2>/dev/null || echo ".env æ–‡ä»¶ä¸å­˜åœ¨"

# 5. æ¸¬è©¦å°å…¥
echo ""
echo "=== æ¸¬è©¦ Python å°å…¥ ==="
python -c "from app.main import app" 2>&1 || echo "å°å…¥å¤±æ•—"
```

---

## ğŸ”§ å¸¸è¦‹è§£æ±ºæ–¹æ¡ˆ

### è§£æ±ºæ–¹æ¡ˆ 1: é‡æ–°å®‰è£ä¾è³´

```bash
cd ~/liaotian/admin-backend
source .venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

---

### è§£æ±ºæ–¹æ¡ˆ 2: å‰µå»ºç’°å¢ƒè®Šé‡æ–‡ä»¶

```bash
cd ~/liaotian/admin-backend
cat > .env << 'EOF'
DATABASE_URL=sqlite:///./admin.db
JWT_SECRET=$(openssl rand -hex 32)
ADMIN_DEFAULT_EMAIL=admin@example.com
ADMIN_DEFAULT_PASSWORD=changeme123
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
EOF
```

---

### è§£æ±ºæ–¹æ¡ˆ 3: é‹è¡Œæ•¸æ“šåº«é·ç§»

```bash
cd ~/liaotian/admin-backend
source .venv/bin/activate

# å¦‚æœä½¿ç”¨ Alembic
alembic upgrade head 2>/dev/null || echo "Alembic é·ç§»è·³é"

# æˆ–è€…ç›´æ¥åˆå§‹åŒ–æ•¸æ“šåº«
python -c "from app.database import init_db; init_db()" 2>/dev/null || echo "æ•¸æ“šåº«åˆå§‹åŒ–è·³é"
```

---

## ğŸ“ ä¿®å¾©å¾Œé‡æ–°å•Ÿå‹•

è¨ºæ–·ä¸¦ä¿®å¾©å•é¡Œå¾Œï¼Œé‡æ–°å•Ÿå‹•æœå‹™ï¼š

```bash
cd ~/liaotian/admin-backend

# åœæ­¢èˆŠæœå‹™
pkill -9 -f 'uvicorn.*app.main:app' || true
sleep 2

# æ¸…ç†ç·©å­˜
find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null || true

# å•Ÿå‹•æœå‹™
source .venv/bin/activate
nohup uvicorn app.main:app --host 0.0.0.0 --port 8000 > /tmp/backend.log 2>&1 &

# ç­‰å¾…å•Ÿå‹•
sleep 5

# æª¢æŸ¥æœå‹™ç‹€æ…‹
ps aux | grep uvicorn | grep -v grep

# æª¢æŸ¥å¥åº·æ¥å£
curl -s http://localhost:8000/health || echo "æœå‹™æœªå•Ÿå‹•"
```

---

**å®Œæˆæ™‚é–“**: 2025-11-30  
**ä¸‹ä¸€æ­¥**: æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒä¸¦è¨ºæ–·å•é¡Œ
