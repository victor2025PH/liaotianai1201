# ç»Ÿä¸€éƒ¨ç½²å·¥ä½œæµè¯´æ˜

> **ç›®æ ‡**: åˆå¹¶éƒ¨ç½²å·¥ä½œæµï¼Œå®ç°ä¸€é”®éƒ¨ç½²æ‰€æœ‰ç½‘ç«™

---

## ğŸ“‹ å½“å‰å·¥ä½œæµç»“æ„

### 1. `deploy-three-sites.yml` - ä¸‰ä¸ªç½‘ç«™ç»Ÿä¸€éƒ¨ç½²ï¼ˆæ¨èï¼‰

**åŠŸèƒ½**: ä½¿ç”¨ matrix ç­–ç•¥å¹¶è¡Œéƒ¨ç½²ä¸‰ä¸ªç½‘ç«™
- tgmini (ç«¯å£ 3001)
- hongbao (ç«¯å£ 3002)
- aizkw (ç«¯å£ 3003)

**è§¦å‘æ¡ä»¶**:
- Push åˆ° `main` åˆ†æ”¯ï¼Œä¸”ä¿®æ”¹äº†ä¸‰ä¸ªç½‘ç«™ç›®å½•
- æ‰‹åŠ¨è§¦å‘ (`workflow_dispatch`)

**ç‰¹ç‚¹**:
- âœ… å¹¶è¡Œéƒ¨ç½²ï¼Œé€Ÿåº¦å¿«
- âœ… è‡ªåŠ¨æ£€æµ‹ SSL è¯ä¹¦
- âœ… ç»Ÿä¸€é…ç½®ç®¡ç†

### 2. `deploy.yml` - å•ä¸ªé¡¹ç›®éƒ¨ç½²

**åŠŸèƒ½**: éƒ¨ç½²å•ä¸ª aizkw é¡¹ç›®

**è§¦å‘æ¡ä»¶**:
- Push åˆ° `main` åˆ†æ”¯ï¼Œä½†**ä¸**ä¿®æ”¹ä¸‰ä¸ªç½‘ç«™ç›®å½•
- æ‰‹åŠ¨è§¦å‘ (`workflow_dispatch`)

**ç‰¹ç‚¹**:
- âœ… æ”¯æŒ Vite å’Œ Next.js é¡¹ç›®
- âœ… è‡ªåŠ¨æ£€æµ‹é¡¹ç›®ç±»å‹

---

## ğŸš€ ä½¿ç”¨æ–¹å¼

### æ–¹å¼ 1: è‡ªåŠ¨è§¦å‘ï¼ˆæ¨èï¼‰

**éƒ¨ç½²ä¸‰ä¸ªç½‘ç«™**:
```bash
# ä¿®æ”¹ä¸‰ä¸ªç½‘ç«™ä¸­çš„ä»»æ„æ–‡ä»¶
git add tgmini20251220/ hbwy20251220/ aizkw20251219/
git commit -m "æ›´æ–°ä¸‰ä¸ªç½‘ç«™"
git push origin main
```

**éƒ¨ç½²å•ä¸ªé¡¹ç›®**:
```bash
# ä¿®æ”¹å…¶ä»–æ–‡ä»¶ï¼ˆéä¸‰ä¸ªç½‘ç«™ç›®å½•ï¼‰
git add admin-backend/
git commit -m "æ›´æ–°åç«¯"
git push origin main
```

### æ–¹å¼ 2: æ‰‹åŠ¨è§¦å‘

1. **è®¿é—® GitHub Actions é¡µé¢**:
   ```
   https://github.com/victor2025PH/liaotianai1201/actions
   ```

2. **é€‰æ‹©å·¥ä½œæµ**:
   - **éƒ¨ç½²ä¸‰ä¸ªç½‘ç«™**: ç‚¹å‡» `deploy-three-sites.yml` â†’ `Run workflow`
   - **éƒ¨ç½²å•ä¸ªé¡¹ç›®**: ç‚¹å‡» `deploy.yml` â†’ `Run workflow`

3. **ä¸€é”®è¿è¡Œ**:
   - é€‰æ‹©åˆ†æ”¯: `main`
   - ç‚¹å‡» `Run workflow`
   - **æ— éœ€é¢å¤–ç¡®è®¤ï¼Œç›´æ¥è¿è¡Œ**

---

## ğŸ”§ å·¥ä½œæµé…ç½®

### deploy-three-sites.yml

```yaml
on:
  push:
    branches: [main]
    paths:
      - 'tgmini20251220/**'
      - 'hbwy20251220/**'
      - 'aizkw20251219/**'
  workflow_dispatch:  # æ”¯æŒæ‰‹åŠ¨è§¦å‘
```

**Matrix ç­–ç•¥**: è‡ªåŠ¨å¹¶è¡Œéƒ¨ç½²ä¸‰ä¸ªç½‘ç«™

### deploy.yml

```yaml
on:
  push:
    branches: [main]
    paths-ignore:  # å¿½ç•¥ä¸‰ä¸ªç½‘ç«™ç›®å½•ï¼Œé¿å…é‡å¤éƒ¨ç½²
      - 'tgmini20251220/**'
      - 'hbwy20251220/**'
      - 'aizkw20251219/**'
  workflow_dispatch:  # æ”¯æŒæ‰‹åŠ¨è§¦å‘
```

---

## âœ… å·²ä¿®å¤çš„é—®é¢˜

1. **YAML è¯­æ³•é”™è¯¯**
   - âœ… ä¿®å¤ `deploy.yml` ç¬¬ 143 è¡Œç¼©è¿›é—®é¢˜
   - âœ… ä¿®å¤ `deploy-three-sites.yml` ç¬¬ 236 è¡Œ heredoc è¯­æ³•é—®é¢˜

2. **å·¥ä½œæµä¼˜åŒ–**
   - âœ… é¿å…é‡å¤è§¦å‘ï¼ˆä½¿ç”¨ `paths-ignore`ï¼‰
   - âœ… æ”¯æŒæ‰‹åŠ¨ä¸€é”®è§¦å‘
   - âœ… è‡ªåŠ¨æ£€æµ‹ SSL è¯ä¹¦

3. **éƒ¨ç½²é€»è¾‘**
   - âœ… æ”¯æŒ Vite é¡¹ç›®ï¼ˆä½¿ç”¨ serveï¼‰
   - âœ… æ”¯æŒ Next.js é¡¹ç›®ï¼ˆä½¿ç”¨ PM2ï¼‰
   - âœ… è‡ªåŠ¨å®‰è£…ä¾èµ–ï¼ˆNode.js, PM2, serve, Nginxï¼‰

---

## ğŸ¯ æ¨èä½¿ç”¨æ–¹å¼

**æ—¥å¸¸å¼€å‘**:
- ä¿®æ”¹ä¸‰ä¸ªç½‘ç«™ â†’ è‡ªåŠ¨è§¦å‘ `deploy-three-sites.yml`
- ä¿®æ”¹å…¶ä»–ä»£ç  â†’ è‡ªåŠ¨è§¦å‘ `deploy.yml`

**æ‰‹åŠ¨éƒ¨ç½²**:
- éœ€è¦éƒ¨ç½²ä¸‰ä¸ªç½‘ç«™ â†’ è¿è¡Œ `deploy-three-sites.yml`
- éœ€è¦éƒ¨ç½²å•ä¸ªé¡¹ç›® â†’ è¿è¡Œ `deploy.yml`

---

**æœ€åæ›´æ–°**: 2025-12-21
