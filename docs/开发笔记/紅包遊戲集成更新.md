# ç´…åŒ…éŠæˆ²é›†æˆæ›´æ–°

> æ›´æ–°æ™‚é–“ï¼š2025-12-03  
> æ›´æ–°å…§å®¹ï¼šWorker å®¢æˆ¶ç«¯ç´…åŒ… SDK é›†æˆ

---

## âœ… å·²å®Œæˆçš„æ›´æ–°

### 1. ç´…åŒ… API é…ç½®æ–‡æª”

**æ–‡ä»¶**: `docs/ç´…åŒ…éŠæˆ²APIé…ç½®.md`

- âœ… è¨˜éŒ„æ¸¬è©¦ç’°å¢ƒ API ä¿¡æ¯
- âœ… æä¾›æ¸¬è©¦å‘½ä»¤ç¯„ä¾‹
- âœ… èªªæ˜é…ç½®æ­¥é©Ÿ

**API ä¿¡æ¯**:
```
API åœ°å€: https://api.usdt2026.cc/api/v2/ai
API Key:  test-key-2024
æ¸¬è©¦ç”¨æˆ¶: 5433982810 (é¤˜é¡: 9988.706 USDT)
```

---

### 2. Worker å®¢æˆ¶ç«¯ç´…åŒ… SDK é›†æˆ

**æ–‡ä»¶**: `admin-backend/app/api/workers.py`

#### âœ… é…ç½®æ”¯æŒ

- **ç’°å¢ƒè®Šé‡é…ç½®**:
  ```python
  REDPACKET_API_URL="https://api.usdt2026.cc/api/v2/ai"
  REDPACKET_API_KEY="test-key-2024"
  REDPACKET_ENABLED="true"
  ```

- **Excel é…ç½®æ”¯æŒ**:
  - æ–°å¢ `redpacket_enabled` åˆ—ï¼ˆæ”¯æŒä¸­è‹±æ–‡åˆ¥åï¼‰
  - æ¯å€‹å¸³è™Ÿå¯ç¨ç«‹æ§åˆ¶æ˜¯å¦å•Ÿç”¨ç´…åŒ…åŠŸèƒ½

#### âœ… åŠŸèƒ½å¯¦ç¾

1. **ç´…åŒ…å®¢æˆ¶ç«¯åˆå§‹åŒ–**
   - `init_redpacket_client()` - åˆå§‹åŒ–ç´…åŒ… API å®¢æˆ¶ç«¯
   - è‡ªå‹•æª¢æ¸¬ `httpx` ä¾è³´
   - å•Ÿå‹•æ™‚è‡ªå‹•åˆå§‹åŒ–

2. **ç´…åŒ… API å‡½æ•¸**
   - `redpacket_get_balance(tg_id)` - æŸ¥è©¢é¤˜é¡
   - `redpacket_send_packet(tg_id, amount, count, message)` - ç™¼é€ç´…åŒ…
   - `redpacket_claim_packet(tg_id, packet_uuid)` - é ˜å–ç´…åŒ…

3. **å‘½ä»¤æ”¯æŒ**
   - `redpacket_balance` - æŸ¥è©¢é¤˜é¡å‘½ä»¤
   - `redpacket_send` - ç™¼é€ç´…åŒ…å‘½ä»¤
   - `redpacket_claim` - é ˜å–ç´…åŒ…å‘½ä»¤

#### âœ… ä¾è³´æ›´æ–°

- éƒ¨ç½²è…³æœ¬è‡ªå‹•å®‰è£ `httpx`ï¼ˆç´…åŒ… API å®¢æˆ¶ç«¯ï¼‰
- éƒ¨ç½²è…³æœ¬è‡ªå‹•å®‰è£ `telethon`ï¼ˆTelegram é›†æˆï¼‰

---

## ğŸ“‹ ä½¿ç”¨æ–¹å¼

### æ–¹å¼ 1ï¼šç’°å¢ƒè®Šé‡é…ç½®

åœ¨ Worker éƒ¨ç½²åŒ…ä¸­è¨­ç½®ç’°å¢ƒè®Šé‡ï¼š

**Windows (start_worker.bat)**:
```batch
set REDPACKET_API_URL=https://api.usdt2026.cc/api/v2/ai
set REDPACKET_API_KEY=test-key-2024
set REDPACKET_ENABLED=true
```

**Linux (start_worker.sh)**:
```bash
export REDPACKET_API_URL="https://api.usdt2026.cc/api/v2/ai"
export REDPACKET_API_KEY="test-key-2024"
export REDPACKET_ENABLED="true"
```

### æ–¹å¼ 2ï¼šExcel é…ç½®

åœ¨ Excel é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  `redpacket_enabled` åˆ—ï¼š

| phone | api_id | api_hash | redpacket_enabled | ... |
|-------|--------|----------|------------------|-----|
| 639277358115 | 30390800 | 471481... | 1 | ... |
| 639952948592 | 38485760 | 2d43d7... | 0 | ... |

**åˆ—ååˆ¥å**:
- `redpacket_enabled`
- `çº¢åŒ…å¯ç”¨`
- `ç´…åŒ…å•Ÿç”¨`
- `redpacket`

**å€¼**:
- `1` æˆ– `true` = å•Ÿç”¨
- `0` æˆ– `false` = ç¦ç”¨

---

## ğŸ§ª æ¸¬è©¦å‘½ä»¤

### é€šéæœå‹™å™¨ä¸‹ç™¼å‘½ä»¤æ¸¬è©¦

#### 1. æŸ¥è©¢é¤˜é¡

```bash
curl -X POST "https://aikz.usdt2026.cc/api/v1/workers/{node_id}/commands" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "redpacket_balance",
    "params": {
      "tg_id": 5433982810
    }
  }'
```

#### 2. ç™¼é€ç´…åŒ…

```bash
curl -X POST "https://aikz.usdt2026.cc/api/v1/workers/{node_id}/commands" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "redpacket_send",
    "params": {
      "tg_id": 5433982810,
      "amount": 10.0,
      "count": 5,
      "message": "ğŸ¤– AI æ¸¬è©¦ç´…åŒ…"
    }
  }'
```

#### 3. é ˜å–ç´…åŒ…

```bash
curl -X POST "https://aikz.usdt2026.cc/api/v1/workers/{node_id}/commands" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "redpacket_claim",
    "params": {
      "tg_id": 5433982810,
      "packet_uuid": "ç´…åŒ…UUID"
    }
  }'
```

---

## ğŸ”„ ä¸‹ä¸€æ­¥é–‹ç™¼

### å¾…å¯¦ç¾åŠŸèƒ½

1. **æ¶ˆæ¯ç›£è½** â³
   - ç›£è½ç¾¤æ¶ˆæ¯
   - è­˜åˆ¥ç´…åŒ…æ¶ˆæ¯
   - è‡ªå‹•è§¸ç™¼æ¶ç´…åŒ…

2. **è‡ªå‹•ç™¼ç´…åŒ…** â³
   - å®šæ™‚ç™¼ç´…åŒ…
   - æ ¹æ“šåŠ‡æœ¬ç™¼ç´…åŒ…
   - æ™ºèƒ½é‡‘é¡åˆ†é…

3. **è‡ªå‹•æ¶ç´…åŒ…** â³
   - æª¢æ¸¬åˆ°ç´…åŒ…è‡ªå‹•æ¶
   - éš¨æ©Ÿå»¶é²ï¼ˆæ¨¡æ“¬çœŸäººï¼‰
   - æ¶åˆ°å¾Œç™¼é€æ„Ÿè¬æ¶ˆæ¯

4. **éŠæˆ²é‚è¼¯** â³
   - è¸©é›·è™•ç†
   - ç›ˆè™§çµ±è¨ˆ
   - ç­–ç•¥å„ªåŒ–

---

## ğŸ“ æ³¨æ„äº‹é …

1. **API åœ°å€æ ¼å¼**: ç¢ºä¿ä½¿ç”¨å®Œæ•´è·¯å¾‘ï¼Œä¸è¦åŠ å°¾éš¨æ–œæ 
2. **Telegram User ID**: å¿…é ˆæ˜¯æ•¸å­—æ ¼å¼
3. **ä¾è³´å®‰è£**: Worker å•Ÿå‹•æ™‚æœƒè‡ªå‹•å®‰è£ `httpx`ï¼Œå¦‚æœå¤±æ•—è«‹æ‰‹å‹•å®‰è£
4. **æ¸¬è©¦ç’°å¢ƒ**: ç•¶å‰ç‚ºæ¸¬è©¦ç’°å¢ƒï¼Œç”Ÿç”¢ç’°å¢ƒé…ç½®å¯èƒ½ä¸åŒ

---

## âœ… é©—è­‰æ­¥é©Ÿ

1. **é…ç½®å¾Œç«¯ API**
   - è¨ªå• `https://aikz.usdt2026.cc/group-ai/redpacket`
   - å¡«å¯« API åœ°å€å’Œ Key
   - æ¸¬è©¦é€£æ¥

2. **é‡æ–°ä¸‹è¼‰ Worker éƒ¨ç½²åŒ…**
   - è¨ªå• `https://aikz.usdt2026.cc/group-ai/worker-deploy`
   - ä¸‹è¼‰æ–°çš„éƒ¨ç½²åŒ…ï¼ˆåŒ…å«ç´…åŒ… SDK æ”¯æŒï¼‰

3. **é…ç½® Worker ç’°å¢ƒè®Šé‡**
   - è¨­ç½® `REDPACKET_API_URL` å’Œ `REDPACKET_API_KEY`
   - æˆ–ä½¿ç”¨ Excel é…ç½®

4. **å•Ÿå‹• Worker**
   - é‹è¡Œ `start_worker.bat` æˆ– `start_worker.sh`
   - æª¢æŸ¥æ—¥èªŒä¸­æ˜¯å¦æœ‰ `[REDPACKET] Client initialized` æ¶ˆæ¯

5. **æ¸¬è©¦å‘½ä»¤**
   - é€šéæœå‹™å™¨ä¸‹ç™¼ `redpacket_balance` å‘½ä»¤
   - æª¢æŸ¥ Worker æ—¥èªŒä¸­çš„éŸ¿æ‡‰

---

*æ›´æ–°æ™‚é–“ï¼š2025-12-03*
