# Telegram注册系统 - 功能测试协助指南

## 📋 测试准备

### 1. 确认服务运行状态

**后端服务** (端口 8000):
```bash
cd admin-backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

**前端服务** (端口 3000):
```bash
cd admin-frontend
npm run dev
```

**验证服务状态**:
- 后端: http://localhost:8000/health
- 前端: http://localhost:3000
- API文档: http://localhost:8000/docs

---

## 🧪 自动化测试

### 运行功能测试脚本

```bash
cd admin-backend
python test_functional_registration.py
```

**测试内容**:
1. ✅ 服务健康检查
2. ✅ 认证Token获取
3. ✅ 服务器列表API
4. ✅ 注册启动API
5. ✅ 注册状态查询API
6. ✅ 验证码验证API

---

## 🌐 前端页面测试

### 访问地址

- **前端首页**: http://localhost:3000
- **账户中心**: http://localhost:3000/accounts
- **Telegram注册**: http://localhost:3000/accounts → 点击"Telegram注册"标签

### 测试步骤

#### 步骤1: 登录系统

1. 打开浏览器访问 http://localhost:3000
2. 输入有效的邮箱和密码
3. 点击"登录"按钮
4. 确认登录成功，跳转到仪表板

#### 步骤2: 进入账户中心

1. 点击左侧菜单"账户中心"
2. 或直接访问: http://localhost:3000/accounts
3. 确认页面正常显示
4. 确认显示3个标签页：
   - 账户列表
   - Telegram注册
   - 生成Session

#### 步骤3: 测试Telegram注册功能

1. **点击"Telegram注册"标签页**
   - ✅ 确认页面正常显示
   - ✅ 确认表单字段显示
   - ✅ 确认服务器列表加载

2. **填写注册信息**
   - 手机号: `+1234567890` (使用真实手机号)
   - 国家代码: `+1` (根据手机号选择)
   - 服务器: 从下拉列表选择一个服务器节点

3. **点击"开始注册"**
   - ✅ 观察页面变化
   - ✅ 如果成功: 跳转到步骤2（验证码输入）
   - ✅ 显示倒计时和风险评分
   - ✅ 显示错误提示（如果有）

4. **输入验证码**
   - 查看手机收到的Telegram验证码
   - 在输入框中输入验证码
   - 点击"验证"按钮
   - ✅ 如果成功: 显示成功信息
   - ✅ 查看Session文件信息

---

## 🔍 测试检查清单

### 前端页面测试

- [ ] 前端页面可访问 (http://localhost:3000)
- [ ] 登录功能正常
- [ ] 账户中心页面正常 (http://localhost:3000/accounts)
- [ ] Telegram注册标签页正常显示
- [ ] 表单字段正常显示
- [ ] 服务器列表正常加载
- [ ] 服务器状态正确显示（在线/离线）

### 功能测试

- [ ] 手机号格式验证
- [ ] 必填字段验证
- [ ] 开始注册功能
- [ ] 验证码输入功能
- [ ] 倒计时显示
- [ ] 风险评分显示
- [ ] 错误处理正常
- [ ] 完成注册功能
- [ ] Session文件信息显示

### API测试（通过Swagger UI）

- [ ] 访问API文档 (http://localhost:8000/docs)
- [ ] 获取认证token
- [ ] 测试服务器列表端点
- [ ] 测试注册启动端点
- [ ] 测试状态查询端点
- [ ] 测试验证码验证端点

---

## 🐛 常见问题排查

### 问题1: 前端页面无法访问

**症状**: 访问 http://localhost:3000 显示无法连接

**解决方案**:
1. 检查前端服务是否运行: `netstat -ano | findstr :3000`
2. 重启前端服务: `cd admin-frontend && npm run dev`
3. 检查端口是否被占用

### 问题2: 服务器列表加载失败

**症状**: 前端显示"加载服务器列表失败"

**解决方案**:
1. 检查后端服务是否运行: `netstat -ano | findstr :8000`
2. 检查是否已登录（需要有效的token）
3. 检查后端日志是否有错误
4. 验证 `data/master_config.json` 配置是否正确

### 问题3: 注册启动失败

**症状**: 点击"开始注册"后显示错误

**解决方案**:
1. 检查手机号格式是否正确（需要包含国家代码）
2. 检查服务器节点是否在线
3. 检查后端日志查看详细错误信息
4. 验证SSH连接是否正常（如果使用远程服务器）

### 问题4: 验证码验证失败

**症状**: 输入验证码后显示错误

**解决方案**:
1. 确认验证码正确（注意大小写）
2. 检查验证码是否过期（通常5分钟内有效）
3. 检查后端日志查看详细错误信息
4. 如果账户有2FA密码，需要同时输入密码

---

## 📊 测试报告模板

### 测试环境

- **测试日期**: YYYY-MM-DD
- **测试人员**: [姓名]
- **浏览器**: [Chrome/Firefox/Edge]
- **后端版本**: [版本号]
- **前端版本**: [版本号]

### 测试结果

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 前端页面访问 | ✅/❌ | |
| 登录功能 | ✅/❌ | |
| 账户中心页面 | ✅/❌ | |
| 服务器列表加载 | ✅/❌ | |
| 注册启动 | ✅/❌ | |
| 验证码输入 | ✅/❌ | |
| 注册完成 | ✅/❌ | |
| Session文件生成 | ✅/❌ | |

### 发现的问题

1. [问题描述]
   - 复现步骤:
   - 预期结果:
   - 实际结果:
   - 严重程度: [高/中/低]

---

## 🚀 快速测试命令

### 检查服务状态

```bash
# Windows PowerShell
netstat -ano | findstr ":3000 :8000"
```

### 运行自动化测试

```bash
cd admin-backend
python test_functional_registration.py
```

### 查看后端日志

```bash
# 如果使用 uvicorn --reload，日志会显示在终端
# 查看错误信息
```

### 查看前端控制台

1. 打开浏览器开发者工具 (F12)
2. 查看 Console 标签页
3. 查看 Network 标签页（检查API请求）

---

## ✅ 测试完成标准

- [x] 所有前端页面正常访问
- [x] 所有API端点正常响应
- [x] 注册流程完整测试通过
- [x] 错误处理正常
- [x] Session文件正确生成
- [x] 服务器列表正确显示
- [x] 风险评分正确计算
- [x] 倒计时功能正常

---

## 📚 相关文档

- **功能测试执行指南**: `docs/开发文档/功能测试执行指南.md`
- **账户中心访问指南**: `docs/开发文档/账户中心访问指南.md`
- **系统验证完成报告**: `docs/开发文档/系统验证完成报告.md`
- **快速参考**: `docs/开发文档/快速参考.md`

---

**最后更新**: 2025-11-22  
**测试状态**: ✅ 就绪

