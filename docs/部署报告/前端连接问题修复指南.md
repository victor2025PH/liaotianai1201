# 前端连接问题修复指南

> **问题**: ERR_CONNECTION_REFUSED - localhost 拒绝了连接请求  
> **状态**: 正在修复中

---

## 问题诊断

### 当前状态
- ✅ **后端服务**: 运行正常 (http://localhost:8000)
- ⚠️ **前端服务**: 连接被拒绝 (http://localhost:3001)

### 可能原因

1. **服务正在启动中**
   - Next.js 首次启动需要编译，可能需要 30-60 秒
   - 端口已监听但服务还未完全就绪

2. **服务已停止**
   - 前端进程可能已意外退出
   - 需要重新启动服务

3. **端口冲突**
   - 端口被其他进程占用
   - Next.js 可能使用了其他端口

---

## 解决方案

### 方案1：等待服务启动（推荐）

如果服务刚刚启动，请等待 30-60 秒后再次访问：
```
http://localhost:3001/login
```

### 方案2：检查服务状态

1. **检查端口监听**:
   ```bash
   netstat -ano | findstr ":3001"
   ```

2. **检查进程**:
   ```bash
   tasklist | findstr "node.exe"
   ```

3. **检查服务日志**:
   查看前端服务的控制台输出，确认是否有错误

### 方案3：重新启动前端服务

如果服务已停止，重新启动：

```bash
cd saas-demo
npm run dev
```

**注意**: Next.js 会自动选择可用端口，可能是 3000、3001 或 3002。

### 方案4：检查防火墙

确保防火墙没有阻止本地连接：
- Windows 防火墙设置
- 杀毒软件的网络保护

---

## 验证步骤

服务启动成功后，应该能够：

1. **访问主页**:
   ```
   http://localhost:3001
   ```
   或
   ```
   http://localhost:3000
   ```

2. **访问登录页面**:
   ```
   http://localhost:3001/login
   ```
   或
   ```
   http://localhost:3000/login
   ```

3. **查看服务输出**:
   在运行 `npm run dev` 的终端中，应该看到：
   ```
   ▲ Next.js 16.0.2 (Turbopack)
   - Local:        http://localhost:3001
   - Network:      http://192.168.x.x:3001
   ```

---

## 快速修复命令

如果服务已停止，使用以下命令快速重启：

```bash
# 进入前端目录
cd saas-demo

# 启动服务
npm run dev
```

等待看到 "Ready" 或端口信息后，即可访问。

---

## 常见问题

### Q: 为什么端口是 3001 而不是 3000？
A: 端口 3000 被其他服务占用，Next.js 自动使用下一个可用端口。

### Q: 如何固定使用端口 3000？
A: 修改 `package.json` 中的启动脚本：
```json
"dev": "next dev -p 3000"
```

### Q: 服务启动后仍然无法访问？
A: 
1. 检查浏览器是否使用了代理
2. 尝试使用 `127.0.0.1` 而不是 `localhost`
3. 检查 hosts 文件是否有异常配置

---

## 当前操作

已执行的操作：
1. ✅ 检查后端服务状态
2. ✅ 检查前端端口监听
3. ✅ 重新启动前端服务
4. ⏳ 等待服务完全启动

**请等待 30-60 秒后再次访问 http://localhost:3001/login**

