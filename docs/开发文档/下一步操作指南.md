# Telegramæ³¨å†Œç³»ç»Ÿ - ä¸‹ä¸€æ­¥æ“ä½œæŒ‡å—

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ•°æ®åº“æ¨¡å‹
- âœ… åˆ›å»ºäº†ä¸‰ä¸ªæ•°æ®è¡¨ï¼š`user_registrations`ã€`session_files`ã€`anti_detection_logs`
- âœ… æ‰€æœ‰æ¨¡å‹å·²é€‚é…SQLiteï¼ˆä½¿ç”¨String(36)å­˜å‚¨UUIDï¼‰
- âœ… å·²ä¿®å¤`metadata`å­—æ®µåå†²çªï¼ˆæ”¹ä¸º`extra_metadata`ï¼‰

### 2. åç«¯æœåŠ¡
- âœ… `TelegramRegistrationService` - æ³¨å†ŒæœåŠ¡ï¼ˆæ”¯æŒSSHè¿œç¨‹æ‰§è¡Œï¼‰
- âœ… `AntiDetectionService` - é£æ§æœåŠ¡
- âœ… `RateLimiterService` - é€Ÿç‡é™åˆ¶æœåŠ¡
- âœ… æ‰€æœ‰UUIDç±»å‹å·²æ”¹ä¸ºå­—ç¬¦ä¸²ç±»å‹

### 3. APIæ¥å£
- âœ… `/api/v1/telegram-registration/start` - å¼€å§‹æ³¨å†Œ
- âœ… `/api/v1/telegram-registration/verify` - éªŒè¯OTP
- âœ… `/api/v1/telegram-registration/status/{registration_id}` - æŸ¥è¯¢çŠ¶æ€
- âœ… `/api/v1/telegram-registration/cancel` - å–æ¶ˆæ³¨å†Œ
- âœ… APIè·¯ç”±å·²æˆåŠŸæ³¨å†Œå¹¶åŠ è½½

### 4. å‰ç«¯ç»„ä»¶
- âœ… `TelegramRegister.tsx` - æ³¨å†Œé¡µé¢ç»„ä»¶
- âœ… APIè°ƒç”¨å‡½æ•°å·²æ·»åŠ åˆ°`api.ts`
- âœ… å·²é›†æˆåˆ°è´¦æˆ·é¡µé¢

### 5. ä¾èµ–å’Œé…ç½®
- âœ… `paramiko`å·²æ·»åŠ åˆ°`requirements.txt`
- âœ… æ•°æ®åº“è¿ç§»æ–‡ä»¶å·²åˆ›å»ºï¼ˆé€‚é…SQLiteï¼‰

## ğŸ“‹ ä¸‹ä¸€æ­¥æ“ä½œ

### 1. è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
cd admin-backend
alembic upgrade head
```

**æ³¨æ„**ï¼šè¿ç§»æ–‡ä»¶ä¸­çš„`down_revision`éœ€è¦æ ¹æ®å®é™…æœ€æ–°è¿ç§»IDä¿®æ”¹ã€‚å¯ä»¥å…ˆè¿è¡Œï¼š
```bash
alembic current
```
æŸ¥çœ‹å½“å‰è¿ç§»ç‰ˆæœ¬ï¼Œç„¶åä¿®æ”¹`xxxx_add_telegram_registration_tables.py`ä¸­çš„`down_revision`ã€‚

### 2. å®‰è£…ä¾èµ–

```bash
cd admin-backend
pip install paramiko
```

æˆ–è€…å®‰è£…æ‰€æœ‰ä¾èµ–ï¼š
```bash
pip install -r requirements.txt
```

### 3. æµ‹è¯•åç«¯æœåŠ¡

```bash
cd admin-backend
uvicorn app.main:app --reload
```

è®¿é—® `http://localhost:8000/docs` æŸ¥çœ‹APIæ–‡æ¡£ï¼Œç¡®è®¤æ–°æ¥å£å·²æ³¨å†Œã€‚

### 4. æµ‹è¯•å‰ç«¯

```bash
cd admin-frontend
npm run dev
```

è®¿é—®å‰ç«¯é¡µé¢ï¼Œè¿›å…¥"è´¦æˆ·ä¸­å¿ƒ" â†’ "Telegramæ³¨å†Œ"æ ‡ç­¾é¡µè¿›è¡Œæµ‹è¯•ã€‚

### 5. é…ç½®æœåŠ¡å™¨ä¿¡æ¯

ç¡®ä¿ `data/master_config.json` ä¸­é…ç½®äº†æœåŠ¡å™¨ä¿¡æ¯ï¼š

```json
{
  "servers": {
    "worker-01": {
      "host": "165.154.254.99",
      "user": "ubuntu",
      "password": "password",
      "node_id": "worker-01"
    }
  }
}
```

### 6. æµ‹è¯•å®Œæ•´æµç¨‹

1. æ‰“å¼€æ³¨å†Œé¡µé¢
2. è¾“å…¥æ‰‹æœºå·ï¼ˆå«å›½å®¶ä»£ç ï¼Œå¦‚ +1234567890ï¼‰
3. é€‰æ‹©æœåŠ¡å™¨èŠ‚ç‚¹
4. ç‚¹å‡»"å¼€å§‹æ³¨å†Œ"
5. è¾“å…¥æ”¶åˆ°çš„éªŒè¯ç 
6. å¦‚éœ€è¦ï¼Œè¾“å…¥ä¸¤æ­¥éªŒè¯å¯†ç 
7. å®Œæˆæ³¨å†Œ

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“è¿ç§»**ï¼šç¡®ä¿åœ¨è¿è¡Œè¿ç§»å‰å¤‡ä»½æ•°æ®åº“
2. **æœåŠ¡å™¨é…ç½®**ï¼šç¡®ä¿æœåŠ¡å™¨ä¸Šå·²å®‰è£…`pyrogram`å’Œ`paramiko`
3. **SSHè¿æ¥**ï¼šç¡®ä¿åç«¯æœåŠ¡å™¨å¯ä»¥SSHè¿æ¥åˆ°ç›®æ ‡æœåŠ¡å™¨
4. **Sessionæ–‡ä»¶è·¯å¾„**ï¼šç¡®ä¿æœåŠ¡å™¨ä¸Šçš„`sessions`ç›®å½•å­˜åœ¨ä¸”æœ‰å†™å…¥æƒé™
5. **APIå‡­è¯**ï¼šå¦‚æœæ²¡æœ‰æä¾›API ID/Hashï¼Œç³»ç»Ÿä¼šä½¿ç”¨æœåŠ¡å™¨é»˜è®¤é…ç½®

## ğŸ› å·²çŸ¥é—®é¢˜

1. **bcryptç‰ˆæœ¬è­¦å‘Š**ï¼šè¿™æ˜¯ä¸€ä¸ªå·²çŸ¥çš„è­¦å‘Šï¼Œä¸å½±å“åŠŸèƒ½
2. **psycopg2æœªå®‰è£…**ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨å›é€€åˆ°SQLiteï¼Œè¿™æ˜¯æ­£å¸¸çš„

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

1. å®ç°Sessionæ–‡ä»¶ä¸‹è½½åŠŸèƒ½
2. æ·»åŠ æ³¨å†Œå†å²æŸ¥è¯¢é¡µé¢
3. å®ç°æ‰¹é‡æ³¨å†ŒåŠŸèƒ½
4. ä½¿ç”¨WebSocketæ›¿ä»£è½®è¯¢å®ç°å®æ—¶çŠ¶æ€æ›´æ–°
5. æ·»åŠ æ›´è¯¦ç»†çš„é£æ§è§„åˆ™å’Œæ—¥å¿—åˆ†æ
6. å®ç°Sessionæ–‡ä»¶åŠ å¯†å­˜å‚¨

## ğŸ”— ç›¸å…³æ–‡æ¡£

- ç³»ç»Ÿè®¾è®¡æ–‡æ¡£ï¼š`docs/ç³»ç»Ÿè®¾è®¡/Telegram APIæ³¨å†Œç³»ç»Ÿè®¾è®¡æ–‡æ¡£.md`
- ä½¿ç”¨è¯´æ˜ï¼š`docs/å¼€å‘æ–‡æ¡£/Telegramæ³¨å†Œç³»ç»Ÿä½¿ç”¨è¯´æ˜.md`
- å¼€å‘æŠ¥å‘Šï¼š`docs/å¼€å‘æ–‡æ¡£/Telegramæ³¨å†Œç³»ç»Ÿå¼€å‘å®ŒæˆæŠ¥å‘Š.md`

