# éƒ¨ç½²é—®é¢˜è§£å†³æ–¹æ¡ˆ

ç”Ÿæˆæ—¶é—´: 2025-01-23

## ğŸ” é—®é¢˜è¯Šæ–­

æ ¹æ®æœåŠ¡å™¨ç»ˆç«¯æˆªå›¾ï¼Œç¡®è®¤é—®é¢˜ï¼š
- **é”™è¯¯**: `/usr/bin/python3: No module named pip`
- **åŸå› **: Ubuntu 24.04 æœåŠ¡å™¨é»˜è®¤æ²¡æœ‰å®‰è£… pip

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ³• 1: ä½¿ç”¨ apt å®‰è£… pipï¼ˆæ¨èï¼‰

```bash
# SSH åˆ°æœåŠ¡å™¨
ssh ubuntu@165.154.255.48

# æ›´æ–°åŒ…åˆ—è¡¨
sudo apt-get update

# å®‰è£… pip
sudo apt-get install -y python3-pip

# éªŒè¯å®‰è£…
python3 -m pip --version

# å®‰è£…ä¾èµ–
python3 -m pip install --user --upgrade uvicorn fastapi

# éªŒè¯å®‰è£…
python3 -c "import uvicorn; print(uvicorn.__version__)"
```

### æ–¹æ³• 2: ä½¿ç”¨ get-pip.py

```bash
# ä¸‹è½½ get-pip.py
curl -sS https://bootstrap.pypa.io/get-pip.py -o /tmp/get-pip.py

# å®‰è£… pip
python3 /tmp/get-pip.py --user

# æ¸…ç†
rm /tmp/get-pip.py
```

## ğŸš€ å®Œæ•´éƒ¨ç½²æ­¥éª¤

```bash
# 1. SSH åˆ°æœåŠ¡å™¨
ssh ubuntu@165.154.255.48

# 2. è¿›å…¥ç›®å½•
cd /home/ubuntu

# 3. å®‰è£… pip
sudo apt-get update
sudo apt-get install -y python3-pip

# 4. å®‰è£…ä¾èµ–
python3 -m pip install --user --upgrade pip
python3 -m pip install --user --upgrade uvicorn fastapi

# 5. éªŒè¯å®‰è£…
python3 -c "import uvicorn; print('uvicorn:', uvicorn.__version__)"
python3 -c "import fastapi; print('fastapi:', fastapi.__version__)"

# 6. è¿›å…¥ admin-backend
cd admin-backend

# 7. åˆ›å»º .env æ–‡ä»¶ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
if [ ! -f ".env" ]; then
    JWT_SECRET=$(python3 -c "import secrets; print(secrets.token_hex(32))")
    cat > .env << EOF
DATABASE_URL=sqlite:///./admin.db
JWT_SECRET=$JWT_SECRET
ADMIN_DEFAULT_EMAIL=admin@example.com
ADMIN_DEFAULT_PASSWORD=changeme123
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
EOF
fi

# 8. å¯åŠ¨æœåŠ¡
cd /home/ubuntu
mkdir -p logs
cd admin-backend
nohup python3 -m uvicorn app.main:app --host 0.0.0.0 --port 8000 > ../logs/backend.log 2>&1 &
echo $! > ../backend.pid

# 9. ç­‰å¾…å‡ ç§’
sleep 5

# 10. æ£€æŸ¥çŠ¶æ€
ps aux | grep uvicorn | grep -v grep
ss -tlnp | grep :8000
tail -30 ../logs/backend.log

# 11. å¥åº·æ£€æŸ¥
curl http://localhost:8000/health
```

## ğŸ“ ä¸‰ä¸ªæœåŠ¡å™¨

å¯¹ä»¥ä¸‹ä¸‰ä¸ªæœåŠ¡å™¨æ‰§è¡Œç›¸åŒæ­¥éª¤ï¼š

1. **æ´›æ‰çŸ¶**: `ssh ubuntu@165.154.255.48`
2. **é©¬å°¼æ‹‰**: `ssh ubuntu@165.154.233.179`
3. **worker-01**: `ssh ubuntu@165.154.254.99` (ç›®å½•: `/opt/group-ai`)

## ğŸ¯ éªŒè¯éƒ¨ç½²

éƒ¨ç½²å®Œæˆåï¼ŒéªŒè¯ï¼š
- âœ… pip å·²å®‰è£…
- âœ… uvicorn å’Œ fastapi å·²å®‰è£…
- âœ… æœåŠ¡è¿›ç¨‹è¿è¡Œä¸­
- âœ… ç«¯å£ 8000 ç›‘å¬ä¸­
- âœ… å¥åº·æ£€æŸ¥é€šè¿‡

## ğŸ“ å·²åˆ›å»ºçš„è„šæœ¬

- `scripts/deployment/install_pip_and_deploy.sh` - è‡ªåŠ¨å®‰è£… pip å¹¶éƒ¨ç½²

