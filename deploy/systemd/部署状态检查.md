# éƒ¨ç½²çŠ¶æ€æ£€æŸ¥æ¸…å•

> **æ£€æŸ¥æ—¶é—´**: è¯·å¡«å†™æ£€æŸ¥æ—¶é—´  
> **æœåŠ¡å™¨**: è¯·å¡«å†™æœåŠ¡å™¨åœ°å€

## ğŸ“‹ å¿«é€Ÿæ£€æŸ¥å‘½ä»¤

### åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œæ£€æŸ¥è„šæœ¬

```bash
# ä¸Šä¼  check_deployment.sh åˆ°æœåŠ¡å™¨åæ‰§è¡Œ
chmod +x check_deployment.sh
./check_deployment.sh
```

### æ‰‹åŠ¨æ£€æŸ¥å‘½ä»¤

```bash
# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status smart-tg-backend
sudo systemctl status smart-tg-frontend

# 2. æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯ç”¨
sudo systemctl is-enabled smart-tg-backend
sudo systemctl is-enabled smart-tg-frontend

# 3. æ£€æŸ¥ç«¯å£
sudo netstat -tlnp | grep -E ":8000|:3000"

# 4. æ£€æŸ¥å¥åº·ç«¯ç‚¹
curl http://localhost:8000/health
curl http://localhost:3000

# 5. æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u smart-tg-backend -n 50
sudo journalctl -u smart-tg-frontend -n 50
```

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

### 1. æœåŠ¡æ–‡ä»¶é…ç½®

- [ ] `/etc/systemd/system/smart-tg-backend.service` å­˜åœ¨
- [ ] `/etc/systemd/system/smart-tg-frontend.service` å­˜åœ¨
- [ ] æœåŠ¡æ–‡ä»¶ä¸­çš„è·¯å¾„æ­£ç¡®
- [ ] æœåŠ¡æ–‡ä»¶ä¸­çš„ç”¨æˆ·æƒé™æ­£ç¡®

### 2. åç«¯æœåŠ¡çŠ¶æ€

- [ ] æœåŠ¡å·²å¯ç”¨ (`systemctl is-enabled smart-tg-backend`)
- [ ] æœåŠ¡æ­£åœ¨è¿è¡Œ (`systemctl is-active smart-tg-backend`)
- [ ] ç«¯å£ 8000 è¢«å ç”¨
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡ (`curl http://localhost:8000/health`)
- [ ] æ—¥å¿—æ— é”™è¯¯

### 3. å‰ç«¯æœåŠ¡çŠ¶æ€

- [ ] æœåŠ¡å·²å¯ç”¨ (`systemctl is-enabled smart-tg-frontend`)
- [ ] æœåŠ¡æ­£åœ¨è¿è¡Œ (`systemctl is-active smart-tg-frontend`)
- [ ] ç«¯å£ 3000 è¢«å ç”¨
- [ ] å‰ç«¯é¡µé¢å¯è®¿é—® (`curl http://localhost:3000`)
- [ ] æ—¥å¿—æ— é”™è¯¯

### 4. ç›®å½•å’Œæ–‡ä»¶

- [ ] `/opt/smart-tg/admin-backend/` å­˜åœ¨
- [ ] `/opt/smart-tg/admin-backend/.env` å­˜åœ¨
- [ ] `/opt/smart-tg/admin-backend/.venv/` å­˜åœ¨
- [ ] `/opt/smart-tg/saas-demo/` å­˜åœ¨
- [ ] `/opt/smart-tg/saas-demo/.env.local` å­˜åœ¨
- [ ] `/opt/smart-tg/saas-demo/.next/` å­˜åœ¨ï¼ˆå·²æ„å»ºï¼‰

### 5. ç¯å¢ƒå˜é‡é…ç½®

- [ ] åç«¯ `.env` æ–‡ä»¶é…ç½®æ­£ç¡®
  - [ ] `DATABASE_URL` é…ç½®
  - [ ] `JWT_SECRET` å·²ä¿®æ”¹ï¼ˆä¸æ˜¯é»˜è®¤å€¼ï¼‰
  - [ ] `CORS_ORIGINS` é…ç½®æ­£ç¡®
- [ ] å‰ç«¯ `.env.local` æ–‡ä»¶é…ç½®æ­£ç¡®
  - [ ] `NEXT_PUBLIC_API_BASE_URL` é…ç½®æ­£ç¡®

### 6. æ•°æ®åº“

- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] æ•°æ®åº“è¿ç§»å·²æ‰§è¡Œ (`alembic upgrade head`)
- [ ] æ•°æ®åº“è¡¨å·²åˆ›å»º

### 7. Nginx é…ç½®ï¼ˆå¦‚æœä½¿ç”¨ï¼‰

- [ ] Nginx é…ç½®æ–‡ä»¶å­˜åœ¨
- [ ] Nginx é…ç½®å·²å¯ç”¨
- [ ] Nginx æœåŠ¡è¿è¡Œæ­£å¸¸
- [ ] åå‘ä»£ç†é…ç½®æ­£ç¡®

### 8. é˜²ç«å¢™å’Œå®‰å…¨

- [ ] é˜²ç«å¢™è§„åˆ™é…ç½®
- [ ] åªå¼€æ”¾å¿…è¦ç«¯å£
- [ ] HTTPS é…ç½®ï¼ˆå¦‚æœä½¿ç”¨ï¼‰

---

## ğŸ” å¸¸è§é—®é¢˜æ£€æŸ¥

### é—®é¢˜ 1: æœåŠ¡æ— æ³•å¯åŠ¨

**æ£€æŸ¥æ­¥éª¤:**
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
sudo journalctl -u smart-tg-backend -n 50 --no-pager

# æ£€æŸ¥æƒé™
ls -la /opt/smart-tg/
sudo chown -R www-data:www-data /opt/smart-tg

# æ‰‹åŠ¨æµ‹è¯•
cd /opt/smart-tg/admin-backend
source .venv/bin/activate
gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000
```

### é—®é¢˜ 2: ç«¯å£è¢«å ç”¨

**æ£€æŸ¥æ­¥éª¤:**
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo netstat -tlnp | grep -E ":8000|:3000"

# æ€æ­»å ç”¨è¿›ç¨‹
sudo kill -9 <PID>
```

### é—®é¢˜ 3: æƒé™é—®é¢˜

**ä¿®å¤å‘½ä»¤:**
```bash
sudo chown -R www-data:www-data /opt/smart-tg
sudo chmod -R 755 /opt/smart-tg
```

---

## ğŸ“ æ£€æŸ¥ç»“æœè®°å½•

### æ£€æŸ¥æ—¥æœŸ: ___________

### æ£€æŸ¥äººå‘˜: ___________

### åç«¯æœåŠ¡çŠ¶æ€:
- [ ] æ­£å¸¸è¿è¡Œ
- [ ] å­˜åœ¨é—®é¢˜: ___________

### å‰ç«¯æœåŠ¡çŠ¶æ€:
- [ ] æ­£å¸¸è¿è¡Œ
- [ ] å­˜åœ¨é—®é¢˜: ___________

### å‘ç°çš„é—®é¢˜:
1. 
2. 
3. 

### éœ€è¦ä¿®å¤çš„é—®é¢˜:
1. 
2. 
3. 

---

## ğŸ¯ éƒ¨ç½²å®Œæˆæ ‡å‡†

éƒ¨ç½²è¢«è®¤ä¸ºå®Œæˆå½“ï¼š

- [x] æ‰€æœ‰æœåŠ¡æ–‡ä»¶å·²åˆ›å»º
- [ ] åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] å‰ç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] æ—¥å¿—æ— ä¸¥é‡é”™è¯¯
- [ ] å¯ä»¥é€šè¿‡å…¬ç½‘è®¿é—®ï¼ˆå¦‚æœé…ç½®äº† Nginxï¼‰

---

*æ£€æŸ¥æ¸…å•æœ€åæ›´æ–°: 2025-11-26*

