# 服務重啟說明

**日期**: 2025-01-17

## 問題

用戶發現前端頁面沒有顯示新的功能（帳號資料信息、編輯功能等）。

## 原因

前端和後端服務需要重啟才能加載新的代碼更改。

## 解決方案

### 1. 後端服務重啟

**Windows PowerShell**:
```powershell
# 停止所有後端服務
Get-Process | Where-Object {$_.ProcessName -eq "python"} | Stop-Process -Force

# 啟動後端服務
cd admin-backend
$env:PYTHONIOENCODING='utf-8'
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

### 2. 前端服務重啟

**Windows PowerShell**:
```powershell
# 停止前端服務（Ctrl+C 或）
Get-Process | Where-Object {$_.ProcessName -eq "node" -and (Get-NetTCPConnection -OwningProcess $_.Id -ErrorAction SilentlyContinue | Where-Object {$_.LocalPort -eq 3000})} | Stop-Process -Force

# 啟動前端服務
cd saas-demo
npm run dev
```

### 3. 驗證服務狀態

```powershell
# 檢查端口監聽
netstat -ano | findstr ":3000 :8000" | Select-String "LISTENING"
```

## 已完成的更改

1. ✅ 數據庫遷移已運行（添加帳號資料信息字段）
2. ✅ 後端API已更新（支持資料信息獲取和編輯）
3. ✅ 前端UI已更新（顯示頭像、資料信息、編輯功能）
4. ✅ 根路徑路由已添加（`GET /`）

## 注意事項

1. **根路徑 (`localhost:8000`)**:
   - 如果仍顯示 `{"detail": "Not Found"}`，請等待幾秒鐘讓 uvicorn 自動重新加載
   - 或者訪問 `http://localhost:8000/api/v1/group-ai/accounts/` 直接使用 API
   - 或者訪問 `http://localhost:8000/docs` 查看 API 文檔

2. **前端頁面**:
   - 如果頁面沒有更新，請硬刷新瀏覽器（`Ctrl+Shift+R` 或 `Ctrl+F5`）
   - 清除瀏覽器緩存

3. **創建帳號**:
   - 創建帳號時會自動獲取資料信息（需要安裝 `pyrogram` 和配置 `API_ID`、`API_HASH`）
   - 如果無法獲取資料信息，會記錄警告但不影響帳號創建
   - 可以稍後手動編輯資料信息

## 驗證步驟

1. **檢查服務狀態**:
   - 後端: `http://localhost:8000/health` 應返回 `{"status": "ok"}`
   - 前端: `http://localhost:3000` 應正常顯示

2. **測試API**:
   ```powershell
   # 測試帳號列表
   curl http://localhost:8000/api/v1/group-ai/accounts/
   
   # 測試創建帳號（需要有效的 session 文件）
   curl -X POST http://localhost:8000/api/v1/group-ai/accounts/ `
     -H "Content-Type: application/json" `
     -d '{"account_id":"test-001","session_file":"639277356598.session","script_id":"test_version_script"}'
   ```

3. **測試前端**:
   - 訪問 `http://localhost:3000/group-ai/accounts`
   - 檢查帳號列表是否顯示頭像和資料信息
   - 點擊「編輯」按鈕測試編輯功能

