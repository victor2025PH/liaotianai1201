# 群組 AI 功能使用手冊

## 目錄

1. [概述](#概述)
2. [快速開始](#快速開始)
3. [賬號管理](#賬號管理)
4. [劇本管理](#劇本管理)
5. [角色分配](#角色分配)
6. [功能串聯使用流程](#功能串聯使用流程)
7. [常見問題](#常見問題)

---

## 概述

群組 AI 系統是一個完整的 Telegram 群組自動化管理平台，包含三個核心功能模塊：

- **賬號管理**：管理 Telegram 賬號的創建、啟動、停止和配置
- **劇本管理**：創建和管理 AI 對話劇本
- **角色分配**：為賬號分配劇本中的角色

### 系統架構

```
Session 文件 → 賬號管理 → 劇本管理 → 角色分配 → 運行
```

---

## 快速開始

### 第一步：準備 Session 文件

1. 將您的 Telegram `.session` 文件放置在項目的 `sessions` 目錄中
2. 確保文件格式正確（`.session` 擴展名）

### 第二步：掃描 Session 文件

1. 進入「群組 AI」→「賬號管理」頁面
2. 點擊「掃描 Session」按鈕
3. 系統會自動掃描 `sessions` 目錄中的所有 `.session` 文件
4. 掃描成功後，會顯示找到的文件數量

### 第三步：創建賬號

1. 點擊「添加賬號」按鈕
2. 填寫以下信息：
   - **賬號 ID**：自定義的賬號標識符
   - **Session 文件**：從下拉列表中選擇已掃描的 Session 文件
   - **劇本 ID**：選擇要使用的劇本（如果還沒有劇本，請先創建）
3. 點擊「創建」完成賬號創建

---

## 賬號管理

### 功能概述

賬號管理是系統的核心模塊，用於管理所有 Telegram AI 賬號。

### 主要功能

#### 1. 掃描 Session 文件

- **位置**：賬號管理頁面頂部工具欄
- **功能**：掃描 `sessions` 目錄中的所有 `.session` 文件
- **顯示**：掃描成功後，會在頁面上顯示「可用的 Session 文件」卡片，列出所有找到的文件

#### 2. 上傳 Session 文件

- **位置**：創建賬號對話框中的「上傳 Session」按鈕
- **功能**：上傳新的 `.session` 文件到系統
- **限制**：
  - 只支持 `.session` 文件
  - 文件大小不超過 10MB

#### 3. 創建賬號

**步驟**：

1. 點擊「添加賬號」按鈕
2. 填寫必填信息：
   - **賬號 ID**：唯一標識符（建議使用有意義的名稱）
   - **Session 文件**：
     - 從下拉列表選擇已掃描的文件
     - 或點擊「上傳 Session」上傳新文件
     - 或手動輸入文件名
   - **劇本 ID**：
     - 從下拉列表選擇已創建的劇本
     - 或點擊「管理劇本」快速跳轉到劇本管理頁面
     - 或手動輸入劇本 ID
3. 點擊「創建」按鈕

**注意事項**：
- 所有標記為 `*` 的字段都是必填項
- 賬號 ID 必須唯一
- Session 文件必須存在於 `sessions` 目錄中

#### 4. 啟動/停止賬號

- **啟動賬號**：點擊賬號列表中的「播放」按鈕（▶️）
- **停止賬號**：點擊賬號列表中的「停止」按鈕（⏹️）
- **狀態顯示**：賬號狀態會實時更新（online/offline/error）

#### 5. 賬號設置

- **位置**：賬號列表操作欄中的「設置」按鈕（⚙️）
- **功能**：配置賬號的運行參數
  - 回復率
  - 紅包功能開關
  - 紅包概率
  - 每小時最大回復數
  - 最小回復間隔

#### 6. 角色分配

- **位置**：賬號列表操作欄中的「角色分配」按鈕（👥）
- **功能**：快速跳轉到角色分配頁面，為該賬號分配角色

#### 7. 刪除賬號

- **位置**：賬號列表操作欄中的「刪除」按鈕（🗑️）
- **功能**：刪除不需要的賬號
- **注意**：刪除操作無法撤銷，請謹慎操作

### 界面說明

#### 可用的 Session 文件卡片

當掃描到 Session 文件後，會在賬號列表上方顯示一個卡片：

- **標題**：可用的 Session 文件
- **文件數量**：顯示找到的文件總數
- **文件列表**：以網格形式顯示所有可用的 Session 文件
  - 文件名
  - 文件大小（KB）

#### 賬號列表

顯示所有已創建的賬號，包含以下信息：

- **賬號 ID**：賬號的唯一標識符
- **狀態**：當前運行狀態（online/offline/error）
- **Session 文件**：使用的 Session 文件名
- **劇本**：綁定的劇本 ID
- **群組數**：加入的群組數量
- **消息數**：處理的消息總數
- **回復數**：發送的回復總數
- **操作**：各種操作按鈕

---

## 劇本管理

### 功能概述

劇本管理用於創建和管理 AI 對話劇本，定義 AI 在群組中的行為和回應邏輯。

### 主要功能

#### 1. 創建劇本

**步驟**：

1. 點擊「創建劇本」按鈕
2. 填寫劇本信息：
   - **劇本 ID**：唯一標識符
   - **名稱**：劇本的顯示名稱
   - **版本**：劇本版本號（如：1.0）
   - **描述**：劇本的說明文字
   - **YAML 內容**：劇本的 YAML 配置內容
3. 點擊「創建」完成

#### 2. 編輯劇本

- 點擊劇本列表中的「編輯」按鈕
- 修改劇本內容
- 保存更改

#### 3. 測試劇本

- 點擊劇本列表中的「測試」按鈕
- 輸入測試消息
- 查看 AI 的回應結果

#### 4. 刪除劇本

- 點擊劇本列表中的「刪除」按鈕
- 確認刪除操作

**注意**：刪除劇本前，請確保沒有賬號正在使用該劇本。

### 劇本格式

劇本使用 YAML 格式，定義 AI 的行為規則、回應模板和角色設定。

---

## 角色分配

### 功能概述

角色分配用於為賬號分配劇本中定義的角色，實現多賬號協同工作。

### 主要功能

#### 1. 選擇劇本

- 從下拉列表中選擇要使用的劇本
- 系統會自動加載該劇本的所有角色

#### 2. 提取角色

- 點擊「提取角色」按鈕
- 系統會從選定的劇本中提取所有角色定義
- 顯示角色列表和總數

#### 3. 選擇賬號

- 從賬號列表中選擇要分配角色的賬號
- 可以選擇多個賬號

#### 4. 創建分配方案

**分配模式**：

- **自動分配**：系統自動為賬號分配角色
- **手動分配**：手動為每個賬號指定角色

**步驟**：

1. 選擇分配模式
2. 如果選擇手動分配，為每個賬號選擇對應的角色
3. 點擊「創建分配方案」按鈕
4. 查看生成的分配方案

#### 5. 應用分配

- 查看分配方案預覽
- 確認無誤後，點擊「應用分配」按鈕
- 系統會將角色分配應用到選定的賬號

---

## 功能串聯使用流程

### 完整工作流程

#### 場景：從零開始設置一個新的 AI 賬號

**步驟 1：準備 Session 文件**
```
1. 將 .session 文件放入 sessions 目錄
2. 進入「賬號管理」頁面
3. 點擊「掃描 Session」按鈕
4. 確認文件已掃描成功
```

**步驟 2：創建劇本（如果還沒有）**
```
1. 進入「劇本管理」頁面
2. 點擊「創建劇本」按鈕
3. 填寫劇本信息並保存
4. 記下劇本 ID
```

**步驟 3：創建賬號**
```
1. 返回「賬號管理」頁面
2. 點擊「添加賬號」按鈕
3. 填寫賬號信息：
   - 賬號 ID：my_account_1
   - Session 文件：從下拉列表選擇
   - 劇本 ID：從下拉列表選擇（或手動輸入）
4. 點擊「創建」
```

**步驟 4：配置賬號參數（可選）**
```
1. 在賬號列表中，點擊「設置」按鈕
2. 調整運行參數
3. 保存設置
```

**步驟 5：分配角色（如果需要）**
```
1. 在賬號列表中，點擊「角色分配」按鈕
2. 或直接進入「角色分配」頁面
3. 選擇劇本
4. 提取角色
5. 選擇賬號
6. 創建並應用分配方案
```

**步驟 6：啟動賬號**
```
1. 在賬號列表中，點擊「啟動」按鈕（▶️）
2. 等待賬號狀態變為「online」
3. 賬號開始運行
```

### 快速操作路徑

#### 從賬號管理到劇本管理

- **方法 1**：在創建賬號對話框中，點擊「管理劇本」按鈕
- **方法 2**：從側邊欄導航到「劇本管理」

#### 從賬號管理到角色分配

- **方法 1**：在賬號列表中，點擊「角色分配」按鈕（👥）
- **方法 2**：從側邊欄導航到「角色分配」頁面，然後選擇賬號

#### 從劇本管理到賬號管理

- 從側邊欄導航到「賬號管理」
- 在創建賬號時，可以選擇剛創建的劇本

---

## 常見問題

### Q1: 掃描 Session 文件時顯示「未找到文件」

**可能原因**：
- Session 文件不在 `sessions` 目錄中
- 文件擴展名不是 `.session`
- 文件路徑配置錯誤

**解決方法**：
1. 確認文件已放置在項目的 `sessions` 目錄中
2. 檢查文件擴展名是否為 `.session`
3. 重新點擊「掃描 Session」按鈕

### Q2: 創建賬號時無法選擇 Session 文件

**可能原因**：
- 還沒有掃描 Session 文件
- Session 文件列表為空

**解決方法**：
1. 先點擊「掃描 Session」按鈕
2. 或點擊「上傳 Session」上傳新文件
3. 或手動輸入 Session 文件名

### Q3: 創建賬號時無法選擇劇本

**可能原因**：
- 還沒有創建任何劇本
- 劇本列表加載失敗

**解決方法**：
1. 先進入「劇本管理」頁面創建劇本
2. 或點擊「管理劇本」按鈕快速跳轉
3. 或手動輸入劇本 ID

### Q4: 賬號無法啟動

**可能原因**：
- Session 文件無效或已過期
- 劇本配置錯誤
- 網絡連接問題

**解決方法**：
1. 檢查 Session 文件是否有效
2. 檢查劇本配置是否正確
3. 查看系統日誌了解詳細錯誤信息

### Q5: 如何刪除賬號？

**步驟**：
1. 在賬號列表中，找到要刪除的賬號
2. 點擊「刪除」按鈕（🗑️）
3. 在確認對話框中點擊「確認」
4. 賬號將被永久刪除

**注意**：刪除操作無法撤銷，請謹慎操作。

### Q6: 如何為多個賬號分配角色？

**步驟**：
1. 進入「角色分配」頁面
2. 選擇劇本並提取角色
3. 在賬號列表中選擇多個賬號（勾選複選框）
4. 選擇分配模式（自動或手動）
5. 創建並應用分配方案

### Q7: 賬號狀態一直顯示「offline」

**可能原因**：
- 賬號未啟動
- 啟動過程中出現錯誤

**解決方法**：
1. 點擊「啟動」按鈕啟動賬號
2. 查看系統日誌了解啟動失敗的原因
3. 檢查 Session 文件和劇本配置

---

## 最佳實踐

### 1. 命名規範

- **賬號 ID**：使用有意義的名稱，如 `account_001`、`bot_main`
- **劇本 ID**：使用描述性名稱，如 `default`、`customer_service`
- **Session 文件**：使用賬號相關的名稱，如 `123456789.session`

### 2. 工作流程建議

1. **先創建劇本**：在創建賬號前，先準備好要使用的劇本
2. **批量掃描**：一次性掃描所有 Session 文件
3. **測試後啟動**：創建賬號後，先測試功能，確認無誤後再啟動
4. **定期檢查**：定期檢查賬號狀態和運行日誌

### 3. 安全建議

- 妥善保管 Session 文件，不要洩露
- 定期備份賬號配置
- 使用強密碼保護系統訪問

---

## 技術支持

如遇到問題，請：

1. 查看系統日誌了解詳細錯誤信息
2. 檢查瀏覽器控制台是否有錯誤
3. 確認所有服務正常運行
4. 聯繫技術支持團隊

---


