# 502 错误 - 后端正常但前端未运行

## 当前状态

✅ **后端服务正常**：
- `curl http://localhost:8000/health` 返回 `{"status":"ok"}`
- 后端进程正在运行

❌ **浏览器显示 502 Bad Gateway**

## 问题原因

后端服务正常，但前端服务（Next.js，端口3000）可能未运行，导致 Nginx 无法代理到前端服务。

## 解决方案

### 快速修复（在服务器上执行）

```bash
cd ~/liaotian/saas-demo

# 清理旧进程
pkill -f 'next.*dev|node.*3000' || true
sleep 2

# 启动前端
nohup npm run dev > /tmp/frontend.log 2>&1 &

# 等待启动
sleep 15

# 验证
curl http://localhost:3000
```

### 或使用脚本

```bash
bash ~/liaotian/deploy/修复502-启动前端服务.sh
```

## 验证步骤

### 1. 检查前端进程

```bash
ps aux | grep -E 'next.*dev|node.*3000' | grep -v grep
```

### 2. 检查前端端口

```bash
sudo ss -tlnp | grep 3000
```

### 3. 测试前端服务

```bash
curl http://localhost:3000
```

### 4. 检查前端日志

```bash
tail -50 /tmp/frontend.log
```

### 5. 重新加载Nginx

```bash
sudo nginx -t
sudo systemctl reload nginx
```

## 完整启动流程

```bash
# 1. 确保后端运行
cd ~/liaotian/admin-backend
source .venv/bin/activate
curl http://localhost:8000/health

# 2. 启动前端
cd ~/liaotian/saas-demo
pkill -f 'next.*dev|node.*3000' || true
nohup npm run dev > /tmp/frontend.log 2>&1 &
sleep 15

# 3. 验证
curl http://localhost:3000

# 4. 重新加载Nginx
sudo systemctl reload nginx

# 5. 测试浏览器
# 访问: http://aikz.usdt2026.cc/group-ai/accounts
```

## 常见问题

### 前端启动失败

查看日志：
```bash
tail -100 /tmp/frontend.log
```

常见原因：
- 端口被占用
- 依赖缺失
- 构建错误

### 前端启动但无法访问

1. 检查端口监听：
   ```bash
   sudo ss -tlnp | grep 3000
   ```

2. 检查防火墙：
   ```bash
   sudo ufw status
   ```

3. 检查Nginx配置：
   ```bash
   sudo grep -r "3000\|group-ai" /etc/nginx/
   ```

## 预期结果

修复后：
- ✅ 前端进程运行中
- ✅ 端口3000监听中
- ✅ `curl http://localhost:3000` 返回HTML内容
- ✅ 浏览器不再显示 502 错误

---

**后端已正常，只需启动前端服务即可修复 502 错误！**
