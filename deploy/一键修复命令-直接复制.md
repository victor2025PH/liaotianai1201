# 一键修复命令 - 直接复制执行

## 推荐方式：使用脚本（最简单）

已在服务器上创建了修复脚本，**直接复制以下命令执行**：

```bash
bash /tmp/fix_one_click.sh
```

或者：

```bash
bash /tmp/fix_static_final.sh
```

---

## 方式2：一键复制整个命令块

如果脚本不存在，可以**直接复制以下整个命令块**（一行，用 `&&` 连接）并执行：

```bash
cd /home/ubuntu/liaotian/saas-demo && sudo systemctl stop liaotian-frontend && if [ ! -f ".next/static/chunks/adc3be135379192a.js" ]; then echo "源文件不存在，重新构建..." && rm -rf .next node_modules/.cache && export NVM_DIR="$HOME/.nvm" && [ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh" && nvm use 20 && npm run build; fi && rm -rf .next/standalone/liaotian/saas-demo/.next && mkdir -p .next/standalone/liaotian/saas-demo/.next && cp -r .next/static .next/standalone/liaotian/saas-demo/.next/ && ls -la .next/standalone/liaotian/saas-demo/.next/static/chunks/adc3be135379192a.js && sudo systemctl start liaotian-frontend && sleep 5 && sudo systemctl status liaotian-frontend --no-pager | head -15 && curl -I http://localhost:3000/_next/static/chunks/adc3be135379192a.js 2>&1 | head -5
```

**使用方法**：
1. 复制上面的整个命令（从 `cd` 开始到最后的 `head -5`）
2. 在服务器终端粘贴
3. 按 Enter 执行
4. 等待执行完成（可能需要几分钟，如果重新构建的话）

---

## 方式3：分步执行（如果一键执行失败）

如果上面的命令太长或执行失败，可以**分步执行**：

### 步骤1：进入目录并停止服务
```bash
cd /home/ubuntu/liaotian/saas-demo
sudo systemctl stop liaotian-frontend
```

### 步骤2：检查源文件，如果不存在则重新构建
```bash
if [ ! -f ".next/static/chunks/adc3be135379192a.js" ]; then
    echo "源文件不存在，重新构建..."
    rm -rf .next node_modules/.cache
    export NVM_DIR="$HOME/.nvm"
    [ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"
    nvm use 20
    npm run build
fi
```

### 步骤3：删除旧的静态文件目录
```bash
rm -rf .next/standalone/liaotian/saas-demo/.next
```

### 步骤4：创建.next目录并复制静态文件
```bash
mkdir -p .next/standalone/liaotian/saas-demo/.next
cp -r .next/static .next/standalone/liaotian/saas-demo/.next/
```

### 步骤5：验证文件已复制
```bash
ls -la .next/standalone/liaotian/saas-demo/.next/static/chunks/adc3be135379192a.js
```

### 步骤6：重启服务
```bash
sudo systemctl start liaotian-frontend
sleep 5
```

### 步骤7：检查服务状态
```bash
sudo systemctl status liaotian-frontend --no-pager | head -15
```

### 步骤8：测试静态文件访问
```bash
curl -I http://localhost:3000/_next/static/chunks/adc3be135379192a.js
```

---

## 执行说明

- **方式1（脚本）**：最简单，推荐使用
- **方式2（一键命令）**：如果脚本不存在，可以复制整个命令块一键执行
- **方式3（分步执行）**：如果一键执行遇到问题，可以分步执行，每步执行完再执行下一步

## 预期结果

执行成功后应该看到：
1. ✅ 文件已复制：`ls` 命令显示文件存在
2. ✅ 服务运行：`Active: active (running)`
3. ✅ 静态文件可访问：`curl` 返回 `HTTP/1.1 200 OK`

## 注意事项

- 如果源文件不存在，命令会自动重新构建（可能需要几分钟）
- 执行过程中不要中断
- 如果遇到错误，请查看错误信息并告诉我

