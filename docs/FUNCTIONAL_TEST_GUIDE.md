# 功能測試指南

> **目的**: 系統化測試所有核心功能，確保系統正常運行

---

## 🎯 測試前準備

### 1. 確認服務運行

```bash
# 在服務器上檢查
pm2 status
# 應該看到 backend 和 frontend 都是 online
```

### 2. 準備測試賬號

- **管理員賬號**: 使用配置的管理員郵箱和密碼
- **測試數據**: 準備一些測試用的 Telegram 賬號和劇本

---

## 📋 核心功能測試清單

### ✅ 1. 認證與授權

#### 1.1 登錄功能
- [ ] **訪問登錄頁面**
  - URL: `https://aikz.usdt2026.cc/login`
  - 預期: 顯示登錄表單

- [ ] **成功登錄**
  - 使用正確的管理員賬號和密碼
  - 預期: 跳轉到儀表板，顯示用戶信息

- [ ] **登錄失敗處理**
  - 使用錯誤的密碼
  - 預期: 顯示錯誤提示，不跳轉

- [ ] **Token 驗證**
  - 登錄後檢查瀏覽器 LocalStorage
  - 預期: 存在 `access_token`

#### 1.2 權限控制
- [ ] **未登錄訪問保護**
  - 直接訪問受保護頁面（如 `/group-ai/accounts`）
  - 預期: 重定向到登錄頁面

- [ ] **API 權限驗證**
  - 使用 Swagger UI (`/docs`) 測試 API
  - 未提供 Token 時應該返回 401

---

### ✅ 2. 儀表板功能

#### 2.1 數據顯示
- [ ] **訪問儀表板**
  - URL: `https://aikz.usdt2026.cc`
  - 預期: 顯示統計卡片和圖表

- [ ] **統計數據**
  - 檢查以下指標是否顯示：
    - 今日會話量
    - 成功率
    - Token 用量
    - 錯誤數
    - 平均響應時間
    - 活躍用戶

- [ ] **數據刷新**
  - 點擊刷新按鈕
  - 預期: 數據更新

#### 2.2 圖表顯示
- [ ] **響應時間圖表**
  - 預期: 圖表正常渲染（可能為空數據）

- [ ] **系統狀態**
  - 預期: 顯示系統健康狀態

---

### ✅ 3. 賬號管理功能

#### 3.1 賬號列表
- [ ] **訪問賬號管理頁面**
  - URL: `https://aikz.usdt2026.cc/group-ai/accounts`
  - 預期: 顯示賬號列表（可能為空）

- [ ] **列表功能**
  - 搜索功能
  - 篩選功能（按狀態、劇本等）
  - 排序功能
  - 分頁功能

#### 3.2 創建賬號
- [ ] **打開創建對話框**
  - 點擊"創建賬號"按鈕
  - 預期: 顯示創建表單

- [ ] **填寫表單**
  - 賬號名稱
  - 選擇劇本（如果有）
  - 選擇服務器（如果有）
  - 其他必填字段

- [ ] **提交創建**
  - 點擊"創建"按鈕
  - 預期: 顯示成功提示，列表更新

#### 3.3 編輯賬號
- [ ] **打開編輯對話框**
  - 點擊賬號行的"編輯"按鈕
  - 預期: 顯示編輯表單，預填充數據

- [ ] **修改信息**
  - 修改賬號名稱或其他字段
  - 預期: 表單正常更新

- [ ] **保存修改**
  - 點擊"保存"按鈕
  - 預期: 顯示成功提示，列表更新

#### 3.4 賬號操作
- [ ] **啟動賬號**
  - 點擊"啟動"按鈕
  - 預期: 狀態變為"運行中"

- [ ] **停止賬號**
  - 點擊"停止"按鈕
  - 預期: 狀態變為"已停止"

- [ ] **重啟賬號**
  - 點擊"重啟"按鈕
  - 預期: 狀態短暫變化後恢復運行

- [ ] **刪除賬號**
  - 點擊"刪除"按鈕
  - 確認刪除
  - 預期: 賬號從列表移除

#### 3.5 上傳 Session 文件
- [ ] **上傳功能**
  - 點擊"上傳 Session"按鈕
  - 選擇 `.session` 文件
  - 預期: 上傳成功，自動創建賬號

---

### ✅ 4. 劇本管理功能

#### 4.1 劇本列表
- [ ] **訪問劇本管理頁面**
  - URL: `https://aikz.usdt2026.cc/group-ai/scripts`
  - 預期: 顯示劇本列表

- [ ] **列表功能**
  - 搜索功能
  - 篩選功能（按狀態）
  - 排序功能
  - 分頁功能

#### 4.2 創建劇本
- [ ] **打開創建對話框**
  - 點擊"創建劇本"按鈕
  - 預期: 顯示創建表單

- [ ] **填寫表單**
  - 劇本名稱
  - 劇本描述
  - 劇本內容（YAML 格式）
  - 其他必填字段

- [ ] **提交創建**
  - 點擊"創建"按鈕
  - 預期: 顯示成功提示，列表更新

#### 4.3 編輯劇本
- [ ] **打開編輯對話框**
  - 點擊劇本行的"編輯"按鈕
  - 預期: 顯示編輯表單

- [ ] **修改內容**
  - 修改劇本名稱或內容
  - 預期: 表單正常更新

- [ ] **保存修改**
  - 點擊"保存"按鈕
  - 預期: 顯示成功提示，列表更新

#### 4.4 劇本操作
- [ ] **激活劇本**
  - 點擊"激活"按鈕
  - 預期: 狀態變為"激活"

- [ ] **禁用劇本**
  - 點擊"禁用"按鈕
  - 預期: 狀態變為"禁用"

- [ ] **刪除劇本**
  - 點擊"刪除"按鈕
  - 確認刪除
  - 預期: 劇本從列表移除

---

### ✅ 5. 角色分配功能

#### 5.1 角色分配方案列表
- [ ] **訪問角色分配方案頁面**
  - URL: `https://aikz.usdt2026.cc/group-ai/role-assignment-schemes`
  - 預期: 顯示方案列表

#### 5.2 創建分配方案
- [ ] **打開創建對話框**
  - 點擊"創建方案"按鈕
  - 預期: 顯示創建表單

- [ ] **填寫表單**
  - 方案名稱
  - 選擇劇本
  - 分配模式（自動/手動）
  - 分配規則

- [ ] **提交創建**
  - 預期: 顯示成功提示，列表更新

#### 5.3 應用分配方案
- [ ] **應用方案**
  - 點擊"應用"按鈕
  - 預期: 顯示應用結果

---

### ✅ 6. 監控功能

#### 6.1 系統監控
- [ ] **訪問監控頁面**
  - URL: `https://aikz.usdt2026.cc/group-ai/monitor`
  - 預期: 顯示監控數據

- [ ] **監控指標**
  - CPU 使用率
  - 內存使用率
  - 賬號狀態
  - 系統統計

#### 6.2 日誌管理
- [ ] **訪問日誌頁面**
  - URL: `https://aikz.usdt2026.cc/group-ai/logs`
  - 預期: 顯示日誌列表

- [ ] **日誌功能**
  - 搜索功能
  - 按級別篩選（error, warning, info）
  - 按來源篩選
  - 時間範圍篩選
  - 導出功能（CSV/JSON）

#### 6.3 會話管理
- [ ] **訪問會話頁面**
  - URL: `https://aikz.usdt2026.cc/group-ai/sessions`
  - 預期: 顯示會話列表

- [ ] **會話功能**
  - 查看會話詳情
  - 斷開會話
  - 會話狀態顯示

---

### ✅ 7. 告警與通知功能

#### 7.1 告警設置
- [ ] **訪問告警設置頁面**
  - URL: `https://aikz.usdt2026.cc/settings/alerts`
  - 預期: 顯示告警規則列表

- [ ] **創建告警規則**
  - 點擊"創建規則"按鈕
  - 填寫規則信息
  - 預期: 規則創建成功

#### 7.2 通知配置
- [ ] **訪問通知配置頁面**
  - URL: `https://aikz.usdt2026.cc/notifications/configs`
  - 預期: 顯示通知配置列表

- [ ] **配置通知渠道**
  - Email 配置
  - Telegram Bot 配置
  - Webhook 配置

- [ ] **測試通知**
  - 點擊"發送測試"按鈕
  - 預期: 收到測試通知

---

### ✅ 8. 用戶與權限管理

#### 8.1 用戶管理
- [ ] **訪問用戶管理頁面**
  - URL: `https://aikz.usdt2026.cc/permissions/users`
  - 預期: 顯示用戶列表

- [ ] **創建用戶**
  - 點擊"創建用戶"按鈕
  - 填寫用戶信息
  - 預期: 用戶創建成功

- [ ] **分配角色**
  - 為用戶分配角色
  - 預期: 角色分配成功

#### 8.2 權限驗證
- [ ] **測試不同權限**
  - 使用不同角色的用戶登錄
  - 驗證只能訪問被授權的功能

---

### ✅ 9. API 文檔

#### 9.1 Swagger UI
- [ ] **訪問 API 文檔**
  - URL: `https://aikz.usdt2026.cc/docs`
  - 預期: 顯示 Swagger UI

- [ ] **API 端點列表**
  - 檢查所有端點是否顯示
  - 檢查請求/響應模型是否正確

- [ ] **API 測試**
  - 使用 Swagger UI 測試幾個關鍵 API
  - 驗證響應格式正確

---

### ✅ 10. 性能驗證

#### 10.1 頁面加載速度
- [ ] **首次加載**
  - 使用瀏覽器開發者工具
  - 檢查頁面加載時間
  - 預期: < 3秒

- [ ] **緩存效果**
  - 刷新頁面
  - 檢查 API 響應時間
  - 預期: 緩存命中時 < 100ms

#### 10.2 API 響應時間
- [ ] **列表 API**
  - 測試賬號列表 API
  - 預期: < 500ms（首次），< 100ms（緩存）

- [ ] **詳情 API**
  - 測試賬號詳情 API
  - 預期: < 300ms（首次），< 50ms（緩存）

---

## 🐛 常見問題測試

### 問題 1: 網絡錯誤處理
- [ ] **斷網測試**
  - 斷開網絡連接
  - 嘗試操作
  - 預期: 顯示友好的錯誤提示

### 問題 2: 會話過期
- [ ] **Token 過期**
  - 等待 Token 過期（或手動清除）
  - 嘗試操作
  - 預期: 自動跳轉到登錄頁面

### 問題 3: 數據驗證
- [ ] **無效數據**
  - 提交無效的表單數據
  - 預期: 顯示驗證錯誤提示

---

## 📊 測試結果記錄

### 功能測試結果
- [ ] 認證與授權: ✅ 通過 / ❌ 失敗
- [ ] 儀表板: ✅ 通過 / ❌ 失敗
- [ ] 賬號管理: ✅ 通過 / ❌ 失敗
- [ ] 劇本管理: ✅ 通過 / ❌ 失敗
- [ ] 角色分配: ✅ 通過 / ❌ 失敗
- [ ] 監控功能: ✅ 通過 / ❌ 失敗
- [ ] 告警通知: ✅ 通過 / ❌ 失敗
- [ ] 用戶權限: ✅ 通過 / ❌ 失敗
- [ ] API 文檔: ✅ 通過 / ❌ 失敗
- [ ] 性能: ✅ 通過 / ❌ 失敗

### 發現的問題
記錄所有發現的問題：
1. **問題描述**: 
2. **重現步驟**: 
3. **預期行為**: 
4. **實際行為**: 
5. **優先級**: 高/中/低

---

## 🎯 測試完成標準

所有核心功能都應該通過測試，才能認為功能驗證完成。

如果發現問題：
1. 記錄問題詳情
2. 標記優先級
3. 修復問題
4. 重新測試

---

**最後更新**: 2025-12-09

