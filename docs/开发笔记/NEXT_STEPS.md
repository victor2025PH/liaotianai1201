# 下一步開發計劃

> **更新日期**: 2024-12-19  
> **當前階段**: 階段 1 基本完成

---

## 當前狀態

### ✅ 階段 1 已完成（約 90%）

- ✅ 模塊結構創建
- ✅ 數據模型設計
- ✅ AccountManager 完整實現
- ✅ ExtendedSessionPool 實現
- ✅ 數據庫設計和遷移
- ✅ 真實測試通過（2 個 session 文件）
- 🔄 測試覆蓋率（約 60%，目標 80%+）
- 🔄 API 實現（佔位實現，需完善）

---

## 選項 1: 完善階段 1（推薦）

### 1.1 完善 API 實現

**目標**: 將佔位 API 替換為真實實現

**任務**:
- [ ] 實現 `POST /api/v1/group-ai/accounts` - 創建賬號
- [ ] 實現 `GET /api/v1/group-ai/accounts` - 列出賬號
- [ ] 實現 `GET /api/v1/group-ai/accounts/{id}` - 獲取詳情
- [ ] 實現 `PUT /api/v1/group-ai/accounts/{id}` - 更新配置
- [ ] 實現 `DELETE /api/v1/group-ai/accounts/{id}` - 刪除賬號
- [ ] 實現 `POST /api/v1/group-ai/accounts/batch-import` - 批量導入
- [ ] 實現 `POST /api/v1/group-ai/accounts/{id}/start` - 啟動賬號
- [ ] 實現 `POST /api/v1/group-ai/accounts/{id}/stop` - 停止賬號
- [ ] 實現 `GET /api/v1/group-ai/accounts/{id}/status` - 獲取狀態

**預計時間**: 2-3 天

### 1.2 提高測試覆蓋率

**目標**: 將測試覆蓋率從 60% 提高到 80%+

**任務**:
- [ ] 添加更多單元測試
- [ ] 實現集成測試
- [ ] 實現 E2E 測試
- [ ] 生成覆蓋率報告

**預計時間**: 2 天

### 1.3 文檔完善

**目標**: 完善開發文檔和 API 文檔

**任務**:
- [ ] 生成 API 文檔（Swagger/OpenAPI）
- [ ] 完善開發者指南
- [ ] 更新 README

**預計時間**: 1 天

---

## 選項 2: 開始階段 2 - 劇本引擎開發

### 2.1 劇本格式設計

**目標**: 設計 YAML 格式的劇本結構

**任務**:
- [ ] 設計劇本 Schema
- [ ] 創建劇本示例文件
- [ ] 編寫劇本格式文檔

**預計時間**: 1 天

### 2.2 劇本解析器實現

**目標**: 實現 YAML 劇本解析器

**任務**:
- [ ] 實現 YAML 解析
- [ ] 實現 Schema 驗證
- [ ] 實現錯誤處理

**預計時間**: 2 天

### 2.3 場景狀態機實現

**目標**: 實現劇本場景狀態機

**任務**:
- [ ] 設計 Scene 類
- [ ] 實現場景匹配邏輯
- [ ] 實現場景切換機制

**預計時間**: 3-4 天

---

## 推薦方案

### 方案 A: 先完善階段 1（穩健）

**優點**:
- 確保基礎功能完整
- 提高代碼質量
- 為後續開發打好基礎

**步驟**:
1. 完善 API 實現（2-3 天）
2. 提高測試覆蓋率（2 天）
3. 完善文檔（1 天）
4. 然後開始階段 2

**總計**: 約 1 週

### 方案 B: 直接開始階段 2（快速）

**優點**:
- 快速推進核心功能
- 階段 1 已基本可用

**步驟**:
1. 開始劇本引擎開發
2. 階段 1 的完善工作並行進行

**總計**: 階段 2 約 2-3 週

---

## 建議

**推薦方案 A**，原因：
1. 階段 1 的 API 實現是前端集成的基礎
2. 測試覆蓋率提高有助於後續開發
3. 穩固的基礎有利於長期維護

---

## 立即執行

如果選擇方案 A，下一步可以：

1. **完善 API 實現**
   ```bash
   # 開始實現 accounts.py 中的 API
   ```

2. **運行測試**
   ```bash
   py scripts/test_account_manager_auto.py
   ```

3. **檢查代碼質量**
   ```bash
   # 運行 lint 檢查
   ```

---

**文檔版本**: v1.0  
**最後更新**: 2024-12-19

