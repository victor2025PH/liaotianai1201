# æœå‹™å™¨å¾Œç«¯å•Ÿå‹•å¤±æ•— - ç«‹å³è¨ºæ–·

> **æ—¥æœŸ**: 2025-11-30  
> **å•é¡Œ**: å¾Œç«¯æœå‹™å•Ÿå‹•å¤±æ•—ï¼ˆExit 1ï¼‰

---

## ğŸ” å•é¡Œç¢ºèª

å¾çµ‚ç«¯è¼¸å‡ºçœ‹åˆ°ï¼š
```
[1]+  Exit 1                  nohup uvicorn app.main:app ...
```

**å¾Œç«¯æœå‹™å•Ÿå‹•å¤±æ•—ï¼Œé€€å‡ºç¢¼ç‚º 1**

---

## ğŸš€ ç«‹å³è¨ºæ–·æ­¥é©Ÿ

### åœ¨æœå‹™å™¨ä¸ŠåŸ·è¡Œä»¥ä¸‹å‘½ä»¤

#### æ­¥é©Ÿ 1: æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒï¼ˆæœ€é‡è¦ï¼‰

```bash
# æŸ¥çœ‹å®Œæ•´çš„éŒ¯èª¤æ—¥èªŒ
tail -100 /tmp/backend.log

# æŸ¥çœ‹æœ€å¾Œçš„éŒ¯èª¤ä¿¡æ¯
tail -50 /tmp/backend.log | tail -20
```

é€™æœƒé¡¯ç¤ºå…·é«”çš„éŒ¯èª¤åŸå› ã€‚

---

#### æ­¥é©Ÿ 2: æª¢æŸ¥å¸¸è¦‹å•é¡Œ

```bash
cd ~/liaotian/admin-backend

# æª¢æŸ¥è™›æ“¬ç’°å¢ƒ
if [ -f ".venv/bin/activate" ]; then
    source .venv/bin/activate
    echo "âœ“ è™›æ“¬ç’°å¢ƒå·²æ¿€æ´»"
else
    echo "âœ— è™›æ“¬ç’°å¢ƒä¸å­˜åœ¨"
fi

# æª¢æŸ¥ä¾è³´
pip list | grep -E "uvicorn|fastapi"

# æª¢æŸ¥ç’°å¢ƒè®Šé‡æ–‡ä»¶
ls -la .env || echo ".env æ–‡ä»¶ä¸å­˜åœ¨"

# æ¸¬è©¦å°å…¥
python -c "from app.main import app; print('å°å…¥æˆåŠŸ')" 2>&1
```

---

## ğŸ”§ å¸¸è¦‹å•é¡Œå’Œè§£æ±ºæ–¹æ¡ˆ

### å•é¡Œ 1: ç¼ºå°‘ä¾è³´

**ç—‡ç‹€**: æ—¥èªŒä¸­é¡¯ç¤º `ModuleNotFoundError` æˆ– `ImportError`

**è§£æ±º**:
```bash
cd ~/liaotian/admin-backend
source .venv/bin/activate
pip install -r requirements.txt
```

---

### å•é¡Œ 2: ç’°å¢ƒè®Šé‡æ–‡ä»¶ç¼ºå¤±

**ç—‡ç‹€**: æ—¥èªŒä¸­é¡¯ç¤ºé…ç½®ç›¸é—œéŒ¯èª¤

**è§£æ±º**:
```bash
cd ~/liaotian/admin-backend
cat > .env << 'EOF'
DATABASE_URL=sqlite:///./admin.db
JWT_SECRET=temp_secret_change_in_production
ADMIN_DEFAULT_EMAIL=admin@example.com
ADMIN_DEFAULT_PASSWORD=changeme123
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
EOF
```

---

### å•é¡Œ 3: æ•¸æ“šåº«æœªåˆå§‹åŒ–

**ç—‡ç‹€**: æ—¥èªŒä¸­é¡¯ç¤ºæ•¸æ“šåº«ç›¸é—œéŒ¯èª¤

**è§£æ±º**:
```bash
cd ~/liaotian/admin-backend
source .venv/bin/activate

# é‹è¡Œæ•¸æ“šåº«é·ç§»ï¼ˆå¦‚æœä½¿ç”¨ Alembicï¼‰
alembic upgrade head 2>/dev/null || echo "è·³éé·ç§»"

# æˆ–è€…æ‰‹å‹•åˆå§‹åŒ–
python -c "from app.db import engine, Base; Base.metadata.create_all(bind=engine)"
```

---

### å•é¡Œ 4: ç«¯å£è¢«å ç”¨

**ç—‡ç‹€**: æ—¥èªŒä¸­é¡¯ç¤ºç«¯å£å·²è¢«å ç”¨

**è§£æ±º**:
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„é€²ç¨‹
lsof -i :8000 || netstat -tlnp | grep :8000

# åœæ­¢å ç”¨ç«¯å£çš„é€²ç¨‹
pkill -9 -f "uvicorn.*8000"
```

---

## ğŸ“‹ å®Œæ•´çš„è¨ºæ–·å’Œä¿®å¾©è…³æœ¬

åœ¨æœå‹™å™¨ä¸ŠåŸ·è¡Œä»¥ä¸‹å®Œæ•´å‘½ä»¤ï¼š

```bash
cd ~/liaotian/admin-backend

# 1. æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ
echo "=== éŒ¯èª¤æ—¥èªŒ ==="
tail -100 /tmp/backend.log
echo ""

# 2. æª¢æŸ¥ä¸¦ä¿®å¾©ç’°å¢ƒ
echo "=== æª¢æŸ¥ç’°å¢ƒ ==="
if [ ! -f ".venv/bin/activate" ]; then
    echo "å‰µå»ºè™›æ“¬ç’°å¢ƒ..."
    python3 -m venv .venv
fi
source .venv/bin/activate

# 3. å®‰è£ä¾è³´
echo "=== å®‰è£ä¾è³´ ==="
pip install --upgrade pip
pip install -r requirements.txt 2>&1 | tail -10

# 4. å‰µå»º .env æ–‡ä»¶ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
echo "=== æª¢æŸ¥ç’°å¢ƒè®Šé‡ ==="
if [ ! -f ".env" ]; then
    echo "å‰µå»º .env æ–‡ä»¶..."
    cat > .env << 'EOF'
DATABASE_URL=sqlite:///./admin.db
JWT_SECRET=temp_secret_$(openssl rand -hex 16)
ADMIN_DEFAULT_EMAIL=admin@example.com
ADMIN_DEFAULT_PASSWORD=changeme123
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
EOF
fi

# 5. æ¸¬è©¦å°å…¥
echo "=== æ¸¬è©¦å°å…¥ ==="
python -c "from app.main import app; print('âœ“ å°å…¥æˆåŠŸ')" 2>&1

# 6. å˜—è©¦å•Ÿå‹•ï¼ˆæŸ¥çœ‹å¯¦æ™‚éŒ¯èª¤ï¼‰
echo ""
echo "=== å˜—è©¦å•Ÿå‹•ï¼ˆ5ç§’æ¸¬è©¦ï¼‰==="
timeout 5 uvicorn app.main:app --host 0.0.0.0 --port 8000 2>&1 | head -30 || true
```

---

## ğŸ¯ å¿«é€Ÿä¿®å¾©æ–¹æ¡ˆ

å¦‚æœä¸æƒ³è¨ºæ–·ï¼Œå¯ä»¥ç›´æ¥åŸ·è¡Œï¼š

```bash
cd ~/liaotian/admin-backend

# åœæ­¢èˆŠæœå‹™
pkill -9 -f 'uvicorn.*app.main:app' || true

# é‡æ–°å®‰è£ä¾è³´
source .venv/bin/activate 2>/dev/null || (python3 -m venv .venv && source .venv/bin/activate)
pip install --upgrade pip
pip install -r requirements.txt

# å‰µå»ºç’°å¢ƒè®Šé‡æ–‡ä»¶
if [ ! -f ".env" ]; then
    cat > .env << 'EOF'
DATABASE_URL=sqlite:///./admin.db
JWT_SECRET=$(openssl rand -hex 32)
ADMIN_DEFAULT_EMAIL=admin@example.com
ADMIN_DEFAULT_PASSWORD=changeme123
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
EOF
fi

# æ¸…ç†ç·©å­˜
find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null || true

# å•Ÿå‹•æœå‹™ï¼ˆå‰å°é‹è¡ŒæŸ¥çœ‹éŒ¯èª¤ï¼‰
cd ~/liaotian/admin-backend
source .venv/bin/activate
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

å¦‚æœå‰å°é‹è¡ŒæˆåŠŸï¼ŒæŒ‰ Ctrl+C åœæ­¢ï¼Œç„¶å¾Œç”¨ nohup å¾Œå°é‹è¡Œã€‚

---

**å®Œæˆæ™‚é–“**: 2025-11-30  
**ä¸‹ä¸€æ­¥**: æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒç¢ºå®šå…·é«”å•é¡Œ
