# 核心功能測試 - 簡化執行方案

> **日期**: 2025-12-01  
> **步驟**: 3/3 - 核心功能測試

---

## 📋 測試概述

需要測試的 4 個核心功能：

1. **多賬號協同邏輯** - 防止重複回復
2. **劇本熱更新** - 不重啟更新劇本
3. **新成員檢測** - 自動歡迎新成員
4. **多輪對話增強** - 意圖識別、話題檢測、情感分析

---

## 🚀 簡化測試方案

### 方案 1: API 端點測試（推薦，快速驗證）

測試相關的 API 端點是否正常：

```bash
# 1. 測試劇本列表 API
curl -s http://localhost:8000/api/v1/group-ai/scripts/ | head -20

# 2. 測試賬號列表 API
curl -s http://localhost:8000/api/v1/group-ai/accounts/ | head -20

# 3. 測試 Worker API
curl -s http://localhost:8000/api/v1/workers | head -20

# 4. 檢查 API 文檔
curl -s http://localhost:8000/docs | grep -i "hot.*update\|script\|account" | head -10
```

**預期**: API 端點應該返回 JSON 響應（可能是 401 需要認證，但端點存在）

---

### 方案 2: 檢查功能是否存在（代碼級別）

檢查相關模塊是否已實現：

```bash
cd ~/liaotian/admin-backend
source .venv/bin/activate

# 檢查協同管理器
python3 -c "from app.services.coordination_manager import CoordinationManager; print('✓ 協同管理器存在')"

# 檢查劇本引擎
python3 -c "from app.services.script_engine import ScriptEngine; print('✓ 劇本引擎存在')"

# 檢查消息分析器
python3 -c "from app.services.message_analyzer import MessageAnalyzer; print('✓ 消息分析器存在')"
```

---

### 方案 3: 完整集成測試（需要實際環境）

如果需要完整測試，需要：
1. 實際的 Telegram 賬號
2. 測試群組
3. 配置好的劇本

**詳細步驟**: 參考 `docs/开发笔记/核心功能测试指南.md`

---

## 📊 快速驗證檢查清單

### API 層面驗證

- [ ] 劇本管理 API 可用
- [ ] 賬號管理 API 可用
- [ ] 熱更新 API 端點存在（如果有）
- [ ] Worker API 可用

### 代碼層面驗證

- [ ] 協同管理器模塊存在
- [ ] 劇本引擎模塊存在
- [ ] 消息分析器模塊存在
- [ ] 新成員檢測邏輯存在

### 日誌驗證

- [ ] 檢查日誌中是否有相關功能的日誌
- [ ] 確認服務啟動時沒有相關錯誤

---

## 🔍 快速檢查命令

執行以下命令快速檢查功能是否存在：

```bash
cd ~/liaotian/admin-backend && \
source .venv/bin/activate && \
echo "=== 功能檢查 ===" && \
echo "" && \
echo "1. 檢查協同管理器..." && \
(python3 -c "from app.services.coordination_manager import CoordinationManager; print('✓ 存在')" 2>&1 | head -1 || echo "✗ 不存在或錯誤") && \
echo "" && \
echo "2. 檢查劇本引擎..." && \
(python3 -c "from app.services.script_engine import ScriptEngine; print('✓ 存在')" 2>&1 | head -1 || echo "✗ 不存在或錯誤") && \
echo "" && \
echo "3. 檢查消息分析器..." && \
(python3 -c "from app.services.message_analyzer import MessageAnalyzer; print('✓ 存在')" 2>&1 | head -1 || echo "✗ 不存在或錯誤") && \
echo "" && \
echo "=== 檢查完成 ==="
```

---

## ✅ 測試結論標準

### 通過標準

- ✅ API 端點可以訪問（即使需要認證）
- ✅ 相關模塊可以導入
- ✅ 服務日誌中沒有相關錯誤

### 需要進一步測試

- ⚠️ 如果模塊不存在，需要檢查是否已實現
- ⚠️ 如果 API 不可訪問，需要檢查路由配置

---

**建議**: 先執行快速檢查，確認功能是否存在，然後根據結果決定是否需要完整測試。
