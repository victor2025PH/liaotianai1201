# 完整修復方案 - 立即執行

> **日期**: 2025-12-01

---

## 🚀 最簡單的方案

由於服務器不是 Git 倉庫，最簡單的方式是：

### 方案 A: 手動上傳修復後的文件（推薦）

1. **在本地**：確保 `admin-backend/app/api/group_ai/accounts.py` 已包含修復
2. **上傳到服務器**：使用 WinSCP 或其他工具將文件上傳到：
   - `/home/ubuntu/liaotian/deployment-package/admin-backend/app/api/group_ai/accounts.py`
3. **重啟後端服務**

---

### 方案 B: 直接在服務器上創建修復腳本（如果無法上傳文件）

由於修復代碼較長，建議使用方案 A。

---

## 🔧 修復後重啟服務

修復完成後，需要重啟後端服務：

```bash
# 停止服務
pkill -f "uvicorn.*app.main:app"
sleep 3

# 進入後端目錄並重啟
cd /home/ubuntu/liaotian/deployment-package/admin-backend
source ../.venv/bin/activate 2>/dev/null || source .venv/bin/activate 2>/dev/null
nohup python3 -m uvicorn app.main:app --host 0.0.0.0 --port 8000 > /tmp/backend.log 2>&1 &
sleep 5

# 驗證
curl http://localhost:8000/health
```

---

## ✅ 驗證修復

```bash
TOKEN=$(curl -s -X POST "http://localhost:8000/api/v1/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=admin@example.com&password=changeme123" | \
  python3 -c "import sys, json; d=json.load(sys.stdin); print(d.get('access_token',''))" 2>/dev/null) && \
curl -s -o /tmp/test.json -w "HTTP狀態碼: %{http_code}\n" \
  -H "Authorization: Bearer $TOKEN" \
  "http://localhost:8000/api/v1/group-ai/accounts/639454959591/status" && \
echo "" && \
python3 -m json.tool /tmp/test.json 2>/dev/null || cat /tmp/test.json
```

---

**建議使用方案 A：手動上傳修復後的文件。**  
**修復後執行重啟和驗證命令！**
