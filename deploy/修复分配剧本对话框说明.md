# 修复分配剧本对话框说明

## 问题描述

用户反馈：当点击账号列表中的"分配剧本"按钮时，弹出的对话框中不应该再要求填写账号ID和选择session文件，因为已经选择了具体的账号。应该直接显示账号信息，只让选择剧本即可。

## 修复内容

### 1. 添加分配剧本模式状态

```typescript
const [assignScriptMode, setAssignScriptMode] = useState(false) // 是否为分配剧本模式
```

### 2. 修改对话框显示逻辑

- **分配剧本模式**：
  - 标题：显示"分配剧本"
  - 描述：显示"为账号 XXX 分配剧本"
  - 显示账号信息（只读）：账号ID、名称、手机号、节点
  - 只显示剧本选择字段
  - 按钮：显示"取消"和"分配剧本"

- **添加新账号模式**（原有逻辑）：
  - 标题：显示"添加新账号"
  - 描述：显示"配置新的 Telegram AI 账号"
  - 显示账号ID、Session文件、剧本选择字段
  - 按钮：显示"创建"

### 3. 修改"分配剧本"按钮点击事件

```typescript
onClick={() => {
  setSelectedAccountForRole(account)
  setAssignScriptMode(true)  // 设置为分配剧本模式
  setDialogOpen(true)
  setFormData({
    account_id: account.account_id,
    session_file: account.session_file || "",
    script_id: account.script_id || ""
  })
}}
```

### 4. 添加分配剧本的处理逻辑

在对话框的按钮中，根据`assignScriptMode`显示不同的按钮：
- 分配剧本模式：调用`updateAccount`更新账号的剧本ID
- 添加新账号模式：调用`createAccount`创建新账号

### 5. 关闭对话框时重置状态

```typescript
onOpenChange={(open) => {
  setDialogOpen(open)
  if (!open) {
    // 关闭時重置表單和模式
    setFormData({ account_id: "", session_file: "", script_id: "" })
    setAssignScriptMode(false)
    setSelectedAccountForRole(null)
  }
}}
```

## 修复效果

✅ **点击"分配剧本"按钮时**：
- 对话框标题显示"分配剧本"
- 显示账号信息（只读），包括账号ID、名称、手机号、节点
- 只显示剧本选择下拉框
- 不显示账号ID和Session文件输入框
- 按钮显示"取消"和"分配剧本"

✅ **点击"添加账号"按钮时**：
- 对话框标题显示"添加新账号"
- 显示账号ID、Session文件、剧本选择字段
- 按钮显示"创建"

## 部署步骤

1. 上传修改后的文件到服务器
2. 重新构建前端
3. 重启前端服务
4. 验证分配剧本功能

